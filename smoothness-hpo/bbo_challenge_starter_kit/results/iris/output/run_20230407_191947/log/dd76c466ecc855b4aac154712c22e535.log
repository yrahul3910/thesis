running: {'--uuid': 'dd76c466ecc855b4aac154712c22e535', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_191947', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d iris -o smoothness -u dd76c466ecc855b4aac154712c22e535 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_191947
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_iris_nll betwen [1.31057198 1.56976556 1.25224472 0.90978049 0.39813052] and [1.32439241 1.77609477 1.43221076 0.9966468  0.57459871]
  warnings.warn(

Signature errors:
                         0         1         2         3         4       max
MLP-adam_iris_nll  0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
max                0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
starting sklearn study smoothness MLP-adam iris nll 15 1
with data root: None
suggestion time taken 11.359724 iter 0 next_points [{'alpha': 0.021226527953710134, 'batch_size': 18, 'beta_1': 0.9030919929797018, 'beta_2': 0.9847504412721217, 'epsilon': 7.748970943182925e-09, 'hidden_layer_sizes': 133, 'learning_rate_init': 0.06709816644294629, 'tol': 0.004513668455019829, 'validation_fraction': 0.6264157625361677}]
function_evaluation time 0.095117 value 0.229025 suggestion {'alpha': 0.021226527953710134, 'batch_size': 18, 'beta_1': 0.9030919929797018, 'beta_2': 0.9847504412721217, 'epsilon': 7.748970943182925e-09, 'hidden_layer_sizes': 133, 'learning_rate_init': 0.06709816644294629, 'tol': 0.004513668455019829, 'validation_fraction': 0.6264157625361677}
observation time 0.000006, current best 0.229025 at iter 0
suggestion time taken 11.354001 iter 1 next_points [{'alpha': 0.2972568449778705, 'batch_size': 29, 'beta_1': 0.9710320939512351, 'beta_2': 0.9993962775050595, 'epsilon': 3.8426047820564415e-09, 'hidden_layer_sizes': 91, 'learning_rate_init': 0.01842376577788132, 'tol': 2.32064555102745e-05, 'validation_fraction': 0.14936647572625625}]
function_evaluation time 0.098613 value 0.351372 suggestion {'alpha': 0.2972568449778705, 'batch_size': 29, 'beta_1': 0.9710320939512351, 'beta_2': 0.9993962775050595, 'epsilon': 3.8426047820564415e-09, 'hidden_layer_sizes': 91, 'learning_rate_init': 0.01842376577788132, 'tol': 2.32064555102745e-05, 'validation_fraction': 0.14936647572625625}
observation time 0.000006, current best 0.229025 at iter 1
suggestion time taken 11.089611 iter 2 next_points [{'alpha': 3.488737999309825e-05, 'batch_size': 14, 'beta_1': 0.903320498467345, 'beta_2': 0.9999899286070848, 'epsilon': 5.132167315790024e-09, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.0019581491177862137, 'tol': 0.006190463270079541, 'validation_fraction': 0.6854301791628283}]
function_evaluation time 0.139233 value 0.558225 suggestion {'alpha': 3.488737999309825e-05, 'batch_size': 14, 'beta_1': 0.903320498467345, 'beta_2': 0.9999899286070848, 'epsilon': 5.132167315790024e-09, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.0019581491177862137, 'tol': 0.006190463270079541, 'validation_fraction': 0.6854301791628283}
observation time 0.000005, current best 0.229025 at iter 2
suggestion time taken 11.786892 iter 3 next_points [{'alpha': 7.185620599802803e-05, 'batch_size': 11, 'beta_1': 0.969076745587951, 'beta_2': 0.9994938250536659, 'epsilon': 1.3114484696047891e-08, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.00022624819545237062, 'tol': 0.0018580492503441522, 'validation_fraction': 0.7036309416468873}]
function_evaluation time 0.073712 value 1.752052 suggestion {'alpha': 7.185620599802803e-05, 'batch_size': 11, 'beta_1': 0.969076745587951, 'beta_2': 0.9994938250536659, 'epsilon': 1.3114484696047891e-08, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.00022624819545237062, 'tol': 0.0018580492503441522, 'validation_fraction': 0.7036309416468873}
observation time 0.000005, current best 0.229025 at iter 3
suggestion time taken 11.174031 iter 4 next_points [{'alpha': 0.005986064492607526, 'batch_size': 13, 'beta_1': 0.8307016725363151, 'beta_2': 0.9535197249413931, 'epsilon': 4.297879382787071e-07, 'hidden_layer_sizes': 181, 'learning_rate_init': 3.178914973061273e-05, 'tol': 0.00011043096891360488, 'validation_fraction': 0.8449278863072791}]
function_evaluation time 0.057445 value 1.359185 suggestion {'alpha': 0.005986064492607526, 'batch_size': 13, 'beta_1': 0.8307016725363151, 'beta_2': 0.9535197249413931, 'epsilon': 4.297879382787071e-07, 'hidden_layer_sizes': 181, 'learning_rate_init': 3.178914973061273e-05, 'tol': 0.00011043096891360488, 'validation_fraction': 0.8449278863072791}
observation time 0.000006, current best 0.229025 at iter 4
suggestion time taken 11.615183 iter 5 next_points [{'alpha': 1.2546347658377133e-05, 'batch_size': 23, 'beta_1': 0.9589688961923584, 'beta_2': 0.9999953501510563, 'epsilon': 1.4785443851316485e-07, 'hidden_layer_sizes': 138, 'learning_rate_init': 0.011243575874590428, 'tol': 0.07898955020675091, 'validation_fraction': 0.1321375522498087}]
function_evaluation time 0.097142 value 0.461221 suggestion {'alpha': 1.2546347658377133e-05, 'batch_size': 23, 'beta_1': 0.9589688961923584, 'beta_2': 0.9999953501510563, 'epsilon': 1.4785443851316485e-07, 'hidden_layer_sizes': 138, 'learning_rate_init': 0.011243575874590428, 'tol': 0.07898955020675091, 'validation_fraction': 0.1321375522498087}
observation time 0.000005, current best 0.229025 at iter 5
suggestion time taken 11.294771 iter 6 next_points [{'alpha': 0.011879991219600986, 'batch_size': 18, 'beta_1': 0.8888953758972351, 'beta_2': 0.999314129727735, 'epsilon': 1.2334699108684901e-09, 'hidden_layer_sizes': 115, 'learning_rate_init': 0.0004074377214071687, 'tol': 0.07300730334107623, 'validation_fraction': 0.7702658085666856}]
function_evaluation time 0.059824 value 1.098663 suggestion {'alpha': 0.011879991219600986, 'batch_size': 18, 'beta_1': 0.8888953758972351, 'beta_2': 0.999314129727735, 'epsilon': 1.2334699108684901e-09, 'hidden_layer_sizes': 115, 'learning_rate_init': 0.0004074377214071687, 'tol': 0.07300730334107623, 'validation_fraction': 0.7702658085666856}
observation time 0.000006, current best 0.229025 at iter 6
suggestion time taken 11.274848 iter 7 next_points [{'alpha': 0.004927679816837113, 'batch_size': 18, 'beta_1': 0.9885199270530121, 'beta_2': 0.9999575042698794, 'epsilon': 1.911265091375165e-08, 'hidden_layer_sizes': 107, 'learning_rate_init': 0.031005910736191123, 'tol': 0.06910493582888556, 'validation_fraction': 0.690398125150161}]
function_evaluation time 0.084944 value 0.291164 suggestion {'alpha': 0.004927679816837113, 'batch_size': 18, 'beta_1': 0.9885199270530121, 'beta_2': 0.9999575042698794, 'epsilon': 1.911265091375165e-08, 'hidden_layer_sizes': 107, 'learning_rate_init': 0.031005910736191123, 'tol': 0.06910493582888556, 'validation_fraction': 0.690398125150161}
observation time 0.000006, current best 0.229025 at iter 7
suggestion time taken 11.217335 iter 8 next_points [{'alpha': 0.0003732534644227303, 'batch_size': 36, 'beta_1': 0.9792043350846561, 'beta_2': 0.9999942184237365, 'epsilon': 3.409923028775603e-07, 'hidden_layer_sizes': 188, 'learning_rate_init': 0.00020694414742585535, 'tol': 0.017511181600355082, 'validation_fraction': 0.866446644625555}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.052538 value 1.585996 suggestion {'alpha': 0.0003732534644227303, 'batch_size': 36, 'beta_1': 0.9792043350846561, 'beta_2': 0.9999942184237365, 'epsilon': 3.409923028775603e-07, 'hidden_layer_sizes': 188, 'learning_rate_init': 0.00020694414742585535, 'tol': 0.017511181600355082, 'validation_fraction': 0.866446644625555}
observation time 0.000005, current best 0.229025 at iter 8
suggestion time taken 11.075113 iter 9 next_points [{'alpha': 1.694081321956064e-05, 'batch_size': 20, 'beta_1': 0.8694919605487542, 'beta_2': 0.9635240448270546, 'epsilon': 1.2234042243430824e-09, 'hidden_layer_sizes': 119, 'learning_rate_init': 0.014591608383299379, 'tol': 0.039161208641512686, 'validation_fraction': 0.11375956314093025}]
function_evaluation time 0.104607 value 0.401953 suggestion {'alpha': 1.694081321956064e-05, 'batch_size': 20, 'beta_1': 0.8694919605487542, 'beta_2': 0.9635240448270546, 'epsilon': 1.2234042243430824e-09, 'hidden_layer_sizes': 119, 'learning_rate_init': 0.014591608383299379, 'tol': 0.039161208641512686, 'validation_fraction': 0.11375956314093025}
observation time 0.000006, current best 0.229025 at iter 9
suggestion time taken 11.129458 iter 10 next_points [{'alpha': 5.011986637701731e-05, 'batch_size': 22, 'beta_1': 0.9206458598804919, 'beta_2': 0.996011013811288, 'epsilon': 1.851067960453767e-09, 'hidden_layer_sizes': 158, 'learning_rate_init': 5.0423471525680157e-05, 'tol': 3.759889450679505e-05, 'validation_fraction': 0.7109233547210835}]
function_evaluation time 0.067727 value 1.138477 suggestion {'alpha': 5.011986637701731e-05, 'batch_size': 22, 'beta_1': 0.9206458598804919, 'beta_2': 0.996011013811288, 'epsilon': 1.851067960453767e-09, 'hidden_layer_sizes': 158, 'learning_rate_init': 5.0423471525680157e-05, 'tol': 3.759889450679505e-05, 'validation_fraction': 0.7109233547210835}
observation time 0.000005, current best 0.229025 at iter 10
suggestion time taken 11.214978 iter 11 next_points [{'alpha': 1.2333016914276966, 'batch_size': 11, 'beta_1': 0.8701115832665781, 'beta_2': 0.9596712654744796, 'epsilon': 4.7638281891745527e-08, 'hidden_layer_sizes': 114, 'learning_rate_init': 0.002155918513334228, 'tol': 0.0008227393663462025, 'validation_fraction': 0.32121137965357516}]
function_evaluation time 0.184670 value 0.476397 suggestion {'alpha': 1.2333016914276966, 'batch_size': 11, 'beta_1': 0.8701115832665781, 'beta_2': 0.9596712654744796, 'epsilon': 4.7638281891745527e-08, 'hidden_layer_sizes': 114, 'learning_rate_init': 0.002155918513334228, 'tol': 0.0008227393663462025, 'validation_fraction': 0.32121137965357516}
observation time 0.000005, current best 0.229025 at iter 11
suggestion time taken 11.812585 iter 12 next_points [{'alpha': 0.005488978047303085, 'batch_size': 15, 'beta_1': 0.6429923222302849, 'beta_2': 0.9999903916562326, 'epsilon': 7.174614429628029e-09, 'hidden_layer_sizes': 113, 'learning_rate_init': 0.0001223502270150749, 'tol': 4.352804889483587e-05, 'validation_fraction': 0.24497829450700226}]
function_evaluation time 0.088863 value 1.437398 suggestion {'alpha': 0.005488978047303085, 'batch_size': 15, 'beta_1': 0.6429923222302849, 'beta_2': 0.9999903916562326, 'epsilon': 7.174614429628029e-09, 'hidden_layer_sizes': 113, 'learning_rate_init': 0.0001223502270150749, 'tol': 4.352804889483587e-05, 'validation_fraction': 0.24497829450700226}
observation time 0.000005, current best 0.229025 at iter 12
suggestion time taken 11.218511 iter 13 next_points [{'alpha': 0.013006357800146653, 'batch_size': 25, 'beta_1': 0.7473692561543039, 'beta_2': 0.9998036911182918, 'epsilon': 4.550696918808501e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.0004770904905422245, 'tol': 0.004741773548084654, 'validation_fraction': 0.7960361772786458}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.051996 value 1.468448 suggestion {'alpha': 0.013006357800146653, 'batch_size': 25, 'beta_1': 0.7473692561543039, 'beta_2': 0.9998036911182918, 'epsilon': 4.550696918808501e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.0004770904905422245, 'tol': 0.004741773548084654, 'validation_fraction': 0.7960361772786458}
observation time 0.000005, current best 0.229025 at iter 13
suggestion time taken 11.274569 iter 14 next_points [{'alpha': 7.488220812816326, 'batch_size': 10, 'beta_1': 0.9199111712547829, 'beta_2': 0.9999989507969042, 'epsilon': 5.535008127669433e-09, 'hidden_layer_sizes': 161, 'learning_rate_init': 0.00016056076971616883, 'tol': 0.008546279900119103, 'validation_fraction': 0.6972051701083666}]
function_evaluation time 0.071101 value 1.145092 suggestion {'alpha': 7.488220812816326, 'batch_size': 10, 'beta_1': 0.9199111712547829, 'beta_2': 0.9999989507969042, 'epsilon': 5.535008127669433e-09, 'hidden_layer_sizes': 161, 'learning_rate_init': 0.00016056076971616883, 'tol': 0.008546279900119103, 'validation_fraction': 0.6972051701083666}
observation time 0.000005, current best 0.229025 at iter 14
saving meta data: {'args': {'--uuid': 'dd76c466ecc855b4aac154712c22e535', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_191947', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])}
saving results
saving timing
saving suggest log
done
