running: {'--uuid': '4a1c4db363be557c9f4b29a0bab3390c', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_191947', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d iris -o smoothness -u 4a1c4db363be557c9f4b29a0bab3390c -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_191947
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_iris_nll betwen [1.31057198 1.56976556 1.25224472 0.90978049 0.39813052] and [1.32439241 1.77609477 1.43221076 0.9966468  0.57459871]
  warnings.warn(

Signature errors:
                         0         1         2         3         4       max
MLP-adam_iris_nll  0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
max                0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
starting sklearn study smoothness MLP-adam iris nll 15 1
with data root: None
suggestion time taken 11.589297 iter 0 next_points [{'alpha': 0.037521378875802, 'batch_size': 14, 'beta_1': 0.9809157708614459, 'beta_2': 0.9979699684102513, 'epsilon': 4.943459458773338e-09, 'hidden_layer_sizes': 59, 'learning_rate_init': 0.012256146089445958, 'tol': 0.00010545991557886023, 'validation_fraction': 0.8098051783566174}]
function_evaluation time 0.124962 value 0.391898 suggestion {'alpha': 0.037521378875802, 'batch_size': 14, 'beta_1': 0.9809157708614459, 'beta_2': 0.9979699684102513, 'epsilon': 4.943459458773338e-09, 'hidden_layer_sizes': 59, 'learning_rate_init': 0.012256146089445958, 'tol': 0.00010545991557886023, 'validation_fraction': 0.8098051783566174}
observation time 0.000006, current best 0.391898 at iter 0
suggestion time taken 11.588074 iter 1 next_points [{'alpha': 0.07949423948338183, 'batch_size': 17, 'beta_1': 0.6887109739587948, 'beta_2': 0.999997001996903, 'epsilon': 5.2077863956798694e-08, 'hidden_layer_sizes': 198, 'learning_rate_init': 0.00026080488089933173, 'tol': 0.0049110320469503265, 'validation_fraction': 0.8114066761555785}]
function_evaluation time 0.089227 value 1.213624 suggestion {'alpha': 0.07949423948338183, 'batch_size': 17, 'beta_1': 0.6887109739587948, 'beta_2': 0.999997001996903, 'epsilon': 5.2077863956798694e-08, 'hidden_layer_sizes': 198, 'learning_rate_init': 0.00026080488089933173, 'tol': 0.0049110320469503265, 'validation_fraction': 0.8114066761555785}
observation time 0.000005, current best 0.391898 at iter 1
suggestion time taken 11.314970 iter 2 next_points [{'alpha': 0.020486199072430746, 'batch_size': 27, 'beta_1': 0.9838007039215845, 'beta_2': 0.9999693263189009, 'epsilon': 1.2750547345315359e-08, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.037640388629490325, 'tol': 0.0002716441162465727, 'validation_fraction': 0.4794106297280722}]
function_evaluation time 0.104377 value 0.240348 suggestion {'alpha': 0.020486199072430746, 'batch_size': 27, 'beta_1': 0.9838007039215845, 'beta_2': 0.9999693263189009, 'epsilon': 1.2750547345315359e-08, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.037640388629490325, 'tol': 0.0002716441162465727, 'validation_fraction': 0.4794106297280722}
observation time 0.000005, current best 0.240348 at iter 2
suggestion time taken 11.868369 iter 3 next_points [{'alpha': 3.2883270784779504e-05, 'batch_size': 11, 'beta_1': 0.9775622905024748, 'beta_2': 0.9978481562822046, 'epsilon': 6.999114035572736e-07, 'hidden_layer_sizes': 76, 'learning_rate_init': 0.0012344762567266347, 'tol': 0.024188343530596807, 'validation_fraction': 0.7434414085072958}]
function_evaluation time 0.079955 value 1.164453 suggestion {'alpha': 3.2883270784779504e-05, 'batch_size': 11, 'beta_1': 0.9775622905024748, 'beta_2': 0.9978481562822046, 'epsilon': 6.999114035572736e-07, 'hidden_layer_sizes': 76, 'learning_rate_init': 0.0012344762567266347, 'tol': 0.024188343530596807, 'validation_fraction': 0.7434414085072958}
observation time 0.000006, current best 0.240348 at iter 3
suggestion time taken 11.477532 iter 4 next_points [{'alpha': 0.0032182549268741922, 'batch_size': 18, 'beta_1': 0.9854269897836938, 'beta_2': 0.9999965746944243, 'epsilon': 5.398825572349991e-09, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.02937030084471018, 'tol': 5.459674427108047e-05, 'validation_fraction': 0.4367834629388202}]
function_evaluation time 0.103853 value 0.329258 suggestion {'alpha': 0.0032182549268741922, 'batch_size': 18, 'beta_1': 0.9854269897836938, 'beta_2': 0.9999965746944243, 'epsilon': 5.398825572349991e-09, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.02937030084471018, 'tol': 5.459674427108047e-05, 'validation_fraction': 0.4367834629388202}
observation time 0.000006, current best 0.240348 at iter 4
suggestion time taken 11.399947 iter 5 next_points [{'alpha': 0.007375776678109627, 'batch_size': 22, 'beta_1': 0.9846269105858656, 'beta_2': 0.9999976993383111, 'epsilon': 2.382342910918752e-07, 'hidden_layer_sizes': 182, 'learning_rate_init': 0.0001958808560952001, 'tol': 0.00041409415074830083, 'validation_fraction': 0.1070420170525374}]
function_evaluation time 0.116216 value 0.997482 suggestion {'alpha': 0.007375776678109627, 'batch_size': 22, 'beta_1': 0.9846269105858656, 'beta_2': 0.9999976993383111, 'epsilon': 2.382342910918752e-07, 'hidden_layer_sizes': 182, 'learning_rate_init': 0.0001958808560952001, 'tol': 0.00041409415074830083, 'validation_fraction': 0.1070420170525374}
observation time 0.000006, current best 0.240348 at iter 5
suggestion time taken 11.792181 iter 6 next_points [{'alpha': 0.008022039272212603, 'batch_size': 15, 'beta_1': 0.6697695266875587, 'beta_2': 0.9999984206051236, 'epsilon': 4.4750350810645216e-07, 'hidden_layer_sizes': 136, 'learning_rate_init': 0.008817873005986335, 'tol': 9.831555556304451e-05, 'validation_fraction': 0.14894857969636635}]
function_evaluation time 0.145077 value 0.320278 suggestion {'alpha': 0.008022039272212603, 'batch_size': 15, 'beta_1': 0.6697695266875587, 'beta_2': 0.9999984206051236, 'epsilon': 4.4750350810645216e-07, 'hidden_layer_sizes': 136, 'learning_rate_init': 0.008817873005986335, 'tol': 9.831555556304451e-05, 'validation_fraction': 0.14894857969636635}
observation time 0.000006, current best 0.240348 at iter 6
suggestion time taken 11.588918 iter 7 next_points [{'alpha': 0.0003730425071182185, 'batch_size': 37, 'beta_1': 0.9666629405091102, 'beta_2': 0.9999947622552937, 'epsilon': 4.0764378881508884e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 2.315601100991622e-05, 'tol': 0.001004772183160189, 'validation_fraction': 0.49660929926465314}]
function_evaluation time 0.053750 value 1.473836 suggestion {'alpha': 0.0003730425071182185, 'batch_size': 37, 'beta_1': 0.9666629405091102, 'beta_2': 0.9999947622552937, 'epsilon': 4.0764378881508884e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 2.315601100991622e-05, 'tol': 0.001004772183160189, 'validation_fraction': 0.49660929926465314}
observation time 0.000005, current best 0.240348 at iter 7
suggestion time taken 11.540540 iter 8 next_points [{'alpha': 0.4558928226628183, 'batch_size': 14, 'beta_1': 0.6319421035307538, 'beta_2': 0.9991209943428495, 'epsilon': 5.3893190898027844e-08, 'hidden_layer_sizes': 173, 'learning_rate_init': 0.000398969171708438, 'tol': 5.045717676768228e-05, 'validation_fraction': 0.2343209937697471}]
function_evaluation time 0.136652 value 0.938499 suggestion {'alpha': 0.4558928226628183, 'batch_size': 14, 'beta_1': 0.6319421035307538, 'beta_2': 0.9991209943428495, 'epsilon': 5.3893190898027844e-08, 'hidden_layer_sizes': 173, 'learning_rate_init': 0.000398969171708438, 'tol': 5.045717676768228e-05, 'validation_fraction': 0.2343209937697471}
observation time 0.000005, current best 0.240348 at iter 8
suggestion time taken 11.933247 iter 9 next_points [{'alpha': 0.4321665745348458, 'batch_size': 31, 'beta_1': 0.8858689095981487, 'beta_2': 0.9993401765442342, 'epsilon': 1.2164933117772882e-08, 'hidden_layer_sizes': 132, 'learning_rate_init': 0.04407520819280248, 'tol': 0.0014199301901603727, 'validation_fraction': 0.8061586316683809}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.102158 value 0.266967 suggestion {'alpha': 0.4321665745348458, 'batch_size': 31, 'beta_1': 0.8858689095981487, 'beta_2': 0.9993401765442342, 'epsilon': 1.2164933117772882e-08, 'hidden_layer_sizes': 132, 'learning_rate_init': 0.04407520819280248, 'tol': 0.0014199301901603727, 'validation_fraction': 0.8061586316683809}
observation time 0.000006, current best 0.240348 at iter 9
suggestion time taken 11.664225 iter 10 next_points [{'alpha': 3.6110883678561665e-05, 'batch_size': 17, 'beta_1': 0.9258664757093718, 'beta_2': 0.9990200108960561, 'epsilon': 5.456200608126691e-08, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.0003282669296775393, 'tol': 1.7828693863676987e-05, 'validation_fraction': 0.5336038039764687}]
function_evaluation time 0.100018 value 1.150505 suggestion {'alpha': 3.6110883678561665e-05, 'batch_size': 17, 'beta_1': 0.9258664757093718, 'beta_2': 0.9990200108960561, 'epsilon': 5.456200608126691e-08, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.0003282669296775393, 'tol': 1.7828693863676987e-05, 'validation_fraction': 0.5336038039764687}
observation time 0.000005, current best 0.240348 at iter 10
suggestion time taken 11.691906 iter 11 next_points [{'alpha': 0.04311155548977709, 'batch_size': 14, 'beta_1': 0.9496497998827549, 'beta_2': 0.9512487351995612, 'epsilon': 1.5104576403223522e-08, 'hidden_layer_sizes': 138, 'learning_rate_init': 9.279103208315045e-05, 'tol': 0.028607521981713083, 'validation_fraction': 0.2011070712394283}]
function_evaluation time 0.125132 value 1.293105 suggestion {'alpha': 0.04311155548977709, 'batch_size': 14, 'beta_1': 0.9496497998827549, 'beta_2': 0.9512487351995612, 'epsilon': 1.5104576403223522e-08, 'hidden_layer_sizes': 138, 'learning_rate_init': 9.279103208315045e-05, 'tol': 0.028607521981713083, 'validation_fraction': 0.2011070712394283}
observation time 0.000006, current best 0.240348 at iter 11
suggestion time taken 12.151105 iter 12 next_points [{'alpha': 0.052093488761571105, 'batch_size': 11, 'beta_1': 0.5280205165285209, 'beta_2': 0.9859215308916245, 'epsilon': 3.586370806281921e-07, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.0005585833471104739, 'tol': 0.020006825913880373, 'validation_fraction': 0.7090839648744565}]
function_evaluation time 0.071498 value 1.594636 suggestion {'alpha': 0.052093488761571105, 'batch_size': 11, 'beta_1': 0.5280205165285209, 'beta_2': 0.9859215308916245, 'epsilon': 3.586370806281921e-07, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.0005585833471104739, 'tol': 0.020006825913880373, 'validation_fraction': 0.7090839648744565}
observation time 0.000006, current best 0.240348 at iter 12
suggestion time taken 11.693117 iter 13 next_points [{'alpha': 4.776141815842711e-05, 'batch_size': 17, 'beta_1': 0.9856782493691758, 'beta_2': 0.9999260022830609, 'epsilon': 1.0188336669078523e-08, 'hidden_layer_sizes': 193, 'learning_rate_init': 0.010127166674537839, 'tol': 0.0076268354859131545, 'validation_fraction': 0.25473901013044864}]
function_evaluation time 0.118314 value 0.423880 suggestion {'alpha': 4.776141815842711e-05, 'batch_size': 17, 'beta_1': 0.9856782493691758, 'beta_2': 0.9999260022830609, 'epsilon': 1.0188336669078523e-08, 'hidden_layer_sizes': 193, 'learning_rate_init': 0.010127166674537839, 'tol': 0.0076268354859131545, 'validation_fraction': 0.25473901013044864}
observation time 0.000006, current best 0.240348 at iter 13
suggestion time taken 11.641931 iter 14 next_points [{'alpha': 0.007455689063265507, 'batch_size': 13, 'beta_1': 0.5149076401435638, 'beta_2': 0.9295630301200134, 'epsilon': 9.763099326294516e-08, 'hidden_layer_sizes': 149, 'learning_rate_init': 0.007566132927814469, 'tol': 0.04416111412324153, 'validation_fraction': 0.8649555678691975}]
function_evaluation time 0.061915 value 0.884615 suggestion {'alpha': 0.007455689063265507, 'batch_size': 13, 'beta_1': 0.5149076401435638, 'beta_2': 0.9295630301200134, 'epsilon': 9.763099326294516e-08, 'hidden_layer_sizes': 149, 'learning_rate_init': 0.007566132927814469, 'tol': 0.04416111412324153, 'validation_fraction': 0.8649555678691975}
observation time 0.000006, current best 0.240348 at iter 14
saving meta data: {'args': {'--uuid': '4a1c4db363be557c9f4b29a0bab3390c', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_191947', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])}
saving results
saving timing
saving suggest log
done
