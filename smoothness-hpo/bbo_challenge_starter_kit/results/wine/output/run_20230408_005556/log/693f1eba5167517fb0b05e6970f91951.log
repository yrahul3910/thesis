running: {'--uuid': '693f1eba5167517fb0b05e6970f91951', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230408_005556', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d wine -o smoothness -u 693f1eba5167517fb0b05e6970f91951 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230408_005556
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_wine_nll betwen [15.51998549 22.35390307 19.16402613  3.37792524 14.64310022] and [16.06396227 23.27425025 19.80193088  3.46391821 15.2105797 ]
  warnings.warn(

Signature errors:
                          0         1         2         3         4       max
MLP-adam_wine_nll  0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
max                0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
starting sklearn study smoothness MLP-adam wine nll 15 1
with data root: None
suggestion time taken 11.524884 iter 0 next_points [{'alpha': 0.002673544881075127, 'batch_size': 15, 'beta_1': 0.7226345210100257, 'beta_2': 0.9423979161235664, 'epsilon': 1.62298028201835e-08, 'hidden_layer_sizes': 124, 'learning_rate_init': 0.004534455860825718, 'tol': 2.020441573412933e-05, 'validation_fraction': 0.18161644303068653}]
function_evaluation time 0.261146 value 1.243375 suggestion {'alpha': 0.002673544881075127, 'batch_size': 15, 'beta_1': 0.7226345210100257, 'beta_2': 0.9423979161235664, 'epsilon': 1.62298028201835e-08, 'hidden_layer_sizes': 124, 'learning_rate_init': 0.004534455860825718, 'tol': 2.020441573412933e-05, 'validation_fraction': 0.18161644303068653}
observation time 0.000007, current best 1.243375 at iter 0
suggestion time taken 11.404676 iter 1 next_points [{'alpha': 0.00010402034278512426, 'batch_size': 54, 'beta_1': 0.5899475852551863, 'beta_2': 0.9988159247777536, 'epsilon': 1.141377775662764e-08, 'hidden_layer_sizes': 95, 'learning_rate_init': 1.2882105715489768e-05, 'tol': 0.0029016165672402206, 'validation_fraction': 0.11836157431846395}]
function_evaluation time 0.062186 value 19.844985 suggestion {'alpha': 0.00010402034278512426, 'batch_size': 54, 'beta_1': 0.5899475852551863, 'beta_2': 0.9988159247777536, 'epsilon': 1.141377775662764e-08, 'hidden_layer_sizes': 95, 'learning_rate_init': 1.2882105715489768e-05, 'tol': 0.0029016165672402206, 'validation_fraction': 0.11836157431846395}
observation time 0.000005, current best 1.243375 at iter 1
suggestion time taken 11.311344 iter 2 next_points [{'alpha': 0.001601565001338161, 'batch_size': 28, 'beta_1': 0.900252132455744, 'beta_2': 0.9998446963131128, 'epsilon': 2.109717018897177e-08, 'hidden_layer_sizes': 75, 'learning_rate_init': 0.0003676903522062166, 'tol': 0.003496368606007743, 'validation_fraction': 0.6703406967816193}]
function_evaluation time 0.085831 value 17.274829 suggestion {'alpha': 0.001601565001338161, 'batch_size': 28, 'beta_1': 0.900252132455744, 'beta_2': 0.9998446963131128, 'epsilon': 2.109717018897177e-08, 'hidden_layer_sizes': 75, 'learning_rate_init': 0.0003676903522062166, 'tol': 0.003496368606007743, 'validation_fraction': 0.6703406967816193}
observation time 0.000006, current best 1.243375 at iter 2
suggestion time taken 11.878744 iter 3 next_points [{'alpha': 0.004219090390610948, 'batch_size': 11, 'beta_1': 0.9830463215100749, 'beta_2': 0.9997031763457911, 'epsilon': 1.5171476713366857e-09, 'hidden_layer_sizes': 87, 'learning_rate_init': 0.026495040675106003, 'tol': 0.0002596855559812908, 'validation_fraction': 0.251522268403822}]
function_evaluation time 0.277548 value 1.051770 suggestion {'alpha': 0.004219090390610948, 'batch_size': 11, 'beta_1': 0.9830463215100749, 'beta_2': 0.9997031763457911, 'epsilon': 1.5171476713366857e-09, 'hidden_layer_sizes': 87, 'learning_rate_init': 0.026495040675106003, 'tol': 0.0002596855559812908, 'validation_fraction': 0.251522268403822}
observation time 0.000006, current best 1.051770 at iter 3
suggestion time taken 11.611727 iter 4 next_points [{'alpha': 0.13918098419676928, 'batch_size': 15, 'beta_1': 0.8347508893703759, 'beta_2': 0.9999579912762036, 'epsilon': 4.409576586257479e-09, 'hidden_layer_sizes': 182, 'learning_rate_init': 0.0009413837223755156, 'tol': 1.4041415756934397e-05, 'validation_fraction': 0.8855622348353744}]
function_evaluation time 0.088125 value 11.900194 suggestion {'alpha': 0.13918098419676928, 'batch_size': 15, 'beta_1': 0.8347508893703759, 'beta_2': 0.9999579912762036, 'epsilon': 4.409576586257479e-09, 'hidden_layer_sizes': 182, 'learning_rate_init': 0.0009413837223755156, 'tol': 1.4041415756934397e-05, 'validation_fraction': 0.8855622348353744}
observation time 0.000006, current best 1.051770 at iter 4
suggestion time taken 11.841591 iter 5 next_points [{'alpha': 0.00016320221587101547, 'batch_size': 20, 'beta_1': 0.9371433952736984, 'beta_2': 0.999185134314098, 'epsilon': 3.7429231797159927e-08, 'hidden_layer_sizes': 90, 'learning_rate_init': 3.599353232468688e-05, 'tol': 0.0011300240131047262, 'validation_fraction': 0.14258834441429155}]
function_evaluation time 0.092909 value 23.103905 suggestion {'alpha': 0.00016320221587101547, 'batch_size': 20, 'beta_1': 0.9371433952736984, 'beta_2': 0.999185134314098, 'epsilon': 3.7429231797159927e-08, 'hidden_layer_sizes': 90, 'learning_rate_init': 3.599353232468688e-05, 'tol': 0.0011300240131047262, 'validation_fraction': 0.14258834441429155}
observation time 0.000006, current best 1.051770 at iter 5
suggestion time taken 11.526996 iter 6 next_points [{'alpha': 0.0014619044221345053, 'batch_size': 17, 'beta_1': 0.9803718937797452, 'beta_2': 0.9855018993043084, 'epsilon': 6.635109902548183e-08, 'hidden_layer_sizes': 199, 'learning_rate_init': 0.03556270071191203, 'tol': 0.0024386252456089323, 'validation_fraction': 0.6746298912170836}]
function_evaluation time 0.170690 value 2.620541 suggestion {'alpha': 0.0014619044221345053, 'batch_size': 17, 'beta_1': 0.9803718937797452, 'beta_2': 0.9855018993043084, 'epsilon': 6.635109902548183e-08, 'hidden_layer_sizes': 199, 'learning_rate_init': 0.03556270071191203, 'tol': 0.0024386252456089323, 'validation_fraction': 0.6746298912170836}
observation time 0.000006, current best 1.051770 at iter 6
suggestion time taken 11.494503 iter 7 next_points [{'alpha': 0.14463277521213033, 'batch_size': 15, 'beta_1': 0.9395901383220832, 'beta_2': 0.9990635199332161, 'epsilon': 3.832384571896305e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 3.4749261611069256e-05, 'tol': 0.005880780147843659, 'validation_fraction': 0.7364538906089264}]
function_evaluation time 0.065148 value 24.103083 suggestion {'alpha': 0.14463277521213033, 'batch_size': 15, 'beta_1': 0.9395901383220832, 'beta_2': 0.9990635199332161, 'epsilon': 3.832384571896305e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 3.4749261611069256e-05, 'tol': 0.005880780147843659, 'validation_fraction': 0.7364538906089264}
observation time 0.000007, current best 1.051770 at iter 7
suggestion time taken 11.916572 iter 8 next_points [{'alpha': 5.614562191299264, 'batch_size': 40, 'beta_1': 0.6007952817263842, 'beta_2': 0.999960419702981, 'epsilon': 1.5355427758700307e-09, 'hidden_layer_sizes': 79, 'learning_rate_init': 0.007677257644608195, 'tol': 2.750704548285185e-05, 'validation_fraction': 0.7854981818342514}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.116030 value 6.539850 suggestion {'alpha': 5.614562191299264, 'batch_size': 40, 'beta_1': 0.6007952817263842, 'beta_2': 0.999960419702981, 'epsilon': 1.5355427758700307e-09, 'hidden_layer_sizes': 79, 'learning_rate_init': 0.007677257644608195, 'tol': 2.750704548285185e-05, 'validation_fraction': 0.7854981818342514}
observation time 0.000005, current best 1.051770 at iter 8
suggestion time taken 11.629351 iter 9 next_points [{'alpha': 1.1679609100954125e-05, 'batch_size': 25, 'beta_1': 0.968627590504719, 'beta_2': 0.9999559426110871, 'epsilon': 2.7668636026904873e-09, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.020734158249405044, 'tol': 0.018916435468079106, 'validation_fraction': 0.5725312060967559}]
function_evaluation time 0.135189 value 1.627678 suggestion {'alpha': 1.1679609100954125e-05, 'batch_size': 25, 'beta_1': 0.968627590504719, 'beta_2': 0.9999559426110871, 'epsilon': 2.7668636026904873e-09, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.020734158249405044, 'tol': 0.018916435468079106, 'validation_fraction': 0.5725312060967559}
observation time 0.000006, current best 1.051770 at iter 9
suggestion time taken 11.638513 iter 10 next_points [{'alpha': 7.972311492709832, 'batch_size': 13, 'beta_1': 0.9444412194435708, 'beta_2': 0.9999980817230946, 'epsilon': 1.104414270017549e-09, 'hidden_layer_sizes': 155, 'learning_rate_init': 0.016986838976122666, 'tol': 2.427223073781767e-05, 'validation_fraction': 0.2127459224495524}]
function_evaluation time 0.192762 value 1.559167 suggestion {'alpha': 7.972311492709832, 'batch_size': 13, 'beta_1': 0.9444412194435708, 'beta_2': 0.9999980817230946, 'epsilon': 1.104414270017549e-09, 'hidden_layer_sizes': 155, 'learning_rate_init': 0.016986838976122666, 'tol': 2.427223073781767e-05, 'validation_fraction': 0.2127459224495524}
observation time 0.000006, current best 1.051770 at iter 10
suggestion time taken 12.234144 iter 11 next_points [{'alpha': 0.09257803223242198, 'batch_size': 10, 'beta_1': 0.6971709255239367, 'beta_2': 0.9970734391719814, 'epsilon': 8.900203264148725e-08, 'hidden_layer_sizes': 133, 'learning_rate_init': 0.03991121653233771, 'tol': 0.0017623552426160385, 'validation_fraction': 0.4506482792317647}]
function_evaluation time 0.259385 value 0.842999 suggestion {'alpha': 0.09257803223242198, 'batch_size': 10, 'beta_1': 0.6971709255239367, 'beta_2': 0.9970734391719814, 'epsilon': 8.900203264148725e-08, 'hidden_layer_sizes': 133, 'learning_rate_init': 0.03991121653233771, 'tol': 0.0017623552426160385, 'validation_fraction': 0.4506482792317647}
observation time 0.000006, current best 0.842999 at iter 11
suggestion time taken 11.707373 iter 12 next_points [{'alpha': 0.2824564575612169, 'batch_size': 12, 'beta_1': 0.5439291183290428, 'beta_2': 0.9996791231006478, 'epsilon': 2.3468725351330842e-08, 'hidden_layer_sizes': 151, 'learning_rate_init': 0.00030498629690510953, 'tol': 0.0151638501436739, 'validation_fraction': 0.8878240284102561}]
function_evaluation time 0.070682 value 15.197148 suggestion {'alpha': 0.2824564575612169, 'batch_size': 12, 'beta_1': 0.5439291183290428, 'beta_2': 0.9996791231006478, 'epsilon': 2.3468725351330842e-08, 'hidden_layer_sizes': 151, 'learning_rate_init': 0.00030498629690510953, 'tol': 0.0151638501436739, 'validation_fraction': 0.8878240284102561}
observation time 0.000006, current best 0.842999 at iter 12
suggestion time taken 11.799104 iter 13 next_points [{'alpha': 0.1307851552410422, 'batch_size': 11, 'beta_1': 0.9607954592981567, 'beta_2': 0.9995456660593763, 'epsilon': 9.455053784685292e-09, 'hidden_layer_sizes': 130, 'learning_rate_init': 0.00028519020588586413, 'tol': 0.00036068530573417026, 'validation_fraction': 0.6485471170749089}]
function_evaluation time 0.140112 value 13.093583 suggestion {'alpha': 0.1307851552410422, 'batch_size': 11, 'beta_1': 0.9607954592981567, 'beta_2': 0.9995456660593763, 'epsilon': 9.455053784685292e-09, 'hidden_layer_sizes': 130, 'learning_rate_init': 0.00028519020588586413, 'tol': 0.00036068530573417026, 'validation_fraction': 0.6485471170749089}
observation time 0.000006, current best 0.842999 at iter 13
suggestion time taken 12.071708 iter 14 next_points [{'alpha': 0.0065059495547726215, 'batch_size': 17, 'beta_1': 0.9671434349231179, 'beta_2': 0.9999988770231626, 'epsilon': 3.000306341364931e-08, 'hidden_layer_sizes': 155, 'learning_rate_init': 1.5195197010475068e-05, 'tol': 0.029260060963824355, 'validation_fraction': 0.5475205907877114}]
function_evaluation time 0.079823 value 22.306185 suggestion {'alpha': 0.0065059495547726215, 'batch_size': 17, 'beta_1': 0.9671434349231179, 'beta_2': 0.9999988770231626, 'epsilon': 3.000306341364931e-08, 'hidden_layer_sizes': 155, 'learning_rate_init': 1.5195197010475068e-05, 'tol': 0.029260060963824355, 'validation_fraction': 0.5475205907877114}
observation time 0.000006, current best 0.842999 at iter 14
saving meta data: {'args': {'--uuid': '693f1eba5167517fb0b05e6970f91951', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230408_005556', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])}
saving results
saving timing
saving suggest log
done
