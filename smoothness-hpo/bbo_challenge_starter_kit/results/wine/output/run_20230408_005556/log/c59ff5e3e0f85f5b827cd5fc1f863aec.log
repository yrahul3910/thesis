running: {'--uuid': 'c59ff5e3e0f85f5b827cd5fc1f863aec', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230408_005556', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d wine -o smoothness -u c59ff5e3e0f85f5b827cd5fc1f863aec -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230408_005556
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_wine_nll betwen [15.51998549 22.35390307 19.16402613  3.37792524 14.64310022] and [16.06396227 23.27425025 19.80193088  3.46391821 15.2105797 ]
  warnings.warn(

Signature errors:
                          0         1         2         3         4       max
MLP-adam_wine_nll  0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
max                0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
starting sklearn study smoothness MLP-adam wine nll 15 1
with data root: None
suggestion time taken 11.706638 iter 0 next_points [{'alpha': 0.00040174995900305445, 'batch_size': 22, 'beta_1': 0.8260206142807, 'beta_2': 0.9654501719266521, 'epsilon': 5.2803533209301975e-08, 'hidden_layer_sizes': 78, 'learning_rate_init': 0.0001932668804563283, 'tol': 9.998428706300066e-05, 'validation_fraction': 0.3280353458505997}]
function_evaluation time 0.175894 value 9.420353 suggestion {'alpha': 0.00040174995900305445, 'batch_size': 22, 'beta_1': 0.8260206142807, 'beta_2': 0.9654501719266521, 'epsilon': 5.2803533209301975e-08, 'hidden_layer_sizes': 78, 'learning_rate_init': 0.0001932668804563283, 'tol': 9.998428706300066e-05, 'validation_fraction': 0.3280353458505997}
observation time 0.000006, current best 9.420353 at iter 0
suggestion time taken 11.442859 iter 1 next_points [{'alpha': 0.09095856274620011, 'batch_size': 37, 'beta_1': 0.9541440182404, 'beta_2': 0.9973624448221032, 'epsilon': 4.891523097649442e-08, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.0013292783222387916, 'tol': 3.9905579546742666e-05, 'validation_fraction': 0.1470676888267491}]
function_evaluation time 0.143306 value 9.444606 suggestion {'alpha': 0.09095856274620011, 'batch_size': 37, 'beta_1': 0.9541440182404, 'beta_2': 0.9973624448221032, 'epsilon': 4.891523097649442e-08, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.0013292783222387916, 'tol': 3.9905579546742666e-05, 'validation_fraction': 0.1470676888267491}
observation time 0.000005, current best 9.420353 at iter 1
suggestion time taken 11.256417 iter 2 next_points [{'alpha': 9.419435440995547e-05, 'batch_size': 15, 'beta_1': 0.8319496461385005, 'beta_2': 0.9999979345800769, 'epsilon': 1.5593929963667414e-07, 'hidden_layer_sizes': 134, 'learning_rate_init': 8.470760956696104e-05, 'tol': 1.1286940948086205e-05, 'validation_fraction': 0.20105571943484973}]
function_evaluation time 0.188692 value 11.338037 suggestion {'alpha': 9.419435440995547e-05, 'batch_size': 15, 'beta_1': 0.8319496461385005, 'beta_2': 0.9999979345800769, 'epsilon': 1.5593929963667414e-07, 'hidden_layer_sizes': 134, 'learning_rate_init': 8.470760956696104e-05, 'tol': 1.1286940948086205e-05, 'validation_fraction': 0.20105571943484973}
observation time 0.000006, current best 9.420353 at iter 2
suggestion time taken 11.578052 iter 3 next_points [{'alpha': 0.00044222484823184795, 'batch_size': 11, 'beta_1': 0.9142566246618811, 'beta_2': 0.9999964220170323, 'epsilon': 3.748956564511886e-07, 'hidden_layer_sizes': 175, 'learning_rate_init': 7.874666782001829e-05, 'tol': 1.4232888693064835e-05, 'validation_fraction': 0.7997242260320191}]
function_evaluation time 0.253228 value 11.326671 suggestion {'alpha': 0.00044222484823184795, 'batch_size': 11, 'beta_1': 0.9142566246618811, 'beta_2': 0.9999964220170323, 'epsilon': 3.748956564511886e-07, 'hidden_layer_sizes': 175, 'learning_rate_init': 7.874666782001829e-05, 'tol': 1.4232888693064835e-05, 'validation_fraction': 0.7997242260320191}
observation time 0.000006, current best 9.420353 at iter 3
suggestion time taken 11.521358 iter 4 next_points [{'alpha': 2.041409972296782, 'batch_size': 11, 'beta_1': 0.5012655657541479, 'beta_2': 0.9994309402333839, 'epsilon': 2.5336502209354224e-07, 'hidden_layer_sizes': 63, 'learning_rate_init': 2.694899964664662e-05, 'tol': 0.01642031973981419, 'validation_fraction': 0.8935884676494039}]
function_evaluation time 0.056557 value 23.098985 suggestion {'alpha': 2.041409972296782, 'batch_size': 11, 'beta_1': 0.5012655657541479, 'beta_2': 0.9994309402333839, 'epsilon': 2.5336502209354224e-07, 'hidden_layer_sizes': 63, 'learning_rate_init': 2.694899964664662e-05, 'tol': 0.01642031973981419, 'validation_fraction': 0.8935884676494039}
observation time 0.000006, current best 9.420353 at iter 4
suggestion time taken 11.530877 iter 5 next_points [{'alpha': 1.5578364279132736e-05, 'batch_size': 12, 'beta_1': 0.9579840868093261, 'beta_2': 0.9997424564970373, 'epsilon': 2.904427404548931e-08, 'hidden_layer_sizes': 152, 'learning_rate_init': 6.544228658903802e-05, 'tol': 0.0005881690626384249, 'validation_fraction': 0.5344334378913489}]
function_evaluation time 0.127554 value 15.496499 suggestion {'alpha': 1.5578364279132736e-05, 'batch_size': 12, 'beta_1': 0.9579840868093261, 'beta_2': 0.9997424564970373, 'epsilon': 2.904427404548931e-08, 'hidden_layer_sizes': 152, 'learning_rate_init': 6.544228658903802e-05, 'tol': 0.0005881690626384249, 'validation_fraction': 0.5344334378913489}
observation time 0.000005, current best 9.420353 at iter 5
suggestion time taken 11.226845 iter 6 next_points [{'alpha': 0.0005732722909609296, 'batch_size': 23, 'beta_1': 0.9822878744905341, 'beta_2': 0.9999938150000738, 'epsilon': 3.0248817098312688e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 1.6253256690685517e-05, 'tol': 0.011404505797604464, 'validation_fraction': 0.7472342681934592}]
function_evaluation time 0.055766 value 22.474555 suggestion {'alpha': 0.0005732722909609296, 'batch_size': 23, 'beta_1': 0.9822878744905341, 'beta_2': 0.9999938150000738, 'epsilon': 3.0248817098312688e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 1.6253256690685517e-05, 'tol': 0.011404505797604464, 'validation_fraction': 0.7472342681934592}
observation time 0.000005, current best 9.420353 at iter 6
suggestion time taken 11.611260 iter 7 next_points [{'alpha': 0.600417522188795, 'batch_size': 18, 'beta_1': 0.553820063605032, 'beta_2': 0.9995400286120827, 'epsilon': 3.948377490418359e-07, 'hidden_layer_sizes': 76, 'learning_rate_init': 4.846223861657694e-05, 'tol': 0.0036646993272279704, 'validation_fraction': 0.8043182063375569}]
function_evaluation time 0.057592 value 23.108809 suggestion {'alpha': 0.600417522188795, 'batch_size': 18, 'beta_1': 0.553820063605032, 'beta_2': 0.9995400286120827, 'epsilon': 3.948377490418359e-07, 'hidden_layer_sizes': 76, 'learning_rate_init': 4.846223861657694e-05, 'tol': 0.0036646993272279704, 'validation_fraction': 0.8043182063375569}
observation time 0.000006, current best 9.420353 at iter 7
suggestion time taken 11.675502 iter 8 next_points [{'alpha': 0.010391493977779073, 'batch_size': 14, 'beta_1': 0.8598307221606051, 'beta_2': 0.9080406542330832, 'epsilon': 3.2776229281621166e-07, 'hidden_layer_sizes': 113, 'learning_rate_init': 0.07907450672807345, 'tol': 0.004373751356679906, 'validation_fraction': 0.8908632554401189}]
function_evaluation time 0.084397 value 7.524392 suggestion {'alpha': 0.010391493977779073, 'batch_size': 14, 'beta_1': 0.8598307221606051, 'beta_2': 0.9080406542330832, 'epsilon': 3.2776229281621166e-07, 'hidden_layer_sizes': 113, 'learning_rate_init': 0.07907450672807345, 'tol': 0.004373751356679906, 'validation_fraction': 0.8908632554401189}
observation time 0.000006, current best 7.524392 at iter 8
suggestion time taken 11.408407 iter 9 next_points [{'alpha': 0.8806841290838427, 'batch_size': 15, 'beta_1': 0.7383634758356888, 'beta_2': 0.9998085869237723, 'epsilon': 9.361229623337229e-08, 'hidden_layer_sizes': 140, 'learning_rate_init': 0.020823798391929414, 'tol': 0.00026809259701034355, 'validation_fraction': 0.15957708346309327}]
function_evaluation time 0.268564 value 0.631783 suggestion {'alpha': 0.8806841290838427, 'batch_size': 15, 'beta_1': 0.7383634758356888, 'beta_2': 0.9998085869237723, 'epsilon': 9.361229623337229e-08, 'hidden_layer_sizes': 140, 'learning_rate_init': 0.020823798391929414, 'tol': 0.00026809259701034355, 'validation_fraction': 0.15957708346309327}
observation time 0.000005, current best 0.631783 at iter 9
suggestion time taken 11.549182 iter 10 next_points [{'alpha': 0.002547528272676005, 'batch_size': 20, 'beta_1': 0.5060558420901802, 'beta_2': 0.9999988902786461, 'epsilon': 5.818093862010072e-09, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.01346029146944071, 'tol': 0.0015856135606325391, 'validation_fraction': 0.7166682245301187}]
function_evaluation time 0.106939 value 3.591524 suggestion {'alpha': 0.002547528272676005, 'batch_size': 20, 'beta_1': 0.5060558420901802, 'beta_2': 0.9999988902786461, 'epsilon': 5.818093862010072e-09, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.01346029146944071, 'tol': 0.0015856135606325391, 'validation_fraction': 0.7166682245301187}
observation time 0.000006, current best 0.631783 at iter 10
suggestion time taken 11.258822 iter 11 next_points [{'alpha': 0.0009263857682410713, 'batch_size': 22, 'beta_1': 0.8493152621167318, 'beta_2': 0.9999985310777878, 'epsilon': 5.931287423057193e-07, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005037849272047071, 'tol': 3.689290047666246e-05, 'validation_fraction': 0.8086789324753063}]
function_evaluation time 0.084370 value 10.210868 suggestion {'alpha': 0.0009263857682410713, 'batch_size': 22, 'beta_1': 0.8493152621167318, 'beta_2': 0.9999985310777878, 'epsilon': 5.931287423057193e-07, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005037849272047071, 'tol': 3.689290047666246e-05, 'validation_fraction': 0.8086789324753063}
observation time 0.000006, current best 0.631783 at iter 11
suggestion time taken 11.258194 iter 12 next_points [{'alpha': 0.007787713446969701, 'batch_size': 26, 'beta_1': 0.9894324156358681, 'beta_2': 0.9998951500097005, 'epsilon': 1.5818110573039102e-07, 'hidden_layer_sizes': 91, 'learning_rate_init': 0.06857201179171077, 'tol': 0.005650091177394046, 'validation_fraction': 0.7067889569991317}]
function_evaluation time 0.096852 value 4.242771 suggestion {'alpha': 0.007787713446969701, 'batch_size': 26, 'beta_1': 0.9894324156358681, 'beta_2': 0.9998951500097005, 'epsilon': 1.5818110573039102e-07, 'hidden_layer_sizes': 91, 'learning_rate_init': 0.06857201179171077, 'tol': 0.005650091177394046, 'validation_fraction': 0.7067889569991317}
observation time 0.000005, current best 0.631783 at iter 12
suggestion time taken 11.145964 iter 13 next_points [{'alpha': 0.3290607862866845, 'batch_size': 19, 'beta_1': 0.97983125702578, 'beta_2': 0.9999988880680755, 'epsilon': 8.415407887745147e-08, 'hidden_layer_sizes': 162, 'learning_rate_init': 0.020745549447125613, 'tol': 1.2985541438926283e-05, 'validation_fraction': 0.6822648092557192}]
function_evaluation time 0.129545 value 2.684773 suggestion {'alpha': 0.3290607862866845, 'batch_size': 19, 'beta_1': 0.97983125702578, 'beta_2': 0.9999988880680755, 'epsilon': 8.415407887745147e-08, 'hidden_layer_sizes': 162, 'learning_rate_init': 0.020745549447125613, 'tol': 1.2985541438926283e-05, 'validation_fraction': 0.6822648092557192}
observation time 0.000006, current best 0.631783 at iter 13
suggestion time taken 11.509361 iter 14 next_points [{'alpha': 1.2038531600956244e-05, 'batch_size': 11, 'beta_1': 0.9297325804543124, 'beta_2': 0.9997564194590338, 'epsilon': 2.0138087996059455e-07, 'hidden_layer_sizes': 146, 'learning_rate_init': 1.775939052159084e-05, 'tol': 0.0008370679115213261, 'validation_fraction': 0.6550069412968393}]
function_evaluation time 0.094247 value 22.495232 suggestion {'alpha': 1.2038531600956244e-05, 'batch_size': 11, 'beta_1': 0.9297325804543124, 'beta_2': 0.9997564194590338, 'epsilon': 2.0138087996059455e-07, 'hidden_layer_sizes': 146, 'learning_rate_init': 1.775939052159084e-05, 'tol': 0.0008370679115213261, 'validation_fraction': 0.6550069412968393}
observation time 0.000005, current best 0.631783 at iter 14
saving meta data: {'args': {'--uuid': 'c59ff5e3e0f85f5b827cd5fc1f863aec', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230408_005556', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])}
saving results
saving timing
saving suggest log
done
