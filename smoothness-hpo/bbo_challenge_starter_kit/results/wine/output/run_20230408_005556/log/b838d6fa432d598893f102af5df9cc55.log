running: {'--uuid': 'b838d6fa432d598893f102af5df9cc55', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230408_005556', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d wine -o smoothness -u b838d6fa432d598893f102af5df9cc55 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230408_005556
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_wine_nll betwen [15.51998549 22.35390307 19.16402613  3.37792524 14.64310022] and [16.06396227 23.27425025 19.80193088  3.46391821 15.2105797 ]
  warnings.warn(

Signature errors:
                          0         1         2         3         4       max
MLP-adam_wine_nll  0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
max                0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
starting sklearn study smoothness MLP-adam wine nll 15 1
with data root: None
suggestion time taken 11.575199 iter 0 next_points [{'alpha': 0.00044123126092943235, 'batch_size': 18, 'beta_1': 0.6103384429989925, 'beta_2': 0.9999978455671332, 'epsilon': 2.9669940791932607e-07, 'hidden_layer_sizes': 106, 'learning_rate_init': 0.032041101452463035, 'tol': 0.04985894948326431, 'validation_fraction': 0.27209020534609446}]
function_evaluation time 0.209106 value 0.836515 suggestion {'alpha': 0.00044123126092943235, 'batch_size': 18, 'beta_1': 0.6103384429989925, 'beta_2': 0.9999978455671332, 'epsilon': 2.9669940791932607e-07, 'hidden_layer_sizes': 106, 'learning_rate_init': 0.032041101452463035, 'tol': 0.04985894948326431, 'validation_fraction': 0.27209020534609446}
observation time 0.000007, current best 0.836515 at iter 0
suggestion time taken 11.492406 iter 1 next_points [{'alpha': 2.871020240253204, 'batch_size': 36, 'beta_1': 0.834736087559683, 'beta_2': 0.9998286243728068, 'epsilon': 4.784263961539187e-07, 'hidden_layer_sizes': 170, 'learning_rate_init': 0.0008207237002832499, 'tol': 0.012301333399261346, 'validation_fraction': 0.41850581591375435}]
function_evaluation time 0.195053 value 3.374733 suggestion {'alpha': 2.871020240253204, 'batch_size': 36, 'beta_1': 0.834736087559683, 'beta_2': 0.9998286243728068, 'epsilon': 4.784263961539187e-07, 'hidden_layer_sizes': 170, 'learning_rate_init': 0.0008207237002832499, 'tol': 0.012301333399261346, 'validation_fraction': 0.41850581591375435}
observation time 0.000005, current best 0.836515 at iter 1
suggestion time taken 11.344805 iter 2 next_points [{'alpha': 2.118684516373357, 'batch_size': 20, 'beta_1': 0.9877575546659423, 'beta_2': 0.9999459589191639, 'epsilon': 1.5134747186503664e-09, 'hidden_layer_sizes': 65, 'learning_rate_init': 7.84785543589367e-05, 'tol': 0.009676237712451666, 'validation_fraction': 0.22644651448026973}]
function_evaluation time 0.087474 value 21.017439 suggestion {'alpha': 2.118684516373357, 'batch_size': 20, 'beta_1': 0.9877575546659423, 'beta_2': 0.9999459589191639, 'epsilon': 1.5134747186503664e-09, 'hidden_layer_sizes': 65, 'learning_rate_init': 7.84785543589367e-05, 'tol': 0.009676237712451666, 'validation_fraction': 0.22644651448026973}
observation time 0.000005, current best 0.836515 at iter 2
suggestion time taken 11.812589 iter 3 next_points [{'alpha': 3.064710746521046, 'batch_size': 15, 'beta_1': 0.9656854775439778, 'beta_2': 0.999504641515013, 'epsilon': 6.636744128066544e-07, 'hidden_layer_sizes': 91, 'learning_rate_init': 4.812352555659389e-05, 'tol': 8.765008457239568e-05, 'validation_fraction': 0.19384079248950342}]
function_evaluation time 0.146239 value 18.109996 suggestion {'alpha': 3.064710746521046, 'batch_size': 15, 'beta_1': 0.9656854775439778, 'beta_2': 0.999504641515013, 'epsilon': 6.636744128066544e-07, 'hidden_layer_sizes': 91, 'learning_rate_init': 4.812352555659389e-05, 'tol': 8.765008457239568e-05, 'validation_fraction': 0.19384079248950342}
observation time 0.000006, current best 0.836515 at iter 3
suggestion time taken 11.501684 iter 4 next_points [{'alpha': 1.8849634247222537e-05, 'batch_size': 25, 'beta_1': 0.5968250560066992, 'beta_2': 0.9935099222618018, 'epsilon': 3.78464928937777e-09, 'hidden_layer_sizes': 193, 'learning_rate_init': 0.0003841018063268385, 'tol': 0.015118221399598663, 'validation_fraction': 0.6733290965091722}]
function_evaluation time 0.116504 value 14.244829 suggestion {'alpha': 1.8849634247222537e-05, 'batch_size': 25, 'beta_1': 0.5968250560066992, 'beta_2': 0.9935099222618018, 'epsilon': 3.78464928937777e-09, 'hidden_layer_sizes': 193, 'learning_rate_init': 0.0003841018063268385, 'tol': 0.015118221399598663, 'validation_fraction': 0.6733290965091722}
observation time 0.000006, current best 0.836515 at iter 4
suggestion time taken 11.809969 iter 5 next_points [{'alpha': 0.5445429554760989, 'batch_size': 16, 'beta_1': 0.9877313273614922, 'beta_2': 0.9999627792316038, 'epsilon': 2.536341019144293e-07, 'hidden_layer_sizes': 75, 'learning_rate_init': 1.386969835657894e-05, 'tol': 0.0005181324360074156, 'validation_fraction': 0.10577868629667692}]
function_evaluation time 0.109773 value 23.791580 suggestion {'alpha': 0.5445429554760989, 'batch_size': 16, 'beta_1': 0.9877313273614922, 'beta_2': 0.9999627792316038, 'epsilon': 2.536341019144293e-07, 'hidden_layer_sizes': 75, 'learning_rate_init': 1.386969835657894e-05, 'tol': 0.0005181324360074156, 'validation_fraction': 0.10577868629667692}
observation time 0.000006, current best 0.836515 at iter 5
suggestion time taken 11.696953 iter 6 next_points [{'alpha': 0.006664982502772099, 'batch_size': 13, 'beta_1': 0.696695709646205, 'beta_2': 0.9998864710166058, 'epsilon': 1.7848790065169179e-09, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.000822642474554522, 'tol': 0.00015941495985429235, 'validation_fraction': 0.3555947208467698}]
function_evaluation time 0.282932 value 0.487511 suggestion {'alpha': 0.006664982502772099, 'batch_size': 13, 'beta_1': 0.696695709646205, 'beta_2': 0.9998864710166058, 'epsilon': 1.7848790065169179e-09, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.000822642474554522, 'tol': 0.00015941495985429235, 'validation_fraction': 0.3555947208467698}
observation time 0.000005, current best 0.487511 at iter 6
suggestion time taken 11.593394 iter 7 next_points [{'alpha': 0.158394148515341, 'batch_size': 20, 'beta_1': 0.9604203275220152, 'beta_2': 0.9187409649112728, 'epsilon': 4.8292130746215216e-08, 'hidden_layer_sizes': 187, 'learning_rate_init': 0.0005642128780260063, 'tol': 0.052863258733422805, 'validation_fraction': 0.8920758492806795}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.057376 value 18.506169 suggestion {'alpha': 0.158394148515341, 'batch_size': 20, 'beta_1': 0.9604203275220152, 'beta_2': 0.9187409649112728, 'epsilon': 4.8292130746215216e-08, 'hidden_layer_sizes': 187, 'learning_rate_init': 0.0005642128780260063, 'tol': 0.052863258733422805, 'validation_fraction': 0.8920758492806795}
observation time 0.000005, current best 0.487511 at iter 7
suggestion time taken 11.785146 iter 8 next_points [{'alpha': 0.1364943321817311, 'batch_size': 12, 'beta_1': 0.885881074326702, 'beta_2': 0.9979131831364333, 'epsilon': 3.297352153495704e-08, 'hidden_layer_sizes': 169, 'learning_rate_init': 0.06582069281557835, 'tol': 0.0003582595853120859, 'validation_fraction': 0.7797315144898782}]
function_evaluation time 0.139728 value 1.361148 suggestion {'alpha': 0.1364943321817311, 'batch_size': 12, 'beta_1': 0.885881074326702, 'beta_2': 0.9979131831364333, 'epsilon': 3.297352153495704e-08, 'hidden_layer_sizes': 169, 'learning_rate_init': 0.06582069281557835, 'tol': 0.0003582595853120859, 'validation_fraction': 0.7797315144898782}
observation time 0.000005, current best 0.487511 at iter 8
suggestion time taken 11.742203 iter 9 next_points [{'alpha': 2.3054395503848818e-05, 'batch_size': 15, 'beta_1': 0.8459896453579713, 'beta_2': 0.9999952680974868, 'epsilon': 7.143550315566974e-08, 'hidden_layer_sizes': 176, 'learning_rate_init': 4.1186751306484604e-05, 'tol': 4.15990466751604e-05, 'validation_fraction': 0.2225941646712741}]
function_evaluation time 0.168556 value 16.357862 suggestion {'alpha': 2.3054395503848818e-05, 'batch_size': 15, 'beta_1': 0.8459896453579713, 'beta_2': 0.9999952680974868, 'epsilon': 7.143550315566974e-08, 'hidden_layer_sizes': 176, 'learning_rate_init': 4.1186751306484604e-05, 'tol': 4.15990466751604e-05, 'validation_fraction': 0.2225941646712741}
observation time 0.000010, current best 0.487511 at iter 9
suggestion time taken 11.633048 iter 10 next_points [{'alpha': 0.13446300818285034, 'batch_size': 44, 'beta_1': 0.7636455817732086, 'beta_2': 0.9990845951986833, 'epsilon': 1.133078125546293e-07, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.00015316996907561328, 'tol': 2.7449725634737103e-05, 'validation_fraction': 0.5852680126088857}]
function_evaluation time 0.065492 value 20.049258 suggestion {'alpha': 0.13446300818285034, 'batch_size': 44, 'beta_1': 0.7636455817732086, 'beta_2': 0.9990845951986833, 'epsilon': 1.133078125546293e-07, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.00015316996907561328, 'tol': 2.7449725634737103e-05, 'validation_fraction': 0.5852680126088857}
observation time 0.000006, current best 0.487511 at iter 10
suggestion time taken 11.989800 iter 11 next_points [{'alpha': 0.2732785168322124, 'batch_size': 22, 'beta_1': 0.9834756264398389, 'beta_2': 0.9433407421599609, 'epsilon': 3.5613989215640057e-09, 'hidden_layer_sizes': 149, 'learning_rate_init': 0.0006567466153312167, 'tol': 0.09684824874512649, 'validation_fraction': 0.5961151405148768}]
function_evaluation time 0.097020 value 8.559606 suggestion {'alpha': 0.2732785168322124, 'batch_size': 22, 'beta_1': 0.9834756264398389, 'beta_2': 0.9433407421599609, 'epsilon': 3.5613989215640057e-09, 'hidden_layer_sizes': 149, 'learning_rate_init': 0.0006567466153312167, 'tol': 0.09684824874512649, 'validation_fraction': 0.5961151405148768}
observation time 0.000006, current best 0.487511 at iter 11
suggestion time taken 11.896421 iter 12 next_points [{'alpha': 0.07015063384113067, 'batch_size': 13, 'beta_1': 0.9881422694384314, 'beta_2': 0.9999937537815013, 'epsilon': 5.202203560469941e-07, 'hidden_layer_sizes': 137, 'learning_rate_init': 0.004139447533660965, 'tol': 8.776634914184685e-05, 'validation_fraction': 0.3350350792235197}]
function_evaluation time 0.220311 value 1.088531 suggestion {'alpha': 0.07015063384113067, 'batch_size': 13, 'beta_1': 0.9881422694384314, 'beta_2': 0.9999937537815013, 'epsilon': 5.202203560469941e-07, 'hidden_layer_sizes': 137, 'learning_rate_init': 0.004139447533660965, 'tol': 8.776634914184685e-05, 'validation_fraction': 0.3350350792235197}
observation time 0.000006, current best 0.487511 at iter 12
suggestion time taken 11.602908 iter 13 next_points [{'alpha': 3.0160807840816603e-05, 'batch_size': 46, 'beta_1': 0.8952169159496288, 'beta_2': 0.9995844832839402, 'epsilon': 1.2523376240805595e-09, 'hidden_layer_sizes': 144, 'learning_rate_init': 0.0003234232154770972, 'tol': 0.0159308441928542, 'validation_fraction': 0.8605976988973338}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.056200 value 20.009931 suggestion {'alpha': 3.0160807840816603e-05, 'batch_size': 46, 'beta_1': 0.8952169159496288, 'beta_2': 0.9995844832839402, 'epsilon': 1.2523376240805595e-09, 'hidden_layer_sizes': 144, 'learning_rate_init': 0.0003234232154770972, 'tol': 0.0159308441928542, 'validation_fraction': 0.8605976988973338}
observation time 0.000005, current best 0.487511 at iter 13
suggestion time taken 11.965319 iter 14 next_points [{'alpha': 5.009866248215504, 'batch_size': 76, 'beta_1': 0.9425299602095248, 'beta_2': 0.9994196905702394, 'epsilon': 5.0965862959793405e-08, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.0002184821196301928, 'tol': 6.51657039166865e-05, 'validation_fraction': 0.17377436137629995}]
function_evaluation time 0.074401 value 17.798214 suggestion {'alpha': 5.009866248215504, 'batch_size': 76, 'beta_1': 0.9425299602095248, 'beta_2': 0.9994196905702394, 'epsilon': 5.0965862959793405e-08, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.0002184821196301928, 'tol': 6.51657039166865e-05, 'validation_fraction': 0.17377436137629995}
observation time 0.000006, current best 0.487511 at iter 14
saving meta data: {'args': {'--uuid': 'b838d6fa432d598893f102af5df9cc55', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230408_005556', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])}
saving results
saving timing
saving suggest log
done
