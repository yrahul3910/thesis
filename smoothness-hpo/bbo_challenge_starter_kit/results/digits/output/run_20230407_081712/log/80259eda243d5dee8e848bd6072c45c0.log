running: {'--uuid': '80259eda243d5dee8e848bd6072c45c0', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u 80259eda243d5dee8e848bd6072c45c0 -m acc -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_081712
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_acc betwen [-0.2181506  -0.12954897 -0.42701514 -0.94997127 -0.93320509] and [-0.21081107 -0.11575494 -0.27999177 -0.94225223 -0.93253861]
  warnings.warn(

Signature errors:
                           0         1         2         3         4       max
MLP-adam_digits_acc  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
max                  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
starting sklearn study smoothness MLP-adam digits acc 15 1
with data root: None
suggestion time taken 11.270802 iter 0 next_points [{'alpha': 1.8507578252292618, 'batch_size': 13, 'beta_1': 0.9833246395001304, 'beta_2': 0.9983206574517831, 'epsilon': 1.0162102442137227e-09, 'hidden_layer_sizes': 173, 'learning_rate_init': 2.184176664676749e-05, 'tol': 0.003918840033550832, 'validation_fraction': 0.25046614381898785}]
function_evaluation time 9.439893 value -0.923449 suggestion {'alpha': 1.8507578252292618, 'batch_size': 13, 'beta_1': 0.9833246395001304, 'beta_2': 0.9983206574517831, 'epsilon': 1.0162102442137227e-09, 'hidden_layer_sizes': 173, 'learning_rate_init': 2.184176664676749e-05, 'tol': 0.003918840033550832, 'validation_fraction': 0.25046614381898785}
observation time 0.000005, current best -0.923449 at iter 0
suggestion time taken 11.242454 iter 1 next_points [{'alpha': 0.007129659298959201, 'batch_size': 24, 'beta_1': 0.937793873490379, 'beta_2': 0.9638673234310285, 'epsilon': 1.0782208194271541e-08, 'hidden_layer_sizes': 50, 'learning_rate_init': 0.00010776086104199558, 'tol': 1.901521357753767e-05, 'validation_fraction': 0.7467077665234702}]
function_evaluation time 4.748146 value -0.894217 suggestion {'alpha': 0.007129659298959201, 'batch_size': 24, 'beta_1': 0.937793873490379, 'beta_2': 0.9638673234310285, 'epsilon': 1.0782208194271541e-08, 'hidden_layer_sizes': 50, 'learning_rate_init': 0.00010776086104199558, 'tol': 1.901521357753767e-05, 'validation_fraction': 0.7467077665234702}
observation time 0.000005, current best -0.923449 at iter 1
suggestion time taken 10.872158 iter 2 next_points [{'alpha': 0.05215811074103419, 'batch_size': 30, 'beta_1': 0.7978775504302019, 'beta_2': 0.9999808878086663, 'epsilon': 1.7947965983181647e-08, 'hidden_layer_sizes': 144, 'learning_rate_init': 0.04738473753526557, 'tol': 0.0012591287349752512, 'validation_fraction': 0.2135250054986444}]
function_evaluation time 1.282902 value -0.777190 suggestion {'alpha': 0.05215811074103419, 'batch_size': 30, 'beta_1': 0.7978775504302019, 'beta_2': 0.9999808878086663, 'epsilon': 1.7947965983181647e-08, 'hidden_layer_sizes': 144, 'learning_rate_init': 0.04738473753526557, 'tol': 0.0012591287349752512, 'validation_fraction': 0.2135250054986444}
observation time 0.000005, current best -0.923449 at iter 2
suggestion time taken 11.428492 iter 3 next_points [{'alpha': 6.0355487848686314e-05, 'batch_size': 12, 'beta_1': 0.6469296527248597, 'beta_2': 0.9893731622609943, 'epsilon': 4.038784828174608e-09, 'hidden_layer_sizes': 74, 'learning_rate_init': 0.04810640121665376, 'tol': 0.0006572752713388091, 'validation_fraction': 0.4452237109232547}]
function_evaluation time 1.284845 value -0.770342 suggestion {'alpha': 6.0355487848686314e-05, 'batch_size': 12, 'beta_1': 0.6469296527248597, 'beta_2': 0.9893731622609943, 'epsilon': 4.038784828174608e-09, 'hidden_layer_sizes': 74, 'learning_rate_init': 0.04810640121665376, 'tol': 0.0006572752713388091, 'validation_fraction': 0.4452237109232547}
observation time 0.000005, current best -0.923449 at iter 3
suggestion time taken 10.929946 iter 4 next_points [{'alpha': 0.2875500732892095, 'batch_size': 24, 'beta_1': 0.9743842132300473, 'beta_2': 0.9988004730828648, 'epsilon': 2.363328513061935e-08, 'hidden_layer_sizes': 75, 'learning_rate_init': 0.0018009325781893398, 'tol': 6.75123123012551e-05, 'validation_fraction': 0.17837018199547322}]
function_evaluation time 1.999720 value -0.968680 suggestion {'alpha': 0.2875500732892095, 'batch_size': 24, 'beta_1': 0.9743842132300473, 'beta_2': 0.9988004730828648, 'epsilon': 2.363328513061935e-08, 'hidden_layer_sizes': 75, 'learning_rate_init': 0.0018009325781893398, 'tol': 6.75123123012551e-05, 'validation_fraction': 0.17837018199547322}
observation time 0.000004, current best -0.968680 at iter 4
suggestion time taken 11.257679 iter 5 next_points [{'alpha': 0.0011849485566315695, 'batch_size': 11, 'beta_1': 0.981173197835313, 'beta_2': 0.9746585481021526, 'epsilon': 6.391272211815592e-07, 'hidden_layer_sizes': 167, 'learning_rate_init': 5.041284499708462e-05, 'tol': 1.2088905242064007e-05, 'validation_fraction': 0.32872109169497415}]
function_evaluation time 10.557101 value -0.955473 suggestion {'alpha': 0.0011849485566315695, 'batch_size': 11, 'beta_1': 0.981173197835313, 'beta_2': 0.9746585481021526, 'epsilon': 6.391272211815592e-07, 'hidden_layer_sizes': 167, 'learning_rate_init': 5.041284499708462e-05, 'tol': 1.2088905242064007e-05, 'validation_fraction': 0.32872109169497415}
observation time 0.000004, current best -0.968680 at iter 5
suggestion time taken 10.875482 iter 6 next_points [{'alpha': 0.0014887913881690721, 'batch_size': 11, 'beta_1': 0.9744070974384099, 'beta_2': 0.9907030068383968, 'epsilon': 1.5240449409059864e-09, 'hidden_layer_sizes': 57, 'learning_rate_init': 0.005115234444115593, 'tol': 0.007587890001582826, 'validation_fraction': 0.2450298449384074}]
function_evaluation time 1.986114 value -0.949915 suggestion {'alpha': 0.0014887913881690721, 'batch_size': 11, 'beta_1': 0.9744070974384099, 'beta_2': 0.9907030068383968, 'epsilon': 1.5240449409059864e-09, 'hidden_layer_sizes': 57, 'learning_rate_init': 0.005115234444115593, 'tol': 0.007587890001582826, 'validation_fraction': 0.2450298449384074}
observation time 0.000004, current best -0.968680 at iter 6
suggestion time taken 11.149976 iter 7 next_points [{'alpha': 0.04715914671474619, 'batch_size': 27, 'beta_1': 0.7310524655628026, 'beta_2': 0.9999983012872858, 'epsilon': 2.177105924232727e-09, 'hidden_layer_sizes': 198, 'learning_rate_init': 0.0031752523918725122, 'tol': 0.03948631164388253, 'validation_fraction': 0.4416514862604621}]
function_evaluation time 1.119390 value -0.967305 suggestion {'alpha': 0.04715914671474619, 'batch_size': 27, 'beta_1': 0.7310524655628026, 'beta_2': 0.9999983012872858, 'epsilon': 2.177105924232727e-09, 'hidden_layer_sizes': 198, 'learning_rate_init': 0.0031752523918725122, 'tol': 0.03948631164388253, 'validation_fraction': 0.4416514862604621}
observation time 0.000005, current best -0.968680 at iter 7
suggestion time taken 10.970473 iter 8 next_points [{'alpha': 0.0009496668720741351, 'batch_size': 16, 'beta_1': 0.8069497940461428, 'beta_2': 0.9999527442596474, 'epsilon': 1.267125724383709e-07, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.004629069069340701, 'tol': 0.006059554783232766, 'validation_fraction': 0.5977313124674892}]
function_evaluation time 0.973823 value -0.950588 suggestion {'alpha': 0.0009496668720741351, 'batch_size': 16, 'beta_1': 0.8069497940461428, 'beta_2': 0.9999527442596474, 'epsilon': 1.267125724383709e-07, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.004629069069340701, 'tol': 0.006059554783232766, 'validation_fraction': 0.5977313124674892}
observation time 0.000005, current best -0.968680 at iter 8
suggestion time taken 10.962689 iter 9 next_points [{'alpha': 0.0008354976344341592, 'batch_size': 26, 'beta_1': 0.9896655236103339, 'beta_2': 0.9913360490176644, 'epsilon': 2.6797812989320264e-08, 'hidden_layer_sizes': 97, 'learning_rate_init': 0.0014841035943390743, 'tol': 0.00588757923803346, 'validation_fraction': 0.10634810311693736}]
function_evaluation time 1.627021 value -0.963110 suggestion {'alpha': 0.0008354976344341592, 'batch_size': 26, 'beta_1': 0.9896655236103339, 'beta_2': 0.9913360490176644, 'epsilon': 2.6797812989320264e-08, 'hidden_layer_sizes': 97, 'learning_rate_init': 0.0014841035943390743, 'tol': 0.00588757923803346, 'validation_fraction': 0.10634810311693736}
observation time 0.000005, current best -0.968680 at iter 9
suggestion time taken 11.296363 iter 10 next_points [{'alpha': 0.0588176263756415, 'batch_size': 11, 'beta_1': 0.9842648489843806, 'beta_2': 0.9999710879262802, 'epsilon': 1.2349099847932316e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 0.0001408550029973657, 'tol': 0.004473919458834616, 'validation_fraction': 0.8857493334595259}]
function_evaluation time 1.680582 value -0.837868 suggestion {'alpha': 0.0588176263756415, 'batch_size': 11, 'beta_1': 0.9842648489843806, 'beta_2': 0.9999710879262802, 'epsilon': 1.2349099847932316e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 0.0001408550029973657, 'tol': 0.004473919458834616, 'validation_fraction': 0.8857493334595259}
observation time 0.000004, current best -0.968680 at iter 10
suggestion time taken 10.933085 iter 11 next_points [{'alpha': 0.0006113054128777468, 'batch_size': 28, 'beta_1': 0.7148319938650356, 'beta_2': 0.9526112977150024, 'epsilon': 7.660472571984155e-08, 'hidden_layer_sizes': 193, 'learning_rate_init': 0.0022768872999292685, 'tol': 0.005989173904164894, 'validation_fraction': 0.1342302408616244}]
function_evaluation time 3.100871 value -0.973568 suggestion {'alpha': 0.0006113054128777468, 'batch_size': 28, 'beta_1': 0.7148319938650356, 'beta_2': 0.9526112977150024, 'epsilon': 7.660472571984155e-08, 'hidden_layer_sizes': 193, 'learning_rate_init': 0.0022768872999292685, 'tol': 0.005989173904164894, 'validation_fraction': 0.1342302408616244}
observation time 0.000005, current best -0.973568 at iter 11
suggestion time taken 10.889152 iter 12 next_points [{'alpha': 3.3545657939404334, 'batch_size': 26, 'beta_1': 0.7789323543086492, 'beta_2': 0.999974011956791, 'epsilon': 6.538859423112726e-07, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.05030826496371598, 'tol': 4.309164168079871e-05, 'validation_fraction': 0.8150273498448716}]
function_evaluation time 0.624634 value -0.819759 suggestion {'alpha': 3.3545657939404334, 'batch_size': 26, 'beta_1': 0.7789323543086492, 'beta_2': 0.999974011956791, 'epsilon': 6.538859423112726e-07, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.05030826496371598, 'tol': 4.309164168079871e-05, 'validation_fraction': 0.8150273498448716}
observation time 0.000005, current best -0.973568 at iter 12
suggestion time taken 11.189850 iter 13 next_points [{'alpha': 1.0940942663401643e-05, 'batch_size': 35, 'beta_1': 0.9866694417482891, 'beta_2': 0.9725648907860961, 'epsilon': 3.1836477089367976e-08, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.08237485876507515, 'tol': 1.1383637714306842e-05, 'validation_fraction': 0.865614908784442}]
function_evaluation time 0.195557 value -0.240067 suggestion {'alpha': 1.0940942663401643e-05, 'batch_size': 35, 'beta_1': 0.9866694417482891, 'beta_2': 0.9725648907860961, 'epsilon': 3.1836477089367976e-08, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.08237485876507515, 'tol': 1.1383637714306842e-05, 'validation_fraction': 0.865614908784442}
observation time 0.000004, current best -0.973568 at iter 13
suggestion time taken 10.983479 iter 14 next_points [{'alpha': 0.013805018746874799, 'batch_size': 10, 'beta_1': 0.9872757067160026, 'beta_2': 0.9960469222024659, 'epsilon': 3.960830289100632e-08, 'hidden_layer_sizes': 187, 'learning_rate_init': 2.929415405252948e-05, 'tol': 0.00230979513491559, 'validation_fraction': 0.7638955543842603}]
function_evaluation time 6.832287 value -0.895618 suggestion {'alpha': 0.013805018746874799, 'batch_size': 10, 'beta_1': 0.9872757067160026, 'beta_2': 0.9960469222024659, 'epsilon': 3.960830289100632e-08, 'hidden_layer_sizes': 187, 'learning_rate_init': 2.929415405252948e-05, 'tol': 0.00230979513491559, 'validation_fraction': 0.7638955543842603}
observation time 0.000005, current best -0.973568 at iter 14
saving meta data: {'args': {'--uuid': '80259eda243d5dee8e848bd6072c45c0', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])}
saving results
saving timing
saving suggest log
done
