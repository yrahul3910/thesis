running: {'--uuid': 'ee792220d61f56bfadf4d626616fd73c', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u ee792220d61f56bfadf4d626616fd73c -m acc -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_081712
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_acc betwen [-0.2181506  -0.12954897 -0.42701514 -0.94997127 -0.93320509] and [-0.21081107 -0.11575494 -0.27999177 -0.94225223 -0.93253861]
  warnings.warn(

Signature errors:
                           0         1         2         3         4       max
MLP-adam_digits_acc  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
max                  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
starting sklearn study smoothness MLP-adam digits acc 15 1
with data root: None
suggestion time taken 11.172127 iter 0 next_points [{'alpha': 5.8302735746020354e-05, 'batch_size': 22, 'beta_1': 0.6388223836250128, 'beta_2': 0.9518916446109267, 'epsilon': 1.287396889505416e-09, 'hidden_layer_sizes': 115, 'learning_rate_init': 2.366097419040064e-05, 'tol': 0.00046977159484584994, 'validation_fraction': 0.8898032008655476}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 2.819847 value -0.424499 suggestion {'alpha': 5.8302735746020354e-05, 'batch_size': 22, 'beta_1': 0.6388223836250128, 'beta_2': 0.9518916446109267, 'epsilon': 1.287396889505416e-09, 'hidden_layer_sizes': 115, 'learning_rate_init': 2.366097419040064e-05, 'tol': 0.00046977159484584994, 'validation_fraction': 0.8898032008655476}
observation time 0.000006, current best -0.424499 at iter 0
suggestion time taken 11.285109 iter 1 next_points [{'alpha': 1.0425705603453836, 'batch_size': 11, 'beta_1': 0.973845543433173, 'beta_2': 0.9918969749296485, 'epsilon': 8.548529368078029e-08, 'hidden_layer_sizes': 171, 'learning_rate_init': 2.0071234258973427e-05, 'tol': 0.013333566879214125, 'validation_fraction': 0.12890558408329503}]
function_evaluation time 9.796521 value -0.916500 suggestion {'alpha': 1.0425705603453836, 'batch_size': 11, 'beta_1': 0.973845543433173, 'beta_2': 0.9918969749296485, 'epsilon': 8.548529368078029e-08, 'hidden_layer_sizes': 171, 'learning_rate_init': 2.0071234258973427e-05, 'tol': 0.013333566879214125, 'validation_fraction': 0.12890558408329503}
observation time 0.000004, current best -0.916500 at iter 1
suggestion time taken 10.970614 iter 2 next_points [{'alpha': 0.0017624239815451233, 'batch_size': 21, 'beta_1': 0.8566979942836259, 'beta_2': 0.9999320567149353, 'epsilon': 3.673197371493594e-08, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.012226194405544236, 'tol': 0.003390328421260373, 'validation_fraction': 0.11686862772180862}]
function_evaluation time 1.555634 value -0.961024 suggestion {'alpha': 0.0017624239815451233, 'batch_size': 21, 'beta_1': 0.8566979942836259, 'beta_2': 0.9999320567149353, 'epsilon': 3.673197371493594e-08, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.012226194405544236, 'tol': 0.003390328421260373, 'validation_fraction': 0.11686862772180862}
observation time 0.000005, current best -0.961024 at iter 2
suggestion time taken 11.199605 iter 3 next_points [{'alpha': 0.0006191989996825686, 'batch_size': 11, 'beta_1': 0.9894130296208886, 'beta_2': 0.9990353101246379, 'epsilon': 1.1400384736274988e-09, 'hidden_layer_sizes': 156, 'learning_rate_init': 2.552715296074208e-05, 'tol': 0.00011948495907162562, 'validation_fraction': 0.7862370235349866}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 11.402166 value -0.889351 suggestion {'alpha': 0.0006191989996825686, 'batch_size': 11, 'beta_1': 0.9894130296208886, 'beta_2': 0.9990353101246379, 'epsilon': 1.1400384736274988e-09, 'hidden_layer_sizes': 156, 'learning_rate_init': 2.552715296074208e-05, 'tol': 0.00011948495907162562, 'validation_fraction': 0.7862370235349866}
observation time 0.000006, current best -0.961024 at iter 3
suggestion time taken 10.883697 iter 4 next_points [{'alpha': 9.045402909282247, 'batch_size': 10, 'beta_1': 0.8658145077050794, 'beta_2': 0.9953097003535983, 'epsilon': 3.540040263434559e-08, 'hidden_layer_sizes': 108, 'learning_rate_init': 0.0015280347629099368, 'tol': 0.010799497111044231, 'validation_fraction': 0.20298746764247863}]
function_evaluation time 2.149206 value -0.915128 suggestion {'alpha': 9.045402909282247, 'batch_size': 10, 'beta_1': 0.8658145077050794, 'beta_2': 0.9953097003535983, 'epsilon': 3.540040263434559e-08, 'hidden_layer_sizes': 108, 'learning_rate_init': 0.0015280347629099368, 'tol': 0.010799497111044231, 'validation_fraction': 0.20298746764247863}
observation time 0.000004, current best -0.961024 at iter 4
suggestion time taken 11.253302 iter 5 next_points [{'alpha': 0.03383202706492619, 'batch_size': 12, 'beta_1': 0.9734434853859861, 'beta_2': 0.9999863091715508, 'epsilon': 4.364215811825591e-07, 'hidden_layer_sizes': 198, 'learning_rate_init': 0.0010583028553352108, 'tol': 0.003186145576224678, 'validation_fraction': 0.12883030268631016}]
function_evaluation time 5.292331 value -0.970086 suggestion {'alpha': 0.03383202706492619, 'batch_size': 12, 'beta_1': 0.9734434853859861, 'beta_2': 0.9999863091715508, 'epsilon': 4.364215811825591e-07, 'hidden_layer_sizes': 198, 'learning_rate_init': 0.0010583028553352108, 'tol': 0.003186145576224678, 'validation_fraction': 0.12883030268631016}
observation time 0.000005, current best -0.970086 at iter 5
suggestion time taken 10.976809 iter 6 next_points [{'alpha': 9.996948017317576, 'batch_size': 25, 'beta_1': 0.9259569157289088, 'beta_2': 0.998731819787014, 'epsilon': 3.3367551694907824e-09, 'hidden_layer_sizes': 76, 'learning_rate_init': 0.00018547251296969916, 'tol': 0.0018282489784970924, 'validation_fraction': 0.5631189239315958}]
function_evaluation time 3.550076 value -0.931828 suggestion {'alpha': 9.996948017317576, 'batch_size': 25, 'beta_1': 0.9259569157289088, 'beta_2': 0.998731819787014, 'epsilon': 3.3367551694907824e-09, 'hidden_layer_sizes': 76, 'learning_rate_init': 0.00018547251296969916, 'tol': 0.0018282489784970924, 'validation_fraction': 0.5631189239315958}
observation time 0.000006, current best -0.970086 at iter 6
suggestion time taken 11.100906 iter 7 next_points [{'alpha': 0.10210504581277774, 'batch_size': 15, 'beta_1': 0.8522118890005106, 'beta_2': 0.9996858894063833, 'epsilon': 9.337041448449486e-07, 'hidden_layer_sizes': 90, 'learning_rate_init': 0.0020883847786193877, 'tol': 1.1637386192001666e-05, 'validation_fraction': 0.46289411092012067}]
function_evaluation time 2.914049 value -0.968682 suggestion {'alpha': 0.10210504581277774, 'batch_size': 15, 'beta_1': 0.8522118890005106, 'beta_2': 0.9996858894063833, 'epsilon': 9.337041448449486e-07, 'hidden_layer_sizes': 90, 'learning_rate_init': 0.0020883847786193877, 'tol': 1.1637386192001666e-05, 'validation_fraction': 0.46289411092012067}
observation time 0.000005, current best -0.970086 at iter 7
suggestion time taken 11.227386 iter 8 next_points [{'alpha': 1.3853476126983513e-05, 'batch_size': 14, 'beta_1': 0.9276929360106589, 'beta_2': 0.9999981287232724, 'epsilon': 1.737314101726363e-09, 'hidden_layer_sizes': 194, 'learning_rate_init': 0.0005215468338828211, 'tol': 0.000646301303658657, 'validation_fraction': 0.828161395829705}]
function_evaluation time 2.801145 value -0.919297 suggestion {'alpha': 1.3853476126983513e-05, 'batch_size': 14, 'beta_1': 0.9276929360106589, 'beta_2': 0.9999981287232724, 'epsilon': 1.737314101726363e-09, 'hidden_layer_sizes': 194, 'learning_rate_init': 0.0005215468338828211, 'tol': 0.000646301303658657, 'validation_fraction': 0.828161395829705}
observation time 0.000005, current best -0.970086 at iter 8
suggestion time taken 11.014522 iter 9 next_points [{'alpha': 0.1206324055568957, 'batch_size': 27, 'beta_1': 0.8569597592359188, 'beta_2': 0.999991186822329, 'epsilon': 1.7404513892154725e-07, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.010091670085869283, 'tol': 0.0026910855882135826, 'validation_fraction': 0.14887860168385397}]
function_evaluation time 1.673665 value -0.965205 suggestion {'alpha': 0.1206324055568957, 'batch_size': 27, 'beta_1': 0.8569597592359188, 'beta_2': 0.999991186822329, 'epsilon': 1.7404513892154725e-07, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.010091670085869283, 'tol': 0.0026910855882135826, 'validation_fraction': 0.14887860168385397}
observation time 0.000005, current best -0.970086 at iter 9
suggestion time taken 11.105134 iter 10 next_points [{'alpha': 0.0013683619779607384, 'batch_size': 12, 'beta_1': 0.9081618105719184, 'beta_2': 0.9993938698640237, 'epsilon': 2.125047160616806e-09, 'hidden_layer_sizes': 199, 'learning_rate_init': 0.0015537402299442458, 'tol': 0.0012868030840758144, 'validation_fraction': 0.6071427072763799}]
function_evaluation time 2.856853 value -0.951297 suggestion {'alpha': 0.0013683619779607384, 'batch_size': 12, 'beta_1': 0.9081618105719184, 'beta_2': 0.9993938698640237, 'epsilon': 2.125047160616806e-09, 'hidden_layer_sizes': 199, 'learning_rate_init': 0.0015537402299442458, 'tol': 0.0012868030840758144, 'validation_fraction': 0.6071427072763799}
observation time 0.000005, current best -0.970086 at iter 10
suggestion time taken 11.306478 iter 11 next_points [{'alpha': 1.1278701072057817e-05, 'batch_size': 39, 'beta_1': 0.9203573924925166, 'beta_2': 0.9998616178564068, 'epsilon': 2.406026024509012e-09, 'hidden_layer_sizes': 196, 'learning_rate_init': 0.044670403405451635, 'tol': 0.008003281389401483, 'validation_fraction': 0.19718127125831814}]
function_evaluation time 1.972140 value -0.933868 suggestion {'alpha': 1.1278701072057817e-05, 'batch_size': 39, 'beta_1': 0.9203573924925166, 'beta_2': 0.9998616178564068, 'epsilon': 2.406026024509012e-09, 'hidden_layer_sizes': 196, 'learning_rate_init': 0.044670403405451635, 'tol': 0.008003281389401483, 'validation_fraction': 0.19718127125831814}
observation time 0.000005, current best -0.970086 at iter 11
suggestion time taken 10.926610 iter 12 next_points [{'alpha': 0.004754572876532588, 'batch_size': 12, 'beta_1': 0.9770534142789751, 'beta_2': 0.9999971791255499, 'epsilon': 4.0809796213336915e-09, 'hidden_layer_sizes': 169, 'learning_rate_init': 0.025208359214102062, 'tol': 0.0017054966514558315, 'validation_fraction': 0.38915903737125923}]
function_evaluation time 3.476678 value -0.935281 suggestion {'alpha': 0.004754572876532588, 'batch_size': 12, 'beta_1': 0.9770534142789751, 'beta_2': 0.9999971791255499, 'epsilon': 4.0809796213336915e-09, 'hidden_layer_sizes': 169, 'learning_rate_init': 0.025208359214102062, 'tol': 0.0017054966514558315, 'validation_fraction': 0.38915903737125923}
observation time 0.000005, current best -0.970086 at iter 12
suggestion time taken 11.080786 iter 13 next_points [{'alpha': 0.006272728174722008, 'batch_size': 22, 'beta_1': 0.8992267311344043, 'beta_2': 0.9999982465478672, 'epsilon': 4.253121892683956e-08, 'hidden_layer_sizes': 186, 'learning_rate_init': 1.2984983771118575e-05, 'tol': 3.1061924361269154e-05, 'validation_fraction': 0.8656073684793824}]
function_evaluation time 2.150979 value -0.315512 suggestion {'alpha': 0.006272728174722008, 'batch_size': 22, 'beta_1': 0.8992267311344043, 'beta_2': 0.9999982465478672, 'epsilon': 4.253121892683956e-08, 'hidden_layer_sizes': 186, 'learning_rate_init': 1.2984983771118575e-05, 'tol': 3.1061924361269154e-05, 'validation_fraction': 0.8656073684793824}
observation time 0.000005, current best -0.970086 at iter 13
suggestion time taken 11.046560 iter 14 next_points [{'alpha': 0.46606766965149843, 'batch_size': 37, 'beta_1': 0.750980768175737, 'beta_2': 0.9999405222463953, 'epsilon': 1.7673727839614916e-08, 'hidden_layer_sizes': 121, 'learning_rate_init': 4.5570112513921796e-05, 'tol': 0.006495479429642883, 'validation_fraction': 0.4444346928319654}]
function_evaluation time 3.941643 value -0.842003 suggestion {'alpha': 0.46606766965149843, 'batch_size': 37, 'beta_1': 0.750980768175737, 'beta_2': 0.9999405222463953, 'epsilon': 1.7673727839614916e-08, 'hidden_layer_sizes': 121, 'learning_rate_init': 4.5570112513921796e-05, 'tol': 0.006495479429642883, 'validation_fraction': 0.4444346928319654}
observation time 0.000006, current best -0.970086 at iter 14
saving meta data: {'args': {'--uuid': 'ee792220d61f56bfadf4d626616fd73c', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])}
saving results
saving timing
saving suggest log
done
