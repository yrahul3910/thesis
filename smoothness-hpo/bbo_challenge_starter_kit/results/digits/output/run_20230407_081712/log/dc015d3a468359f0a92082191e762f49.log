running: {'--uuid': 'dc015d3a468359f0a92082191e762f49', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u dc015d3a468359f0a92082191e762f49 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_081712
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study smoothness MLP-adam digits nll 15 1
with data root: None
suggestion time taken 11.276517 iter 0 next_points [{'alpha': 9.786765164963871, 'batch_size': 17, 'beta_1': 0.9851975641098798, 'beta_2': 0.9981464974679158, 'epsilon': 1.0127886768516019e-08, 'hidden_layer_sizes': 128, 'learning_rate_init': 0.00098798847631158, 'tol': 0.002319850624518662, 'validation_fraction': 0.5344576855803806}]
function_evaluation time 1.623241 value 0.530153 suggestion {'alpha': 9.786765164963871, 'batch_size': 17, 'beta_1': 0.9851975641098798, 'beta_2': 0.9981464974679158, 'epsilon': 1.0127886768516019e-08, 'hidden_layer_sizes': 128, 'learning_rate_init': 0.00098798847631158, 'tol': 0.002319850624518662, 'validation_fraction': 0.5344576855803806}
observation time 0.000005, current best 0.530153 at iter 0
suggestion time taken 11.266204 iter 1 next_points [{'alpha': 1.530702640056543e-05, 'batch_size': 13, 'beta_1': 0.9893364271798628, 'beta_2': 0.9999703725266531, 'epsilon': 6.838262732253841e-08, 'hidden_layer_sizes': 109, 'learning_rate_init': 0.016745807344004, 'tol': 1.1602440986187308e-05, 'validation_fraction': 0.314324702477655}]
function_evaluation time 2.641450 value 0.383638 suggestion {'alpha': 1.530702640056543e-05, 'batch_size': 13, 'beta_1': 0.9893364271798628, 'beta_2': 0.9999703725266531, 'epsilon': 6.838262732253841e-08, 'hidden_layer_sizes': 109, 'learning_rate_init': 0.016745807344004, 'tol': 1.1602440986187308e-05, 'validation_fraction': 0.314324702477655}
observation time 0.000005, current best 0.383638 at iter 1
suggestion time taken 11.075758 iter 2 next_points [{'alpha': 0.00022351019967713166, 'batch_size': 30, 'beta_1': 0.8072011629328321, 'beta_2': 0.9999908545813693, 'epsilon': 1.5477438599221347e-07, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.0016903962593086599, 'tol': 0.0006548029648428772, 'validation_fraction': 0.7676259847445432}]
function_evaluation time 1.543204 value 0.287342 suggestion {'alpha': 0.00022351019967713166, 'batch_size': 30, 'beta_1': 0.8072011629328321, 'beta_2': 0.9999908545813693, 'epsilon': 1.5477438599221347e-07, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.0016903962593086599, 'tol': 0.0006548029648428772, 'validation_fraction': 0.7676259847445432}
observation time 0.000004, current best 0.287342 at iter 2
suggestion time taken 11.322821 iter 3 next_points [{'alpha': 0.11664091350010539, 'batch_size': 13, 'beta_1': 0.97668942146038, 'beta_2': 0.9952016309349182, 'epsilon': 3.6525612322086476e-08, 'hidden_layer_sizes': 175, 'learning_rate_init': 1.0023382941184424e-05, 'tol': 1.0725840336633605e-05, 'validation_fraction': 0.8770001471324128}]
function_evaluation time 4.867412 value 2.270441 suggestion {'alpha': 0.11664091350010539, 'batch_size': 13, 'beta_1': 0.97668942146038, 'beta_2': 0.9952016309349182, 'epsilon': 3.6525612322086476e-08, 'hidden_layer_sizes': 175, 'learning_rate_init': 1.0023382941184424e-05, 'tol': 1.0725840336633605e-05, 'validation_fraction': 0.8770001471324128}
observation time 0.000005, current best 0.287342 at iter 3
suggestion time taken 11.366838 iter 4 next_points [{'alpha': 5.100141778175532, 'batch_size': 11, 'beta_1': 0.984949344234392, 'beta_2': 0.9998430978311224, 'epsilon': 3.0121205254741746e-09, 'hidden_layer_sizes': 86, 'learning_rate_init': 1.718303114447585e-05, 'tol': 0.0015537665034553875, 'validation_fraction': 0.4509979765034903}]
function_evaluation time 17.211311 value 0.395667 suggestion {'alpha': 5.100141778175532, 'batch_size': 11, 'beta_1': 0.984949344234392, 'beta_2': 0.9998430978311224, 'epsilon': 3.0121205254741746e-09, 'hidden_layer_sizes': 86, 'learning_rate_init': 1.718303114447585e-05, 'tol': 0.0015537665034553875, 'validation_fraction': 0.4509979765034903}
observation time 0.000005, current best 0.287342 at iter 4
suggestion time taken 11.414075 iter 5 next_points [{'alpha': 0.0011864780420018275, 'batch_size': 32, 'beta_1': 0.5565427119484213, 'beta_2': 0.9999794667738431, 'epsilon': 8.479128358518211e-08, 'hidden_layer_sizes': 159, 'learning_rate_init': 0.0004919411899247234, 'tol': 9.21867522767648e-05, 'validation_fraction': 0.7629889709773486}]
function_evaluation time 2.121145 value 0.257339 suggestion {'alpha': 0.0011864780420018275, 'batch_size': 32, 'beta_1': 0.5565427119484213, 'beta_2': 0.9999794667738431, 'epsilon': 8.479128358518211e-08, 'hidden_layer_sizes': 159, 'learning_rate_init': 0.0004919411899247234, 'tol': 9.21867522767648e-05, 'validation_fraction': 0.7629889709773486}
observation time 0.000005, current best 0.257339 at iter 5
suggestion time taken 11.295258 iter 6 next_points [{'alpha': 0.0005801809307132154, 'batch_size': 14, 'beta_1': 0.9149365281132066, 'beta_2': 0.984385454784874, 'epsilon': 3.3354368115576604e-07, 'hidden_layer_sizes': 69, 'learning_rate_init': 8.612359661497422e-05, 'tol': 0.05843111118735159, 'validation_fraction': 0.8510567514133248}]
function_evaluation time 0.352670 value 4.686767 suggestion {'alpha': 0.0005801809307132154, 'batch_size': 14, 'beta_1': 0.9149365281132066, 'beta_2': 0.984385454784874, 'epsilon': 3.3354368115576604e-07, 'hidden_layer_sizes': 69, 'learning_rate_init': 8.612359661497422e-05, 'tol': 0.05843111118735159, 'validation_fraction': 0.8510567514133248}
observation time 0.000005, current best 0.257339 at iter 6
suggestion time taken 11.493178 iter 7 next_points [{'alpha': 0.08048068517570711, 'batch_size': 13, 'beta_1': 0.968697093938561, 'beta_2': 0.9994647705109396, 'epsilon': 1.8092352467302967e-09, 'hidden_layer_sizes': 124, 'learning_rate_init': 0.03911330749032755, 'tol': 0.0007067080805554972, 'validation_fraction': 0.82467082530648}]
function_evaluation time 1.034949 value 1.036583 suggestion {'alpha': 0.08048068517570711, 'batch_size': 13, 'beta_1': 0.968697093938561, 'beta_2': 0.9994647705109396, 'epsilon': 1.8092352467302967e-09, 'hidden_layer_sizes': 124, 'learning_rate_init': 0.03911330749032755, 'tol': 0.0007067080805554972, 'validation_fraction': 0.82467082530648}
observation time 0.000005, current best 0.257339 at iter 7
suggestion time taken 11.286586 iter 8 next_points [{'alpha': 0.000673991656211306, 'batch_size': 13, 'beta_1': 0.9095029183990061, 'beta_2': 0.9963418772045559, 'epsilon': 1.9863133043546073e-09, 'hidden_layer_sizes': 74, 'learning_rate_init': 0.0002601302491316354, 'tol': 0.0008006309533675481, 'validation_fraction': 0.5747634566531501}]
function_evaluation time 6.436238 value 0.173876 suggestion {'alpha': 0.000673991656211306, 'batch_size': 13, 'beta_1': 0.9095029183990061, 'beta_2': 0.9963418772045559, 'epsilon': 1.9863133043546073e-09, 'hidden_layer_sizes': 74, 'learning_rate_init': 0.0002601302491316354, 'tol': 0.0008006309533675481, 'validation_fraction': 0.5747634566531501}
observation time 0.000005, current best 0.173876 at iter 8
suggestion time taken 11.370185 iter 9 next_points [{'alpha': 0.07814654145184052, 'batch_size': 17, 'beta_1': 0.8602431289743924, 'beta_2': 0.9998898942307098, 'epsilon': 3.957115799365928e-09, 'hidden_layer_sizes': 97, 'learning_rate_init': 0.0033348339441975554, 'tol': 0.0026533637730290142, 'validation_fraction': 0.30335075948919016}]
function_evaluation time 2.362188 value 0.112350 suggestion {'alpha': 0.07814654145184052, 'batch_size': 17, 'beta_1': 0.8602431289743924, 'beta_2': 0.9998898942307098, 'epsilon': 3.957115799365928e-09, 'hidden_layer_sizes': 97, 'learning_rate_init': 0.0033348339441975554, 'tol': 0.0026533637730290142, 'validation_fraction': 0.30335075948919016}
observation time 0.000005, current best 0.112350 at iter 9
suggestion time taken 11.707933 iter 10 next_points [{'alpha': 1.5581819995964212, 'batch_size': 32, 'beta_1': 0.87647399466633, 'beta_2': 0.9996661861910546, 'epsilon': 6.236699667080921e-07, 'hidden_layer_sizes': 87, 'learning_rate_init': 0.00088213316687528, 'tol': 0.010748892387028412, 'validation_fraction': 0.2925987898152317}]
function_evaluation time 1.226688 value 0.155212 suggestion {'alpha': 1.5581819995964212, 'batch_size': 32, 'beta_1': 0.87647399466633, 'beta_2': 0.9996661861910546, 'epsilon': 6.236699667080921e-07, 'hidden_layer_sizes': 87, 'learning_rate_init': 0.00088213316687528, 'tol': 0.010748892387028412, 'validation_fraction': 0.2925987898152317}
observation time 0.000005, current best 0.112350 at iter 10
suggestion time taken 11.474403 iter 11 next_points [{'alpha': 8.334984361877376e-05, 'batch_size': 18, 'beta_1': 0.9682193640348671, 'beta_2': 0.9998263296913008, 'epsilon': 2.5977528682584475e-07, 'hidden_layer_sizes': 185, 'learning_rate_init': 0.07906318549201873, 'tol': 0.046138204246193415, 'validation_fraction': 0.8165248035037367}]
function_evaluation time 0.621669 value 2.605827 suggestion {'alpha': 8.334984361877376e-05, 'batch_size': 18, 'beta_1': 0.9682193640348671, 'beta_2': 0.9998263296913008, 'epsilon': 2.5977528682584475e-07, 'hidden_layer_sizes': 185, 'learning_rate_init': 0.07906318549201873, 'tol': 0.046138204246193415, 'validation_fraction': 0.8165248035037367}
observation time 0.000005, current best 0.112350 at iter 11
suggestion time taken 11.332752 iter 12 next_points [{'alpha': 0.000908805111632664, 'batch_size': 14, 'beta_1': 0.9234572239241251, 'beta_2': 0.9994625147124954, 'epsilon': 1.117580104305204e-09, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.0011970713444873643, 'tol': 4.198887294440877e-05, 'validation_fraction': 0.17176444350018158}]
function_evaluation time 3.339908 value 0.080063 suggestion {'alpha': 0.000908805111632664, 'batch_size': 14, 'beta_1': 0.9234572239241251, 'beta_2': 0.9994625147124954, 'epsilon': 1.117580104305204e-09, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.0011970713444873643, 'tol': 4.198887294440877e-05, 'validation_fraction': 0.17176444350018158}
observation time 0.000004, current best 0.080063 at iter 12
suggestion time taken 11.702285 iter 13 next_points [{'alpha': 0.022238902457522348, 'batch_size': 32, 'beta_1': 0.891931260995646, 'beta_2': 0.998921771060268, 'epsilon': 3.39955750999519e-09, 'hidden_layer_sizes': 196, 'learning_rate_init': 0.0006934799732069598, 'tol': 0.03798827879495462, 'validation_fraction': 0.3064193819450154}]
function_evaluation time 1.224662 value 0.171172 suggestion {'alpha': 0.022238902457522348, 'batch_size': 32, 'beta_1': 0.891931260995646, 'beta_2': 0.998921771060268, 'epsilon': 3.39955750999519e-09, 'hidden_layer_sizes': 196, 'learning_rate_init': 0.0006934799732069598, 'tol': 0.03798827879495462, 'validation_fraction': 0.3064193819450154}
observation time 0.000005, current best 0.080063 at iter 13
suggestion time taken 11.551391 iter 14 next_points [{'alpha': 5.084339153073904e-05, 'batch_size': 48, 'beta_1': 0.981367161653025, 'beta_2': 0.999987764793037, 'epsilon': 3.2427070853986506e-09, 'hidden_layer_sizes': 151, 'learning_rate_init': 0.0001894592236685937, 'tol': 0.0038337577047613198, 'validation_fraction': 0.7337164964874687}]
function_evaluation time 1.571067 value 0.370558 suggestion {'alpha': 5.084339153073904e-05, 'batch_size': 48, 'beta_1': 0.981367161653025, 'beta_2': 0.999987764793037, 'epsilon': 3.2427070853986506e-09, 'hidden_layer_sizes': 151, 'learning_rate_init': 0.0001894592236685937, 'tol': 0.0038337577047613198, 'validation_fraction': 0.7337164964874687}
observation time 0.000003, current best 0.080063 at iter 14
saving meta data: {'args': {'--uuid': 'dc015d3a468359f0a92082191e762f49', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
