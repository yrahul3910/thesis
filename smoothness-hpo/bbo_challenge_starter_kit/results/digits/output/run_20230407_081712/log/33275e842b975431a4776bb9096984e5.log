running: {'--uuid': '33275e842b975431a4776bb9096984e5', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u 33275e842b975431a4776bb9096984e5 -m acc -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_081712
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_acc betwen [-0.2181506  -0.12954897 -0.42701514 -0.94997127 -0.93320509] and [-0.21081107 -0.11575494 -0.27999177 -0.94225223 -0.93253861]
  warnings.warn(

Signature errors:
                           0         1         2         3         4       max
MLP-adam_digits_acc  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
max                  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
starting sklearn study smoothness MLP-adam digits acc 15 1
with data root: None
suggestion time taken 11.356646 iter 0 next_points [{'alpha': 0.000590531328776114, 'batch_size': 13, 'beta_1': 0.9721429183893381, 'beta_2': 0.9999194997448391, 'epsilon': 4.71632415901856e-07, 'hidden_layer_sizes': 117, 'learning_rate_init': 2.7478685436630716e-05, 'tol': 0.00014816187655972287, 'validation_fraction': 0.6863639791380981}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 10.022578 value -0.867782 suggestion {'alpha': 0.000590531328776114, 'batch_size': 13, 'beta_1': 0.9721429183893381, 'beta_2': 0.9999194997448391, 'epsilon': 4.71632415901856e-07, 'hidden_layer_sizes': 117, 'learning_rate_init': 2.7478685436630716e-05, 'tol': 0.00014816187655972287, 'validation_fraction': 0.6863639791380981}
observation time 0.000005, current best -0.867782 at iter 0
suggestion time taken 11.226471 iter 1 next_points [{'alpha': 2.889427963824237, 'batch_size': 20, 'beta_1': 0.9576369007281241, 'beta_2': 0.9999324690518436, 'epsilon': 2.676387536513343e-07, 'hidden_layer_sizes': 138, 'learning_rate_init': 6.075471087516818e-05, 'tol': 0.0006247162486490201, 'validation_fraction': 0.835337392889975}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 5.782558 value -0.846937 suggestion {'alpha': 2.889427963824237, 'batch_size': 20, 'beta_1': 0.9576369007281241, 'beta_2': 0.9999324690518436, 'epsilon': 2.676387536513343e-07, 'hidden_layer_sizes': 138, 'learning_rate_init': 6.075471087516818e-05, 'tol': 0.0006247162486490201, 'validation_fraction': 0.835337392889975}
observation time 0.000004, current best -0.867782 at iter 1
suggestion time taken 10.967204 iter 2 next_points [{'alpha': 3.133291008352431, 'batch_size': 41, 'beta_1': 0.7340631064041894, 'beta_2': 0.991442438033718, 'epsilon': 1.1520185154744447e-08, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.0014720659223079952, 'tol': 0.050195484051944204, 'validation_fraction': 0.6296951511934447}]
function_evaluation time 0.431769 value -0.908849 suggestion {'alpha': 3.133291008352431, 'batch_size': 41, 'beta_1': 0.7340631064041894, 'beta_2': 0.991442438033718, 'epsilon': 1.1520185154744447e-08, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.0014720659223079952, 'tol': 0.050195484051944204, 'validation_fraction': 0.6296951511934447}
observation time 0.000004, current best -0.908849 at iter 2
suggestion time taken 11.271036 iter 3 next_points [{'alpha': 0.007229852435958556, 'batch_size': 15, 'beta_1': 0.9624939923277979, 'beta_2': 0.9979696988247467, 'epsilon': 2.0054008551401529e-07, 'hidden_layer_sizes': 188, 'learning_rate_init': 3.623652773295559e-05, 'tol': 0.04744649541246319, 'validation_fraction': 0.814465561767966}]
function_evaluation time 0.577579 value -0.204520 suggestion {'alpha': 0.007229852435958556, 'batch_size': 15, 'beta_1': 0.9624939923277979, 'beta_2': 0.9979696988247467, 'epsilon': 2.0054008551401529e-07, 'hidden_layer_sizes': 188, 'learning_rate_init': 3.623652773295559e-05, 'tol': 0.04744649541246319, 'validation_fraction': 0.814465561767966}
observation time 0.000003, current best -0.908849 at iter 3
suggestion time taken 11.043048 iter 4 next_points [{'alpha': 1.449314444591366, 'batch_size': 15, 'beta_1': 0.7347368759870804, 'beta_2': 0.9999926237821298, 'epsilon': 6.918273125532456e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.08458047785031748, 'tol': 3.083087494932416e-05, 'validation_fraction': 0.6717655101530104}]
function_evaluation time 0.616867 value -0.341667 suggestion {'alpha': 1.449314444591366, 'batch_size': 15, 'beta_1': 0.7347368759870804, 'beta_2': 0.9999926237821298, 'epsilon': 6.918273125532456e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.08458047785031748, 'tol': 3.083087494932416e-05, 'validation_fraction': 0.6717655101530104}
observation time 0.000003, current best -0.908849 at iter 4
suggestion time taken 11.238877 iter 5 next_points [{'alpha': 1.343494493070271e-05, 'batch_size': 13, 'beta_1': 0.9701448221656951, 'beta_2': 0.9999843354391461, 'epsilon': 1.9327783228801658e-08, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.00015824457133762956, 'tol': 0.00140491357006468, 'validation_fraction': 0.16452728425302557}]
function_evaluation time 4.774405 value -0.943644 suggestion {'alpha': 1.343494493070271e-05, 'batch_size': 13, 'beta_1': 0.9701448221656951, 'beta_2': 0.9999843354391461, 'epsilon': 1.9327783228801658e-08, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.00015824457133762956, 'tol': 0.00140491357006468, 'validation_fraction': 0.16452728425302557}
observation time 0.000004, current best -0.943644 at iter 5
suggestion time taken 11.106931 iter 6 next_points [{'alpha': 0.004111703340969821, 'batch_size': 16, 'beta_1': 0.9800388231370338, 'beta_2': 0.9992926823722834, 'epsilon': 4.827570435421996e-07, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.055308118021181046, 'tol': 1.123385913049183e-05, 'validation_fraction': 0.10017083003157198}]
function_evaluation time 1.685633 value -0.473299 suggestion {'alpha': 0.004111703340969821, 'batch_size': 16, 'beta_1': 0.9800388231370338, 'beta_2': 0.9992926823722834, 'epsilon': 4.827570435421996e-07, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.055308118021181046, 'tol': 1.123385913049183e-05, 'validation_fraction': 0.10017083003157198}
observation time 0.000005, current best -0.943644 at iter 6
suggestion time taken 11.027320 iter 7 next_points [{'alpha': 7.863682102288978, 'batch_size': 12, 'beta_1': 0.9821367988333, 'beta_2': 0.9996969417925785, 'epsilon': 7.453373255193606e-07, 'hidden_layer_sizes': 142, 'learning_rate_init': 0.0009111960342377249, 'tol': 0.0014179873652973092, 'validation_fraction': 0.6524019487612315}]
function_evaluation time 1.520506 value -0.931821 suggestion {'alpha': 7.863682102288978, 'batch_size': 12, 'beta_1': 0.9821367988333, 'beta_2': 0.9996969417925785, 'epsilon': 7.453373255193606e-07, 'hidden_layer_sizes': 142, 'learning_rate_init': 0.0009111960342377249, 'tol': 0.0014179873652973092, 'validation_fraction': 0.6524019487612315}
observation time 0.000004, current best -0.943644 at iter 7
suggestion time taken 11.273952 iter 8 next_points [{'alpha': 1.2661488403183801e-05, 'batch_size': 14, 'beta_1': 0.5167180568488983, 'beta_2': 0.9999419066827557, 'epsilon': 2.581992789683509e-08, 'hidden_layer_sizes': 81, 'learning_rate_init': 0.010119104405660499, 'tol': 1.6190330078477134e-05, 'validation_fraction': 0.6780622733572469}]
function_evaluation time 1.446258 value -0.947118 suggestion {'alpha': 1.2661488403183801e-05, 'batch_size': 14, 'beta_1': 0.5167180568488983, 'beta_2': 0.9999419066827557, 'epsilon': 2.581992789683509e-08, 'hidden_layer_sizes': 81, 'learning_rate_init': 0.010119104405660499, 'tol': 1.6190330078477134e-05, 'validation_fraction': 0.6780622733572469}
observation time 0.000004, current best -0.947118 at iter 8
suggestion time taken 11.043979 iter 9 next_points [{'alpha': 4.6488593031275995e-05, 'batch_size': 18, 'beta_1': 0.9892531445558638, 'beta_2': 0.9998181111281009, 'epsilon': 2.902219191361143e-08, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.0008310671477318564, 'tol': 0.003035832269972702, 'validation_fraction': 0.40556974245762933}]
function_evaluation time 1.964778 value -0.945047 suggestion {'alpha': 4.6488593031275995e-05, 'batch_size': 18, 'beta_1': 0.9892531445558638, 'beta_2': 0.9998181111281009, 'epsilon': 2.902219191361143e-08, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.0008310671477318564, 'tol': 0.003035832269972702, 'validation_fraction': 0.40556974245762933}
observation time 0.000005, current best -0.947118 at iter 9
suggestion time taken 10.951201 iter 10 next_points [{'alpha': 0.0005527274672569488, 'batch_size': 23, 'beta_1': 0.5124459664084059, 'beta_2': 0.9996303134902295, 'epsilon': 8.257241548617951e-08, 'hidden_layer_sizes': 94, 'learning_rate_init': 0.0010700018327960573, 'tol': 0.0023755528991694914, 'validation_fraction': 0.3569830869730864}]
function_evaluation time 2.696446 value -0.963824 suggestion {'alpha': 0.0005527274672569488, 'batch_size': 23, 'beta_1': 0.5124459664084059, 'beta_2': 0.9996303134902295, 'epsilon': 8.257241548617951e-08, 'hidden_layer_sizes': 94, 'learning_rate_init': 0.0010700018327960573, 'tol': 0.0023755528991694914, 'validation_fraction': 0.3569830869730864}
observation time 0.000005, current best -0.963824 at iter 10
suggestion time taken 11.215302 iter 11 next_points [{'alpha': 0.24958776325994236, 'batch_size': 26, 'beta_1': 0.812069366681536, 'beta_2': 0.9913013767853488, 'epsilon': 6.691009830782836e-08, 'hidden_layer_sizes': 78, 'learning_rate_init': 7.740289534021693e-05, 'tol': 2.6780318379316988e-05, 'validation_fraction': 0.8435018961581512}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 3.370575 value -0.714470 suggestion {'alpha': 0.24958776325994236, 'batch_size': 26, 'beta_1': 0.812069366681536, 'beta_2': 0.9913013767853488, 'epsilon': 6.691009830782836e-08, 'hidden_layer_sizes': 78, 'learning_rate_init': 7.740289534021693e-05, 'tol': 2.6780318379316988e-05, 'validation_fraction': 0.8435018961581512}
observation time 0.000004, current best -0.963824 at iter 11
suggestion time taken 11.037857 iter 12 next_points [{'alpha': 0.25648853785124376, 'batch_size': 20, 'beta_1': 0.8179392218753658, 'beta_2': 0.9981683721788658, 'epsilon': 1.9130234700449743e-09, 'hidden_layer_sizes': 190, 'learning_rate_init': 0.07379789968102782, 'tol': 5.820446627552403e-05, 'validation_fraction': 0.16810613793254864}]
function_evaluation time 1.881474 value -0.371465 suggestion {'alpha': 0.25648853785124376, 'batch_size': 20, 'beta_1': 0.8179392218753658, 'beta_2': 0.9981683721788658, 'epsilon': 1.9130234700449743e-09, 'hidden_layer_sizes': 190, 'learning_rate_init': 0.07379789968102782, 'tol': 5.820446627552403e-05, 'validation_fraction': 0.16810613793254864}
observation time 0.000005, current best -0.963824 at iter 12
suggestion time taken 10.900879 iter 13 next_points [{'alpha': 2.1501700345031723e-05, 'batch_size': 24, 'beta_1': 0.9610241914474068, 'beta_2': 0.9994172381558298, 'epsilon': 4.979191282346345e-08, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.0002557124380629748, 'tol': 0.0013314640605119035, 'validation_fraction': 0.10660123707412839}]
function_evaluation time 3.054289 value -0.940866 suggestion {'alpha': 2.1501700345031723e-05, 'batch_size': 24, 'beta_1': 0.9610241914474068, 'beta_2': 0.9994172381558298, 'epsilon': 4.979191282346345e-08, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.0002557124380629748, 'tol': 0.0013314640605119035, 'validation_fraction': 0.10660123707412839}
observation time 0.000004, current best -0.963824 at iter 13
suggestion time taken 11.291627 iter 14 next_points [{'alpha': 0.006349836207714832, 'batch_size': 14, 'beta_1': 0.8938047652020673, 'beta_2': 0.9999951157574204, 'epsilon': 2.2746286442330815e-08, 'hidden_layer_sizes': 106, 'learning_rate_init': 0.00041257136879752906, 'tol': 0.0021316216981140225, 'validation_fraction': 0.8625309232475121}]
function_evaluation time 2.071675 value -0.867054 suggestion {'alpha': 0.006349836207714832, 'batch_size': 14, 'beta_1': 0.8938047652020673, 'beta_2': 0.9999951157574204, 'epsilon': 2.2746286442330815e-08, 'hidden_layer_sizes': 106, 'learning_rate_init': 0.00041257136879752906, 'tol': 0.0021316216981140225, 'validation_fraction': 0.8625309232475121}
observation time 0.000004, current best -0.963824 at iter 14
saving meta data: {'args': {'--uuid': '33275e842b975431a4776bb9096984e5', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])}
saving results
saving timing
saving suggest log
done
