running: {'--uuid': 'b007616eeb9c56999e7e13b46ae31fbe', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u b007616eeb9c56999e7e13b46ae31fbe -m acc -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_081712
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_acc betwen [-0.2181506  -0.12954897 -0.42701514 -0.94997127 -0.93320509] and [-0.21081107 -0.11575494 -0.27999177 -0.94225223 -0.93253861]
  warnings.warn(

Signature errors:
                           0         1         2         3         4       max
MLP-adam_digits_acc  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
max                  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
starting sklearn study smoothness MLP-adam digits acc 15 1
with data root: None
suggestion time taken 11.368357 iter 0 next_points [{'alpha': 0.02466464037336158, 'batch_size': 10, 'beta_1': 0.9595487829001358, 'beta_2': 0.9991263606309394, 'epsilon': 1.9350328351038468e-07, 'hidden_layer_sizes': 124, 'learning_rate_init': 0.003394660464651342, 'tol': 0.00040743091548790496, 'validation_fraction': 0.5811704839159353}]
function_evaluation time 3.000078 value -0.957561 suggestion {'alpha': 0.02466464037336158, 'batch_size': 10, 'beta_1': 0.9595487829001358, 'beta_2': 0.9991263606309394, 'epsilon': 1.9350328351038468e-07, 'hidden_layer_sizes': 124, 'learning_rate_init': 0.003394660464651342, 'tol': 0.00040743091548790496, 'validation_fraction': 0.5811704839159353}
observation time 0.000004, current best -0.957561 at iter 0
suggestion time taken 11.245193 iter 1 next_points [{'alpha': 0.0008708332786526616, 'batch_size': 10, 'beta_1': 0.7081358105937882, 'beta_2': 0.9052127175546398, 'epsilon': 3.3589289347862243e-09, 'hidden_layer_sizes': 114, 'learning_rate_init': 0.024593125088001863, 'tol': 0.0002843208801488416, 'validation_fraction': 0.2821173598889878}]
function_evaluation time 3.354314 value -0.951295 suggestion {'alpha': 0.0008708332786526616, 'batch_size': 10, 'beta_1': 0.7081358105937882, 'beta_2': 0.9052127175546398, 'epsilon': 3.3589289347862243e-09, 'hidden_layer_sizes': 114, 'learning_rate_init': 0.024593125088001863, 'tol': 0.0002843208801488416, 'validation_fraction': 0.2821173598889878}
observation time 0.000005, current best -0.957561 at iter 1
suggestion time taken 11.005382 iter 2 next_points [{'alpha': 0.08791015427168736, 'batch_size': 13, 'beta_1': 0.9875264141642716, 'beta_2': 0.9989986040855248, 'epsilon': 1.5664019074992255e-09, 'hidden_layer_sizes': 113, 'learning_rate_init': 0.004012937909634389, 'tol': 7.457028946753668e-05, 'validation_fraction': 0.8362389421975505}]
function_evaluation time 1.742446 value -0.916505 suggestion {'alpha': 0.08791015427168736, 'batch_size': 13, 'beta_1': 0.9875264141642716, 'beta_2': 0.9989986040855248, 'epsilon': 1.5664019074992255e-09, 'hidden_layer_sizes': 113, 'learning_rate_init': 0.004012937909634389, 'tol': 7.457028946753668e-05, 'validation_fraction': 0.8362389421975505}
observation time 0.000004, current best -0.957561 at iter 2
suggestion time taken 11.252596 iter 3 next_points [{'alpha': 0.2520207017212978, 'batch_size': 14, 'beta_1': 0.9633144724155639, 'beta_2': 0.999751471204363, 'epsilon': 8.91019608062833e-09, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.0004942316706499966, 'tol': 0.007933337623490485, 'validation_fraction': 0.2567702177098171}]
function_evaluation time 2.386429 value -0.945712 suggestion {'alpha': 0.2520207017212978, 'batch_size': 14, 'beta_1': 0.9633144724155639, 'beta_2': 0.999751471204363, 'epsilon': 8.91019608062833e-09, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.0004942316706499966, 'tol': 0.007933337623490485, 'validation_fraction': 0.2567702177098171}
observation time 0.000004, current best -0.957561 at iter 3
suggestion time taken 10.966772 iter 4 next_points [{'alpha': 0.0031189557671504717, 'batch_size': 36, 'beta_1': 0.9847229595872689, 'beta_2': 0.9999560833672774, 'epsilon': 2.790234162449876e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.000383350514714147, 'tol': 0.00013810584847477703, 'validation_fraction': 0.6836138540726792}]
function_evaluation time 2.476178 value -0.897730 suggestion {'alpha': 0.0031189557671504717, 'batch_size': 36, 'beta_1': 0.9847229595872689, 'beta_2': 0.9999560833672774, 'epsilon': 2.790234162449876e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.000383350514714147, 'tol': 0.00013810584847477703, 'validation_fraction': 0.6836138540726792}
observation time 0.000005, current best -0.957561 at iter 4
suggestion time taken 11.250263 iter 5 next_points [{'alpha': 0.3656050237494527, 'batch_size': 51, 'beta_1': 0.9766242001717742, 'beta_2': 0.9989619551054378, 'epsilon': 1.297123738235028e-08, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.00945750548654307, 'tol': 0.03949766307350881, 'validation_fraction': 0.8101521969694293}]
function_evaluation time 0.284488 value -0.907433 suggestion {'alpha': 0.3656050237494527, 'batch_size': 51, 'beta_1': 0.9766242001717742, 'beta_2': 0.9989619551054378, 'epsilon': 1.297123738235028e-08, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.00945750548654307, 'tol': 0.03949766307350881, 'validation_fraction': 0.8101521969694293}
observation time 0.000004, current best -0.957561 at iter 5
suggestion time taken 11.146414 iter 6 next_points [{'alpha': 0.08971296523033533, 'batch_size': 11, 'beta_1': 0.8447795042863406, 'beta_2': 0.9997003578141193, 'epsilon': 1.1168678659440486e-07, 'hidden_layer_sizes': 86, 'learning_rate_init': 1.934824909603903e-05, 'tol': 0.00028118642419927873, 'validation_fraction': 0.8387191378800656}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 7.018132 value -0.654832 suggestion {'alpha': 0.08971296523033533, 'batch_size': 11, 'beta_1': 0.8447795042863406, 'beta_2': 0.9997003578141193, 'epsilon': 1.1168678659440486e-07, 'hidden_layer_sizes': 86, 'learning_rate_init': 1.934824909603903e-05, 'tol': 0.00028118642419927873, 'validation_fraction': 0.8387191378800656}
observation time 0.000004, current best -0.957561 at iter 6
suggestion time taken 11.021204 iter 7 next_points [{'alpha': 1.6419936981941826e-05, 'batch_size': 11, 'beta_1': 0.9543813244878132, 'beta_2': 0.9987217529664811, 'epsilon': 8.088255582728014e-08, 'hidden_layer_sizes': 108, 'learning_rate_init': 3.8784629514226086e-05, 'tol': 0.008200456918451036, 'validation_fraction': 0.790238651309446}]
function_evaluation time 2.584145 value -0.624025 suggestion {'alpha': 1.6419936981941826e-05, 'batch_size': 11, 'beta_1': 0.9543813244878132, 'beta_2': 0.9987217529664811, 'epsilon': 8.088255582728014e-08, 'hidden_layer_sizes': 108, 'learning_rate_init': 3.8784629514226086e-05, 'tol': 0.008200456918451036, 'validation_fraction': 0.790238651309446}
observation time 0.000004, current best -0.957561 at iter 7
suggestion time taken 11.155581 iter 8 next_points [{'alpha': 0.24562852983249156, 'batch_size': 57, 'beta_1': 0.9850564727277742, 'beta_2': 0.9997900053267753, 'epsilon': 4.072607542054371e-07, 'hidden_layer_sizes': 148, 'learning_rate_init': 0.0008525196479380315, 'tol': 0.01797878857547927, 'validation_fraction': 0.793431426314525}]
function_evaluation time 0.611342 value -0.893527 suggestion {'alpha': 0.24562852983249156, 'batch_size': 57, 'beta_1': 0.9850564727277742, 'beta_2': 0.9997900053267753, 'epsilon': 4.072607542054371e-07, 'hidden_layer_sizes': 148, 'learning_rate_init': 0.0008525196479380315, 'tol': 0.01797878857547927, 'validation_fraction': 0.793431426314525}
observation time 0.000005, current best -0.957561 at iter 8
suggestion time taken 11.129219 iter 9 next_points [{'alpha': 0.06783320545956142, 'batch_size': 15, 'beta_1': 0.9773825755242296, 'beta_2': 0.9802424771002185, 'epsilon': 6.016231299621319e-09, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.006391375288120306, 'tol': 0.000351731936721816, 'validation_fraction': 0.38297128818585235}]
function_evaluation time 3.149307 value -0.958253 suggestion {'alpha': 0.06783320545956142, 'batch_size': 15, 'beta_1': 0.9773825755242296, 'beta_2': 0.9802424771002185, 'epsilon': 6.016231299621319e-09, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.006391375288120306, 'tol': 0.000351731936721816, 'validation_fraction': 0.38297128818585235}
observation time 0.000005, current best -0.958253 at iter 9
suggestion time taken 11.062320 iter 10 next_points [{'alpha': 0.5705037206355902, 'batch_size': 30, 'beta_1': 0.8803127641481356, 'beta_2': 0.9795081508341319, 'epsilon': 8.41368960044457e-09, 'hidden_layer_sizes': 175, 'learning_rate_init': 0.0033904999745516225, 'tol': 0.031098398974293253, 'validation_fraction': 0.2893535368435007}]
function_evaluation time 1.115286 value -0.958958 suggestion {'alpha': 0.5705037206355902, 'batch_size': 30, 'beta_1': 0.8803127641481356, 'beta_2': 0.9795081508341319, 'epsilon': 8.41368960044457e-09, 'hidden_layer_sizes': 175, 'learning_rate_init': 0.0033904999745516225, 'tol': 0.031098398974293253, 'validation_fraction': 0.2893535368435007}
observation time 0.000004, current best -0.958958 at iter 10
suggestion time taken 11.231200 iter 11 next_points [{'alpha': 0.00011012021727167585, 'batch_size': 15, 'beta_1': 0.9884780569548905, 'beta_2': 0.9999980249660009, 'epsilon': 3.2666670632884536e-09, 'hidden_layer_sizes': 199, 'learning_rate_init': 1.7859485385612396e-05, 'tol': 0.0003151048324765806, 'validation_fraction': 0.1015165163146097}]
function_evaluation time 13.687714 value -0.897711 suggestion {'alpha': 0.00011012021727167585, 'batch_size': 15, 'beta_1': 0.9884780569548905, 'beta_2': 0.9999980249660009, 'epsilon': 3.2666670632884536e-09, 'hidden_layer_sizes': 199, 'learning_rate_init': 1.7859485385612396e-05, 'tol': 0.0003151048324765806, 'validation_fraction': 0.1015165163146097}
observation time 0.000004, current best -0.958958 at iter 11
suggestion time taken 10.974901 iter 12 next_points [{'alpha': 9.137577159112615e-05, 'batch_size': 35, 'beta_1': 0.5854407631228018, 'beta_2': 0.9145291135321054, 'epsilon': 3.3788493302516747e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.011932450252859585, 'tol': 0.00030983811203393334, 'validation_fraction': 0.17436063944581798}]
function_evaluation time 1.151826 value -0.952676 suggestion {'alpha': 9.137577159112615e-05, 'batch_size': 35, 'beta_1': 0.5854407631228018, 'beta_2': 0.9145291135321054, 'epsilon': 3.3788493302516747e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.011932450252859585, 'tol': 0.00030983811203393334, 'validation_fraction': 0.17436063944581798}
observation time 0.000004, current best -0.958958 at iter 12
suggestion time taken 10.915201 iter 13 next_points [{'alpha': 0.00361408592232606, 'batch_size': 33, 'beta_1': 0.9186049026541057, 'beta_2': 0.9991344899371182, 'epsilon': 3.60209208376695e-07, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.001290735732787364, 'tol': 0.015002755376256203, 'validation_fraction': 0.1349348371966177}]
function_evaluation time 0.982520 value -0.956168 suggestion {'alpha': 0.00361408592232606, 'batch_size': 33, 'beta_1': 0.9186049026541057, 'beta_2': 0.9991344899371182, 'epsilon': 3.60209208376695e-07, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.001290735732787364, 'tol': 0.015002755376256203, 'validation_fraction': 0.1349348371966177}
observation time 0.000010, current best -0.958958 at iter 13
suggestion time taken 11.255710 iter 14 next_points [{'alpha': 0.6079405745739471, 'batch_size': 11, 'beta_1': 0.987777453446769, 'beta_2': 0.9999973044957589, 'epsilon': 2.296898684741371e-08, 'hidden_layer_sizes': 161, 'learning_rate_init': 0.0002558301215842927, 'tol': 5.7450611196602e-05, 'validation_fraction': 0.22336044867972452}]
function_evaluation time 8.032708 value -0.965912 suggestion {'alpha': 0.6079405745739471, 'batch_size': 11, 'beta_1': 0.987777453446769, 'beta_2': 0.9999973044957589, 'epsilon': 2.296898684741371e-08, 'hidden_layer_sizes': 161, 'learning_rate_init': 0.0002558301215842927, 'tol': 5.7450611196602e-05, 'validation_fraction': 0.22336044867972452}
observation time 0.000004, current best -0.965912 at iter 14
saving meta data: {'args': {'--uuid': 'b007616eeb9c56999e7e13b46ae31fbe', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])}
saving results
saving timing
saving suggest log
done
