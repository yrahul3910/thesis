running: {'--uuid': '907e3c5294285f9b817d9a97c9ccd9d8', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u 907e3c5294285f9b817d9a97c9ccd9d8 -m acc -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_081712
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_acc betwen [-0.2181506  -0.12954897 -0.42701514 -0.94997127 -0.93320509] and [-0.21081107 -0.11575494 -0.27999177 -0.94225223 -0.93253861]
  warnings.warn(

Signature errors:
                           0         1         2         3         4       max
MLP-adam_digits_acc  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
max                  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
starting sklearn study smoothness MLP-adam digits acc 15 1
with data root: None
suggestion time taken 11.265423 iter 0 next_points [{'alpha': 0.06092060505266343, 'batch_size': 21, 'beta_1': 0.9081522498322381, 'beta_2': 0.9978199929209259, 'epsilon': 1.4982807311940222e-08, 'hidden_layer_sizes': 176, 'learning_rate_init': 0.0011287581802690955, 'tol': 0.009221082166415895, 'validation_fraction': 0.27266935013059485}]
function_evaluation time 1.882105 value -0.970780 suggestion {'alpha': 0.06092060505266343, 'batch_size': 21, 'beta_1': 0.9081522498322381, 'beta_2': 0.9978199929209259, 'epsilon': 1.4982807311940222e-08, 'hidden_layer_sizes': 176, 'learning_rate_init': 0.0011287581802690955, 'tol': 0.009221082166415895, 'validation_fraction': 0.27266935013059485}
observation time 0.000005, current best -0.970780 at iter 0
suggestion time taken 11.245926 iter 1 next_points [{'alpha': 0.001012605103440927, 'batch_size': 27, 'beta_1': 0.9860546024977739, 'beta_2': 0.9958868726753316, 'epsilon': 7.896803278368994e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.00022071589394759796, 'tol': 0.001466126793511819, 'validation_fraction': 0.5108547792734429}]
function_evaluation time 4.168056 value -0.951984 suggestion {'alpha': 0.001012605103440927, 'batch_size': 27, 'beta_1': 0.9860546024977739, 'beta_2': 0.9958868726753316, 'epsilon': 7.896803278368994e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.00022071589394759796, 'tol': 0.001466126793511819, 'validation_fraction': 0.5108547792734429}
observation time 0.000005, current best -0.970780 at iter 1
suggestion time taken 11.170886 iter 2 next_points [{'alpha': 0.0003594910156667746, 'batch_size': 10, 'beta_1': 0.9839599551581106, 'beta_2': 0.9999392449961302, 'epsilon': 4.2536496629283814e-07, 'hidden_layer_sizes': 186, 'learning_rate_init': 0.007199682948621642, 'tol': 0.001284974073715883, 'validation_fraction': 0.6903967329034406}]
function_evaluation time 2.140265 value -0.942932 suggestion {'alpha': 0.0003594910156667746, 'batch_size': 10, 'beta_1': 0.9839599551581106, 'beta_2': 0.9999392449961302, 'epsilon': 4.2536496629283814e-07, 'hidden_layer_sizes': 186, 'learning_rate_init': 0.007199682948621642, 'tol': 0.001284974073715883, 'validation_fraction': 0.6903967329034406}
observation time 0.000004, current best -0.970780 at iter 2
suggestion time taken 11.506119 iter 3 next_points [{'alpha': 0.0049876461607383776, 'batch_size': 16, 'beta_1': 0.710020460100546, 'beta_2': 0.9997054387483822, 'epsilon': 9.270060361578167e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.013654483853295154, 'tol': 0.002008513992981066, 'validation_fraction': 0.8941293782000381}]
function_evaluation time 0.447568 value -0.870574 suggestion {'alpha': 0.0049876461607383776, 'batch_size': 16, 'beta_1': 0.710020460100546, 'beta_2': 0.9997054387483822, 'epsilon': 9.270060361578167e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.013654483853295154, 'tol': 0.002008513992981066, 'validation_fraction': 0.8941293782000381}
observation time 0.000005, current best -0.970780 at iter 3
suggestion time taken 11.141973 iter 4 next_points [{'alpha': 1.525821574218724e-05, 'batch_size': 21, 'beta_1': 0.9536170244600926, 'beta_2': 0.9978190538782001, 'epsilon': 1.2112421208422141e-08, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.05544493275372718, 'tol': 0.021855927956791126, 'validation_fraction': 0.5031875077649928}]
function_evaluation time 0.970621 value -0.578559 suggestion {'alpha': 1.525821574218724e-05, 'batch_size': 21, 'beta_1': 0.9536170244600926, 'beta_2': 0.9978190538782001, 'epsilon': 1.2112421208422141e-08, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.05544493275372718, 'tol': 0.021855927956791126, 'validation_fraction': 0.5031875077649928}
observation time 0.000005, current best -0.970780 at iter 4
suggestion time taken 11.528697 iter 5 next_points [{'alpha': 0.3761428389515136, 'batch_size': 15, 'beta_1': 0.9485248943655235, 'beta_2': 0.9999529133469862, 'epsilon': 2.256325707233317e-08, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.05759700811796055, 'tol': 0.0011257272720326284, 'validation_fraction': 0.2880676478980781}]
function_evaluation time 1.684400 value -0.699964 suggestion {'alpha': 0.3761428389515136, 'batch_size': 15, 'beta_1': 0.9485248943655235, 'beta_2': 0.9999529133469862, 'epsilon': 2.256325707233317e-08, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.05759700811796055, 'tol': 0.0011257272720326284, 'validation_fraction': 0.2880676478980781}
observation time 0.000005, current best -0.970780 at iter 5
suggestion time taken 11.261255 iter 6 next_points [{'alpha': 0.88375846598177, 'batch_size': 21, 'beta_1': 0.6682257903933835, 'beta_2': 0.9999748025845397, 'epsilon': 5.44222252449571e-07, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.019806742398671712, 'tol': 5.80995238878262e-05, 'validation_fraction': 0.10302192876848487}]
function_evaluation time 1.492592 value -0.924148 suggestion {'alpha': 0.88375846598177, 'batch_size': 21, 'beta_1': 0.6682257903933835, 'beta_2': 0.9999748025845397, 'epsilon': 5.44222252449571e-07, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.019806742398671712, 'tol': 5.80995238878262e-05, 'validation_fraction': 0.10302192876848487}
observation time 0.000005, current best -0.970780 at iter 6
suggestion time taken 11.166698 iter 7 next_points [{'alpha': 1.4940337144921256, 'batch_size': 15, 'beta_1': 0.9452872619772092, 'beta_2': 0.999176659384111, 'epsilon': 6.833070367771355e-08, 'hidden_layer_sizes': 172, 'learning_rate_init': 7.027217318907488e-05, 'tol': 0.0002466685056984566, 'validation_fraction': 0.3965733716100357}]
function_evaluation time 9.146223 value -0.958936 suggestion {'alpha': 1.4940337144921256, 'batch_size': 15, 'beta_1': 0.9452872619772092, 'beta_2': 0.999176659384111, 'epsilon': 6.833070367771355e-08, 'hidden_layer_sizes': 172, 'learning_rate_init': 7.027217318907488e-05, 'tol': 0.0002466685056984566, 'validation_fraction': 0.3965733716100357}
observation time 0.000004, current best -0.970780 at iter 7
suggestion time taken 11.537549 iter 8 next_points [{'alpha': 0.0004722044460215237, 'batch_size': 13, 'beta_1': 0.9870782035195244, 'beta_2': 0.9597296560430374, 'epsilon': 3.952410212104048e-08, 'hidden_layer_sizes': 138, 'learning_rate_init': 0.0007554379530439594, 'tol': 0.05325712958391559, 'validation_fraction': 0.5314146718344596}]
function_evaluation time 1.288307 value -0.958958 suggestion {'alpha': 0.0004722044460215237, 'batch_size': 13, 'beta_1': 0.9870782035195244, 'beta_2': 0.9597296560430374, 'epsilon': 3.952410212104048e-08, 'hidden_layer_sizes': 138, 'learning_rate_init': 0.0007554379530439594, 'tol': 0.05325712958391559, 'validation_fraction': 0.5314146718344596}
observation time 0.000004, current best -0.970780 at iter 8
suggestion time taken 11.355364 iter 9 next_points [{'alpha': 0.2386469737267134, 'batch_size': 31, 'beta_1': 0.9801114514925717, 'beta_2': 0.9987498311628658, 'epsilon': 4.3069733413638165e-07, 'hidden_layer_sizes': 78, 'learning_rate_init': 1.7357218555068818e-05, 'tol': 5.1646314691550555e-05, 'validation_fraction': 0.5510368679528609}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 7.822519 value -0.796107 suggestion {'alpha': 0.2386469737267134, 'batch_size': 31, 'beta_1': 0.9801114514925717, 'beta_2': 0.9987498311628658, 'epsilon': 4.3069733413638165e-07, 'hidden_layer_sizes': 78, 'learning_rate_init': 1.7357218555068818e-05, 'tol': 5.1646314691550555e-05, 'validation_fraction': 0.5510368679528609}
observation time 0.000006, current best -0.970780 at iter 9
suggestion time taken 11.305446 iter 10 next_points [{'alpha': 0.0028248079972950147, 'batch_size': 36, 'beta_1': 0.9526238863922566, 'beta_2': 0.9999509219709581, 'epsilon': 3.6424490269711556e-08, 'hidden_layer_sizes': 186, 'learning_rate_init': 0.002431525490745901, 'tol': 0.0029854566138650166, 'validation_fraction': 0.10662389823462867}]
function_evaluation time 2.264416 value -0.975644 suggestion {'alpha': 0.0028248079972950147, 'batch_size': 36, 'beta_1': 0.9526238863922566, 'beta_2': 0.9999509219709581, 'epsilon': 3.6424490269711556e-08, 'hidden_layer_sizes': 186, 'learning_rate_init': 0.002431525490745901, 'tol': 0.0029854566138650166, 'validation_fraction': 0.10662389823462867}
observation time 0.000005, current best -0.975644 at iter 10
suggestion time taken 11.561026 iter 11 next_points [{'alpha': 0.0012311255200042673, 'batch_size': 11, 'beta_1': 0.7734513503431567, 'beta_2': 0.9983913647925233, 'epsilon': 7.787260534489619e-09, 'hidden_layer_sizes': 97, 'learning_rate_init': 0.0010580838739531696, 'tol': 0.0012261263890692277, 'validation_fraction': 0.866712332014374}]
function_evaluation time 1.717681 value -0.885872 suggestion {'alpha': 0.0012311255200042673, 'batch_size': 11, 'beta_1': 0.7734513503431567, 'beta_2': 0.9983913647925233, 'epsilon': 7.787260534489619e-09, 'hidden_layer_sizes': 97, 'learning_rate_init': 0.0010580838739531696, 'tol': 0.0012261263890692277, 'validation_fraction': 0.866712332014374}
observation time 0.000005, current best -0.975644 at iter 11
suggestion time taken 11.344387 iter 12 next_points [{'alpha': 0.00018963481818926988, 'batch_size': 13, 'beta_1': 0.9725975018789836, 'beta_2': 0.9998918997655546, 'epsilon': 1.5111586562197046e-08, 'hidden_layer_sizes': 107, 'learning_rate_init': 1.2238269312059756e-05, 'tol': 8.887198151543068e-05, 'validation_fraction': 0.8264924417986986}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 3.963258 value -0.325566 suggestion {'alpha': 0.00018963481818926988, 'batch_size': 13, 'beta_1': 0.9725975018789836, 'beta_2': 0.9998918997655546, 'epsilon': 1.5111586562197046e-08, 'hidden_layer_sizes': 107, 'learning_rate_init': 1.2238269312059756e-05, 'tol': 8.887198151543068e-05, 'validation_fraction': 0.8264924417986986}
observation time 0.000005, current best -0.975644 at iter 12
suggestion time taken 11.279595 iter 13 next_points [{'alpha': 8.543028368882827e-05, 'batch_size': 13, 'beta_1': 0.8377304399674718, 'beta_2': 0.9999922817957477, 'epsilon': 2.4158505895387636e-07, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.0002801622008049064, 'tol': 1.8262448967533675e-05, 'validation_fraction': 0.2854313309061306}]
function_evaluation time 6.231138 value -0.951304 suggestion {'alpha': 8.543028368882827e-05, 'batch_size': 13, 'beta_1': 0.8377304399674718, 'beta_2': 0.9999922817957477, 'epsilon': 2.4158505895387636e-07, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.0002801622008049064, 'tol': 1.8262448967533675e-05, 'validation_fraction': 0.2854313309061306}
observation time 0.000005, current best -0.975644 at iter 13
suggestion time taken 11.574697 iter 14 next_points [{'alpha': 1.052920479024129, 'batch_size': 39, 'beta_1': 0.8856426282986656, 'beta_2': 0.9912730647295721, 'epsilon': 4.915207180667575e-08, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.026181647792991668, 'tol': 7.016325645241775e-05, 'validation_fraction': 0.5715497187051891}]
function_evaluation time 0.828377 value -0.946409 suggestion {'alpha': 1.052920479024129, 'batch_size': 39, 'beta_1': 0.8856426282986656, 'beta_2': 0.9912730647295721, 'epsilon': 4.915207180667575e-08, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.026181647792991668, 'tol': 7.016325645241775e-05, 'validation_fraction': 0.5715497187051891}
observation time 0.000005, current best -0.975644 at iter 14
saving meta data: {'args': {'--uuid': '907e3c5294285f9b817d9a97c9ccd9d8', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_081712', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])}
saving results
saving timing
saving suggest log
done
