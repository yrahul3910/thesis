running: {'--uuid': 'ca6baf5e04865ea39a021a2abee7dbe1', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_021241', '--opt': 'smoothness', '--data': 'breast', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d breast -o smoothness -u ca6baf5e04865ea39a021a2abee7dbe1 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230407_021241
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [8.104566516477803, 14.643876498263253, 12.332285721418042, 5.2697835894868685, 3.490431081639362])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_breast_nll betwen [ 4.58589285 14.6438765   8.74044796  0.67466158  3.06872636] and [ 8.10456652 20.07092365 12.33228572  5.26978359  3.49043108]
  warnings.warn(

Signature errors:
                            0         1         2         3         4       max
MLP-adam_breast_nll  3.518674  5.427047  3.591838  4.595122  0.421705  5.427047
max                  3.518674  5.427047  3.591838  4.595122  0.421705  5.427047
starting sklearn study smoothness MLP-adam breast nll 15 1
with data root: None
suggestion time taken 11.346300 iter 0 next_points [{'alpha': 0.8387762020671656, 'batch_size': 18, 'beta_1': 0.986468436825033, 'beta_2': 0.9999962976843172, 'epsilon': 1.0503315615340502e-09, 'hidden_layer_sizes': 101, 'learning_rate_init': 0.0006598386291883989, 'tol': 4.673996646250211e-05, 'validation_fraction': 0.5793763620387946}]
function_evaluation time 0.527494 value 3.013377 suggestion {'alpha': 0.8387762020671656, 'batch_size': 18, 'beta_1': 0.986468436825033, 'beta_2': 0.9999962976843172, 'epsilon': 1.0503315615340502e-09, 'hidden_layer_sizes': 101, 'learning_rate_init': 0.0006598386291883989, 'tol': 4.673996646250211e-05, 'validation_fraction': 0.5793763620387946}
observation time 0.000005, current best 3.013377 at iter 0
suggestion time taken 11.199923 iter 1 next_points [{'alpha': 9.005557054237412, 'batch_size': 14, 'beta_1': 0.9599341036551318, 'beta_2': 0.9993875737504845, 'epsilon': 1.1380337062976911e-08, 'hidden_layer_sizes': 195, 'learning_rate_init': 0.002855819547868513, 'tol': 0.0006264876479560418, 'validation_fraction': 0.7968077656644349}]
function_evaluation time 0.435159 value 0.636571 suggestion {'alpha': 9.005557054237412, 'batch_size': 14, 'beta_1': 0.9599341036551318, 'beta_2': 0.9993875737504845, 'epsilon': 1.1380337062976911e-08, 'hidden_layer_sizes': 195, 'learning_rate_init': 0.002855819547868513, 'tol': 0.0006264876479560418, 'validation_fraction': 0.7968077656644349}
observation time 0.000005, current best 0.636571 at iter 1
suggestion time taken 10.947909 iter 2 next_points [{'alpha': 3.5735220333915203, 'batch_size': 20, 'beta_1': 0.9645419027834528, 'beta_2': 0.9997384945232908, 'epsilon': 1.3845390666174354e-07, 'hidden_layer_sizes': 198, 'learning_rate_init': 0.0010418585668633274, 'tol': 0.0005529529097446029, 'validation_fraction': 0.14485093893142298}]
function_evaluation time 0.618087 value 0.552801 suggestion {'alpha': 3.5735220333915203, 'batch_size': 20, 'beta_1': 0.9645419027834528, 'beta_2': 0.9997384945232908, 'epsilon': 1.3845390666174354e-07, 'hidden_layer_sizes': 198, 'learning_rate_init': 0.0010418585668633274, 'tol': 0.0005529529097446029, 'validation_fraction': 0.14485093893142298}
observation time 0.000005, current best 0.552801 at iter 2
suggestion time taken 11.258513 iter 3 next_points [{'alpha': 0.0002445185855556052, 'batch_size': 14, 'beta_1': 0.9843934281339018, 'beta_2': 0.999992017350213, 'epsilon': 3.3699322188239474e-09, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.0034163204695369085, 'tol': 0.01743050409764491, 'validation_fraction': 0.40517933954986834}]
function_evaluation time 0.431988 value 0.918149 suggestion {'alpha': 0.0002445185855556052, 'batch_size': 14, 'beta_1': 0.9843934281339018, 'beta_2': 0.999992017350213, 'epsilon': 3.3699322188239474e-09, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.0034163204695369085, 'tol': 0.01743050409764491, 'validation_fraction': 0.40517933954986834}
observation time 0.000005, current best 0.552801 at iter 3
suggestion time taken 11.012704 iter 4 next_points [{'alpha': 0.004077729494633262, 'batch_size': 16, 'beta_1': 0.8713118723725249, 'beta_2': 0.9959358411452718, 'epsilon': 2.545593850107264e-08, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.000800528083583341, 'tol': 0.006747376218917647, 'validation_fraction': 0.5924487028670994}]
function_evaluation time 0.418727 value 0.497268 suggestion {'alpha': 0.004077729494633262, 'batch_size': 16, 'beta_1': 0.8713118723725249, 'beta_2': 0.9959358411452718, 'epsilon': 2.545593850107264e-08, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.000800528083583341, 'tol': 0.006747376218917647, 'validation_fraction': 0.5924487028670994}
observation time 0.000005, current best 0.497268 at iter 4
suggestion time taken 11.227582 iter 5 next_points [{'alpha': 1.1411793979580043e-05, 'batch_size': 19, 'beta_1': 0.929868440543306, 'beta_2': 0.999983285179226, 'epsilon': 1.024918580281382e-07, 'hidden_layer_sizes': 107, 'learning_rate_init': 0.00012225725164145024, 'tol': 0.0007216827503250015, 'validation_fraction': 0.12848369041455254}]
function_evaluation time 0.714660 value 2.891868 suggestion {'alpha': 1.1411793979580043e-05, 'batch_size': 19, 'beta_1': 0.929868440543306, 'beta_2': 0.999983285179226, 'epsilon': 1.024918580281382e-07, 'hidden_layer_sizes': 107, 'learning_rate_init': 0.00012225725164145024, 'tol': 0.0007216827503250015, 'validation_fraction': 0.12848369041455254}
observation time 0.000005, current best 0.497268 at iter 5
suggestion time taken 10.922343 iter 6 next_points [{'alpha': 0.017892151509144236, 'batch_size': 11, 'beta_1': 0.9768492503717857, 'beta_2': 0.9918996438434957, 'epsilon': 1.0772082517887492e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.0013072836847711313, 'tol': 0.00018211637834361058, 'validation_fraction': 0.7147884743352594}]
function_evaluation time 0.595779 value 0.536512 suggestion {'alpha': 0.017892151509144236, 'batch_size': 11, 'beta_1': 0.9768492503717857, 'beta_2': 0.9918996438434957, 'epsilon': 1.0772082517887492e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.0013072836847711313, 'tol': 0.00018211637834361058, 'validation_fraction': 0.7147884743352594}
observation time 0.000004, current best 0.497268 at iter 6
suggestion time taken 10.927051 iter 7 next_points [{'alpha': 0.02235473474725269, 'batch_size': 24, 'beta_1': 0.9536718767178411, 'beta_2': 0.9974483641281033, 'epsilon': 1.3724309947101091e-09, 'hidden_layer_sizes': 164, 'learning_rate_init': 1.127506544540639e-05, 'tol': 0.001444884972459975, 'validation_fraction': 0.8930955766525712}]
function_evaluation time 0.115794 value 18.995734 suggestion {'alpha': 0.02235473474725269, 'batch_size': 24, 'beta_1': 0.9536718767178411, 'beta_2': 0.9974483641281033, 'epsilon': 1.3724309947101091e-09, 'hidden_layer_sizes': 164, 'learning_rate_init': 1.127506544540639e-05, 'tol': 0.001444884972459975, 'validation_fraction': 0.8930955766525712}
observation time 0.000004, current best 0.497268 at iter 7
suggestion time taken 11.325608 iter 8 next_points [{'alpha': 0.00022867812151127165, 'batch_size': 15, 'beta_1': 0.8948448297215044, 'beta_2': 0.9841349716477842, 'epsilon': 3.935097060522399e-07, 'hidden_layer_sizes': 114, 'learning_rate_init': 0.03450851004432813, 'tol': 0.002863964562611307, 'validation_fraction': 0.13693944767263014}]
function_evaluation time 0.600725 value 0.352765 suggestion {'alpha': 0.00022867812151127165, 'batch_size': 15, 'beta_1': 0.8948448297215044, 'beta_2': 0.9841349716477842, 'epsilon': 3.935097060522399e-07, 'hidden_layer_sizes': 114, 'learning_rate_init': 0.03450851004432813, 'tol': 0.002863964562611307, 'validation_fraction': 0.13693944767263014}
observation time 0.000005, current best 0.352765 at iter 8
suggestion time taken 11.023069 iter 9 next_points [{'alpha': 7.41620117374087e-05, 'batch_size': 14, 'beta_1': 0.9591038578656319, 'beta_2': 0.9991009640120376, 'epsilon': 4.0898819248525535e-07, 'hidden_layer_sizes': 167, 'learning_rate_init': 1.8461085835795996e-05, 'tol': 0.037094969798931815, 'validation_fraction': 0.8319959466158375}]
function_evaluation time 0.167282 value 14.526562 suggestion {'alpha': 7.41620117374087e-05, 'batch_size': 14, 'beta_1': 0.9591038578656319, 'beta_2': 0.9991009640120376, 'epsilon': 4.0898819248525535e-07, 'hidden_layer_sizes': 167, 'learning_rate_init': 1.8461085835795996e-05, 'tol': 0.037094969798931815, 'validation_fraction': 0.8319959466158375}
observation time 0.000005, current best 0.352765 at iter 9
suggestion time taken 10.997554 iter 10 next_points [{'alpha': 7.869310850432732e-05, 'batch_size': 10, 'beta_1': 0.8391314838564794, 'beta_2': 0.931471514072531, 'epsilon': 9.690058072505576e-08, 'hidden_layer_sizes': 134, 'learning_rate_init': 0.024788626302197265, 'tol': 0.0002957245547343997, 'validation_fraction': 0.6405847244698271}]
function_evaluation time 0.583515 value 0.444080 suggestion {'alpha': 7.869310850432732e-05, 'batch_size': 10, 'beta_1': 0.8391314838564794, 'beta_2': 0.931471514072531, 'epsilon': 9.690058072505576e-08, 'hidden_layer_sizes': 134, 'learning_rate_init': 0.024788626302197265, 'tol': 0.0002957245547343997, 'validation_fraction': 0.6405847244698271}
observation time 0.000005, current best 0.352765 at iter 10
suggestion time taken 11.286529 iter 11 next_points [{'alpha': 0.005722425022831128, 'batch_size': 17, 'beta_1': 0.9268546645174215, 'beta_2': 0.9850533316763407, 'epsilon': 6.758922512025936e-08, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.06900899972226368, 'tol': 0.0014471392870589357, 'validation_fraction': 0.3380726396239198}]
function_evaluation time 0.535760 value 2.964584 suggestion {'alpha': 0.005722425022831128, 'batch_size': 17, 'beta_1': 0.9268546645174215, 'beta_2': 0.9850533316763407, 'epsilon': 6.758922512025936e-08, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.06900899972226368, 'tol': 0.0014471392870589357, 'validation_fraction': 0.3380726396239198}
observation time 0.000005, current best 0.352765 at iter 11
suggestion time taken 11.000343 iter 12 next_points [{'alpha': 4.583650164606873e-05, 'batch_size': 13, 'beta_1': 0.9727422338915477, 'beta_2': 0.999932658731021, 'epsilon': 2.3842355098484833e-07, 'hidden_layer_sizes': 172, 'learning_rate_init': 0.0029430827365525495, 'tol': 0.0856568387783903, 'validation_fraction': 0.32962808312817843}]
function_evaluation time 0.464522 value 0.845596 suggestion {'alpha': 4.583650164606873e-05, 'batch_size': 13, 'beta_1': 0.9727422338915477, 'beta_2': 0.999932658731021, 'epsilon': 2.3842355098484833e-07, 'hidden_layer_sizes': 172, 'learning_rate_init': 0.0029430827365525495, 'tol': 0.0856568387783903, 'validation_fraction': 0.32962808312817843}
observation time 0.000004, current best 0.352765 at iter 12
suggestion time taken 11.062615 iter 13 next_points [{'alpha': 0.0021057334031727025, 'batch_size': 20, 'beta_1': 0.6401851123314458, 'beta_2': 0.9999789060738947, 'epsilon': 2.7565425957556847e-09, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.0003237933687702816, 'tol': 0.00015992697928841174, 'validation_fraction': 0.8450471014869125}]
function_evaluation time 0.321706 value 10.139366 suggestion {'alpha': 0.0021057334031727025, 'batch_size': 20, 'beta_1': 0.6401851123314458, 'beta_2': 0.9999789060738947, 'epsilon': 2.7565425957556847e-09, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.0003237933687702816, 'tol': 0.00015992697928841174, 'validation_fraction': 0.8450471014869125}
observation time 0.000005, current best 0.352765 at iter 13
suggestion time taken 11.252803 iter 14 next_points [{'alpha': 2.5148802417396804e-05, 'batch_size': 21, 'beta_1': 0.6209542078629253, 'beta_2': 0.9999985912742192, 'epsilon': 3.2109414458630475e-08, 'hidden_layer_sizes': 122, 'learning_rate_init': 0.029769323336102715, 'tol': 0.021311130875668723, 'validation_fraction': 0.6127132121820837}]
function_evaluation time 0.258081 value 0.897586 suggestion {'alpha': 2.5148802417396804e-05, 'batch_size': 21, 'beta_1': 0.6209542078629253, 'beta_2': 0.9999985912742192, 'epsilon': 3.2109414458630475e-08, 'hidden_layer_sizes': 122, 'learning_rate_init': 0.029769323336102715, 'tol': 0.021311130875668723, 'validation_fraction': 0.6127132121820837}
observation time 0.000004, current best 0.352765 at iter 14
saving meta data: {'args': {'--uuid': 'ca6baf5e04865ea39a021a2abee7dbe1', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230407_021241', '--opt': 'smoothness', '--data': 'breast', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [8.104566516477803, 14.643876498263253, 12.332285721418042, 5.2697835894868685, 3.490431081639362])}
saving results
saving timing
saving suggest log
done
