running: {'--uuid': '754391b9054f5507aee0f470f6c7d0ab', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}
cmd: python random-search/optimizer.py -c MLP-adam -d digits -o random-search -u 754391b9054f5507aee0f470f6c7d0ab -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230430_001614
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study random-search MLP-adam digits nll 15 1
with data root: None
suggestion time taken 0.002571 iter 0 next_points [{'alpha': 3.713587558223921, 'batch_size': 151, 'beta_1': 0.9877349407471682, 'beta_2': 0.9995102747287641, 'epsilon': 3.163401619630053e-08, 'hidden_layer_sizes': 67, 'learning_rate_init': 0.006271270002700495, 'tol': 0.00016052132851651136, 'validation_fraction': 0.7895705543608674}]
function_evaluation time 0.621127 value 0.387706 suggestion {'alpha': 3.713587558223921, 'batch_size': 151, 'beta_1': 0.9877349407471682, 'beta_2': 0.9995102747287641, 'epsilon': 3.163401619630053e-08, 'hidden_layer_sizes': 67, 'learning_rate_init': 0.006271270002700495, 'tol': 0.00016052132851651136, 'validation_fraction': 0.7895705543608674}
observation time 0.000006, current best 0.387706 at iter 0
suggestion time taken 0.002499 iter 1 next_points [{'alpha': 0.41712530550103405, 'batch_size': 108, 'beta_1': 0.9818092827807354, 'beta_2': 0.9396782933825802, 'epsilon': 2.5336474812957505e-09, 'hidden_layer_sizes': 183, 'learning_rate_init': 0.0034941490810201214, 'tol': 0.002134765951723297, 'validation_fraction': 0.5568746459267631}]
function_evaluation time 0.864329 value 0.290556 suggestion {'alpha': 0.41712530550103405, 'batch_size': 108, 'beta_1': 0.9818092827807354, 'beta_2': 0.9396782933825802, 'epsilon': 2.5336474812957505e-09, 'hidden_layer_sizes': 183, 'learning_rate_init': 0.0034941490810201214, 'tol': 0.002134765951723297, 'validation_fraction': 0.5568746459267631}
observation time 0.000005, current best 0.290556 at iter 1
suggestion time taken 0.002519 iter 2 next_points [{'alpha': 2.8751893254466285, 'batch_size': 14, 'beta_1': 0.9887523069641752, 'beta_2': 0.9736438018904845, 'epsilon': 3.6528418654841194e-08, 'hidden_layer_sizes': 78, 'learning_rate_init': 0.06847452136141843, 'tol': 0.002557364280489755, 'validation_fraction': 0.44867332116839664}]
function_evaluation time 1.581827 value 1.074828 suggestion {'alpha': 2.8751893254466285, 'batch_size': 14, 'beta_1': 0.9887523069641752, 'beta_2': 0.9736438018904845, 'epsilon': 3.6528418654841194e-08, 'hidden_layer_sizes': 78, 'learning_rate_init': 0.06847452136141843, 'tol': 0.002557364280489755, 'validation_fraction': 0.44867332116839664}
observation time 0.000005, current best 0.290556 at iter 2
suggestion time taken 0.002582 iter 3 next_points [{'alpha': 0.7767360549893091, 'batch_size': 105, 'beta_1': 0.5171297086305294, 'beta_2': 0.9999568631542151, 'epsilon': 2.5179551065563836e-09, 'hidden_layer_sizes': 165, 'learning_rate_init': 9.181366101009777e-05, 'tol': 0.0002313626876313592, 'validation_fraction': 0.6613804570975743}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 3.852172 value 2.065039 suggestion {'alpha': 0.7767360549893091, 'batch_size': 105, 'beta_1': 0.5171297086305294, 'beta_2': 0.9999568631542151, 'epsilon': 2.5179551065563836e-09, 'hidden_layer_sizes': 165, 'learning_rate_init': 9.181366101009777e-05, 'tol': 0.0002313626876313592, 'validation_fraction': 0.6613804570975743}
observation time 0.000004, current best 0.290556 at iter 3
suggestion time taken 0.002433 iter 4 next_points [{'alpha': 0.10712428294244229, 'batch_size': 38, 'beta_1': 0.824846003035342, 'beta_2': 0.999980892018751, 'epsilon': 1.546477042710463e-07, 'hidden_layer_sizes': 106, 'learning_rate_init': 6.566292439846874e-05, 'tol': 2.9407790502224126e-05, 'validation_fraction': 0.8159881850740716}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 4.102288 value 0.570754 suggestion {'alpha': 0.10712428294244229, 'batch_size': 38, 'beta_1': 0.824846003035342, 'beta_2': 0.999980892018751, 'epsilon': 1.546477042710463e-07, 'hidden_layer_sizes': 106, 'learning_rate_init': 6.566292439846874e-05, 'tol': 2.9407790502224126e-05, 'validation_fraction': 0.8159881850740716}
observation time 0.000004, current best 0.290556 at iter 4
suggestion time taken 0.002466 iter 5 next_points [{'alpha': 4.0726531471699924e-05, 'batch_size': 82, 'beta_1': 0.9399257995159426, 'beta_2': 0.9978613307101505, 'epsilon': 1.2318491713189692e-07, 'hidden_layer_sizes': 175, 'learning_rate_init': 0.0007245777487061171, 'tol': 0.00038310075281450424, 'validation_fraction': 0.7660439744341448}]
function_evaluation time 1.881779 value 0.248618 suggestion {'alpha': 4.0726531471699924e-05, 'batch_size': 82, 'beta_1': 0.9399257995159426, 'beta_2': 0.9978613307101505, 'epsilon': 1.2318491713189692e-07, 'hidden_layer_sizes': 175, 'learning_rate_init': 0.0007245777487061171, 'tol': 0.00038310075281450424, 'validation_fraction': 0.7660439744341448}
observation time 0.000005, current best 0.248618 at iter 5
suggestion time taken 0.002437 iter 6 next_points [{'alpha': 0.1959746635782612, 'batch_size': 162, 'beta_1': 0.9753441392957105, 'beta_2': 0.9984289447489372, 'epsilon': 3.141175809099205e-07, 'hidden_layer_sizes': 185, 'learning_rate_init': 4.005001502748523e-05, 'tol': 4.303952666469925e-05, 'validation_fraction': 0.8082477172813843}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 2.506390 value 2.995935 suggestion {'alpha': 0.1959746635782612, 'batch_size': 162, 'beta_1': 0.9753441392957105, 'beta_2': 0.9984289447489372, 'epsilon': 3.141175809099205e-07, 'hidden_layer_sizes': 185, 'learning_rate_init': 4.005001502748523e-05, 'tol': 4.303952666469925e-05, 'validation_fraction': 0.8082477172813843}
observation time 0.000005, current best 0.248618 at iter 6
suggestion time taken 0.002396 iter 7 next_points [{'alpha': 2.9507344057862053, 'batch_size': 246, 'beta_1': 0.874676628305451, 'beta_2': 0.9998517040997578, 'epsilon': 3.865699957825424e-07, 'hidden_layer_sizes': 146, 'learning_rate_init': 5.8778682085075946e-05, 'tol': 9.36897941401509e-05, 'validation_fraction': 0.30443878759772053}]
function_evaluation time 2.710769 value 5.101955 suggestion {'alpha': 2.9507344057862053, 'batch_size': 246, 'beta_1': 0.874676628305451, 'beta_2': 0.9998517040997578, 'epsilon': 3.865699957825424e-07, 'hidden_layer_sizes': 146, 'learning_rate_init': 5.8778682085075946e-05, 'tol': 9.36897941401509e-05, 'validation_fraction': 0.30443878759772053}
observation time 0.000003, current best 0.248618 at iter 7
suggestion time taken 0.002417 iter 8 next_points [{'alpha': 6.832576409500147, 'batch_size': 60, 'beta_1': 0.7654127097904331, 'beta_2': 0.996564920151457, 'epsilon': 3.678576338039369e-07, 'hidden_layer_sizes': 105, 'learning_rate_init': 2.5957290577011545e-05, 'tol': 0.015660047289281068, 'validation_fraction': 0.5667788601728015}]
function_evaluation time 0.369046 value 8.511075 suggestion {'alpha': 6.832576409500147, 'batch_size': 60, 'beta_1': 0.7654127097904331, 'beta_2': 0.996564920151457, 'epsilon': 3.678576338039369e-07, 'hidden_layer_sizes': 105, 'learning_rate_init': 2.5957290577011545e-05, 'tol': 0.015660047289281068, 'validation_fraction': 0.5667788601728015}
observation time 0.000005, current best 0.248618 at iter 8
suggestion time taken 0.002458 iter 9 next_points [{'alpha': 0.0011790587894666433, 'batch_size': 182, 'beta_1': 0.9662094632145835, 'beta_2': 0.9999867400547708, 'epsilon': 4.211407628902659e-08, 'hidden_layer_sizes': 161, 'learning_rate_init': 2.0857663576912803e-05, 'tol': 0.0010152465317195278, 'validation_fraction': 0.802338342457633}]
function_evaluation time 1.117245 value 5.271192 suggestion {'alpha': 0.0011790587894666433, 'batch_size': 182, 'beta_1': 0.9662094632145835, 'beta_2': 0.9999867400547708, 'epsilon': 4.211407628902659e-08, 'hidden_layer_sizes': 161, 'learning_rate_init': 2.0857663576912803e-05, 'tol': 0.0010152465317195278, 'validation_fraction': 0.802338342457633}
observation time 0.000005, current best 0.248618 at iter 9
suggestion time taken 0.002797 iter 10 next_points [{'alpha': 1.7680223355549054, 'batch_size': 211, 'beta_1': 0.7111894778472161, 'beta_2': 0.9823198248367093, 'epsilon': 1.3265469628206433e-09, 'hidden_layer_sizes': 105, 'learning_rate_init': 1.0359981884352674e-05, 'tol': 0.0002954747936675798, 'validation_fraction': 0.438889229646864}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 1.071326 value 9.982081 suggestion {'alpha': 1.7680223355549054, 'batch_size': 211, 'beta_1': 0.7111894778472161, 'beta_2': 0.9823198248367093, 'epsilon': 1.3265469628206433e-09, 'hidden_layer_sizes': 105, 'learning_rate_init': 1.0359981884352674e-05, 'tol': 0.0002954747936675798, 'validation_fraction': 0.438889229646864}
observation time 0.000004, current best 0.248618 at iter 10
suggestion time taken 0.002440 iter 11 next_points [{'alpha': 0.0033164259228250356, 'batch_size': 175, 'beta_1': 0.9665247266390015, 'beta_2': 0.999996078461065, 'epsilon': 1.1781035560256485e-07, 'hidden_layer_sizes': 137, 'learning_rate_init': 0.00024774319767024614, 'tol': 0.00805101716841148, 'validation_fraction': 0.8927127952389068}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.520532 value 2.878032 suggestion {'alpha': 0.0033164259228250356, 'batch_size': 175, 'beta_1': 0.9665247266390015, 'beta_2': 0.999996078461065, 'epsilon': 1.1781035560256485e-07, 'hidden_layer_sizes': 137, 'learning_rate_init': 0.00024774319767024614, 'tol': 0.00805101716841148, 'validation_fraction': 0.8927127952389068}
observation time 0.000005, current best 0.248618 at iter 11
suggestion time taken 0.002534 iter 12 next_points [{'alpha': 0.03394438168752936, 'batch_size': 11, 'beta_1': 0.9195383006217159, 'beta_2': 0.9999952245627555, 'epsilon': 1.0545638445021204e-08, 'hidden_layer_sizes': 102, 'learning_rate_init': 6.32697306716316e-05, 'tol': 1.1883067236683014e-05, 'validation_fraction': 0.3261526443840381}]
function_evaluation time 9.257645 value 0.205175 suggestion {'alpha': 0.03394438168752936, 'batch_size': 11, 'beta_1': 0.9195383006217159, 'beta_2': 0.9999952245627555, 'epsilon': 1.0545638445021204e-08, 'hidden_layer_sizes': 102, 'learning_rate_init': 6.32697306716316e-05, 'tol': 1.1883067236683014e-05, 'validation_fraction': 0.3261526443840381}
observation time 0.000004, current best 0.205175 at iter 12
suggestion time taken 0.002476 iter 13 next_points [{'alpha': 0.00022849306830630153, 'batch_size': 86, 'beta_1': 0.7729241141460144, 'beta_2': 0.9999983215971759, 'epsilon': 1.2293583584125387e-07, 'hidden_layer_sizes': 183, 'learning_rate_init': 2.8377587757495095e-05, 'tol': 0.04851508333771572, 'validation_fraction': 0.5988288218007491}]
function_evaluation time 0.386446 value 5.626995 suggestion {'alpha': 0.00022849306830630153, 'batch_size': 86, 'beta_1': 0.7729241141460144, 'beta_2': 0.9999983215971759, 'epsilon': 1.2293583584125387e-07, 'hidden_layer_sizes': 183, 'learning_rate_init': 2.8377587757495095e-05, 'tol': 0.04851508333771572, 'validation_fraction': 0.5988288218007491}
observation time 0.000005, current best 0.205175 at iter 13
suggestion time taken 0.002495 iter 14 next_points [{'alpha': 1.1811103405900942e-05, 'batch_size': 144, 'beta_1': 0.9703085953605453, 'beta_2': 0.9997551671622771, 'epsilon': 4.577866860133098e-08, 'hidden_layer_sizes': 153, 'learning_rate_init': 0.0007153828980814165, 'tol': 0.00010371529286636212, 'validation_fraction': 0.28331657179745545}]
function_evaluation time 1.517205 value 0.147688 suggestion {'alpha': 1.1811103405900942e-05, 'batch_size': 144, 'beta_1': 0.9703085953605453, 'beta_2': 0.9997551671622771, 'epsilon': 4.577866860133098e-08, 'hidden_layer_sizes': 153, 'learning_rate_init': 0.0007153828980814165, 'tol': 0.00010371529286636212, 'validation_fraction': 0.28331657179745545}
observation time 0.000005, current best 0.147688 at iter 14
saving meta data: {'args': {'--uuid': '754391b9054f5507aee0f470f6c7d0ab', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
