running: {'--uuid': '9e90601e5b765ba18814ce0f294dd07e', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}
cmd: python random-search/optimizer.py -c MLP-adam -d digits -o random-search -u 9e90601e5b765ba18814ce0f294dd07e -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230430_001614
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study random-search MLP-adam digits nll 15 1
with data root: None
suggestion time taken 0.002573 iter 0 next_points [{'alpha': 0.0029932732525029294, 'batch_size': 216, 'beta_1': 0.6896016747027949, 'beta_2': 0.9943839780252405, 'epsilon': 8.893244546820378e-07, 'hidden_layer_sizes': 78, 'learning_rate_init': 0.00016613262329835958, 'tol': 0.029565508389852623, 'validation_fraction': 0.7937684398387439}]
function_evaluation time 0.164948 value 6.482288 suggestion {'alpha': 0.0029932732525029294, 'batch_size': 216, 'beta_1': 0.6896016747027949, 'beta_2': 0.9943839780252405, 'epsilon': 8.893244546820378e-07, 'hidden_layer_sizes': 78, 'learning_rate_init': 0.00016613262329835958, 'tol': 0.029565508389852623, 'validation_fraction': 0.7937684398387439}
observation time 0.000007, current best 6.482288 at iter 0
suggestion time taken 0.002448 iter 1 next_points [{'alpha': 0.005085861098661903, 'batch_size': 215, 'beta_1': 0.7560406248487312, 'beta_2': 0.9993258638567815, 'epsilon': 1.2799934100231833e-09, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.0023546253268657597, 'tol': 0.00042689158567998833, 'validation_fraction': 0.6397451059664049}]
function_evaluation time 1.350225 value 0.277967 suggestion {'alpha': 0.005085861098661903, 'batch_size': 215, 'beta_1': 0.7560406248487312, 'beta_2': 0.9993258638567815, 'epsilon': 1.2799934100231833e-09, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.0023546253268657597, 'tol': 0.00042689158567998833, 'validation_fraction': 0.6397451059664049}
observation time 0.000005, current best 0.277967 at iter 1
suggestion time taken 0.002765 iter 2 next_points [{'alpha': 8.38747251368629e-05, 'batch_size': 87, 'beta_1': 0.9894421087531554, 'beta_2': 0.9999951386511279, 'epsilon': 2.1979762845272802e-08, 'hidden_layer_sizes': 77, 'learning_rate_init': 0.000562714374473603, 'tol': 0.013817541257816616, 'validation_fraction': 0.8416574596904087}]
function_evaluation time 0.730725 value 0.877147 suggestion {'alpha': 8.38747251368629e-05, 'batch_size': 87, 'beta_1': 0.9894421087531554, 'beta_2': 0.9999951386511279, 'epsilon': 2.1979762845272802e-08, 'hidden_layer_sizes': 77, 'learning_rate_init': 0.000562714374473603, 'tol': 0.013817541257816616, 'validation_fraction': 0.8416574596904087}
observation time 0.000005, current best 0.277967 at iter 2
suggestion time taken 0.002465 iter 3 next_points [{'alpha': 4.57563022027164, 'batch_size': 31, 'beta_1': 0.6114754453675237, 'beta_2': 0.9860384754204105, 'epsilon': 5.800801473663936e-07, 'hidden_layer_sizes': 134, 'learning_rate_init': 0.003969922727117683, 'tol': 0.0013894567787844118, 'validation_fraction': 0.7083229200856012}]
function_evaluation time 1.108577 value 0.242057 suggestion {'alpha': 4.57563022027164, 'batch_size': 31, 'beta_1': 0.6114754453675237, 'beta_2': 0.9860384754204105, 'epsilon': 5.800801473663936e-07, 'hidden_layer_sizes': 134, 'learning_rate_init': 0.003969922727117683, 'tol': 0.0013894567787844118, 'validation_fraction': 0.7083229200856012}
observation time 0.000004, current best 0.242057 at iter 3
suggestion time taken 0.002738 iter 4 next_points [{'alpha': 0.4095770996328328, 'batch_size': 187, 'beta_1': 0.6089615161213894, 'beta_2': 0.9834504938431122, 'epsilon': 2.563826570940841e-09, 'hidden_layer_sizes': 95, 'learning_rate_init': 0.02681105413813512, 'tol': 1.9614787913834978e-05, 'validation_fraction': 0.7319111118550775}]
function_evaluation time 0.826264 value 0.230273 suggestion {'alpha': 0.4095770996328328, 'batch_size': 187, 'beta_1': 0.6089615161213894, 'beta_2': 0.9834504938431122, 'epsilon': 2.563826570940841e-09, 'hidden_layer_sizes': 95, 'learning_rate_init': 0.02681105413813512, 'tol': 1.9614787913834978e-05, 'validation_fraction': 0.7319111118550775}
observation time 0.000005, current best 0.230273 at iter 4
suggestion time taken 0.002446 iter 5 next_points [{'alpha': 9.34402712418354e-05, 'batch_size': 135, 'beta_1': 0.6802865947193645, 'beta_2': 0.9999712811597891, 'epsilon': 5.794970237668386e-07, 'hidden_layer_sizes': 104, 'learning_rate_init': 1.1149259853166155e-05, 'tol': 1.603824982482819e-05, 'validation_fraction': 0.5901389159404851}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 1.196677 value 10.430224 suggestion {'alpha': 9.34402712418354e-05, 'batch_size': 135, 'beta_1': 0.6802865947193645, 'beta_2': 0.9999712811597891, 'epsilon': 5.794970237668386e-07, 'hidden_layer_sizes': 104, 'learning_rate_init': 1.1149259853166155e-05, 'tol': 1.603824982482819e-05, 'validation_fraction': 0.5901389159404851}
observation time 0.000005, current best 0.230273 at iter 5
suggestion time taken 0.002522 iter 6 next_points [{'alpha': 0.5108022657350244, 'batch_size': 230, 'beta_1': 0.525847164662876, 'beta_2': 0.9999968939086603, 'epsilon': 5.367949994544811e-08, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.02061468601409753, 'tol': 0.001604463421981885, 'validation_fraction': 0.8904768671273047}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.513315 value 0.675766 suggestion {'alpha': 0.5108022657350244, 'batch_size': 230, 'beta_1': 0.525847164662876, 'beta_2': 0.9999968939086603, 'epsilon': 5.367949994544811e-08, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.02061468601409753, 'tol': 0.001604463421981885, 'validation_fraction': 0.8904768671273047}
observation time 0.000005, current best 0.230273 at iter 6
suggestion time taken 0.002436 iter 7 next_points [{'alpha': 0.0004912208989531964, 'batch_size': 184, 'beta_1': 0.7222019981849901, 'beta_2': 0.9998129309677997, 'epsilon': 1.039055604222285e-07, 'hidden_layer_sizes': 144, 'learning_rate_init': 0.004714615389426087, 'tol': 0.0006458701142311465, 'validation_fraction': 0.3886381265929478}]
function_evaluation time 1.005108 value 0.140886 suggestion {'alpha': 0.0004912208989531964, 'batch_size': 184, 'beta_1': 0.7222019981849901, 'beta_2': 0.9998129309677997, 'epsilon': 1.039055604222285e-07, 'hidden_layer_sizes': 144, 'learning_rate_init': 0.004714615389426087, 'tol': 0.0006458701142311465, 'validation_fraction': 0.3886381265929478}
observation time 0.000005, current best 0.140886 at iter 7
suggestion time taken 0.002472 iter 8 next_points [{'alpha': 0.15632994374319042, 'batch_size': 160, 'beta_1': 0.889775983582189, 'beta_2': 0.9999973731354213, 'epsilon': 6.09438083839663e-08, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.005034466593674243, 'tol': 0.0003528160890039309, 'validation_fraction': 0.890471502150896}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.629672 value 0.558599 suggestion {'alpha': 0.15632994374319042, 'batch_size': 160, 'beta_1': 0.889775983582189, 'beta_2': 0.9999973731354213, 'epsilon': 6.09438083839663e-08, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.005034466593674243, 'tol': 0.0003528160890039309, 'validation_fraction': 0.890471502150896}
observation time 0.000005, current best 0.140886 at iter 8
suggestion time taken 0.002752 iter 9 next_points [{'alpha': 0.0005856367738260119, 'batch_size': 153, 'beta_1': 0.8522252642637997, 'beta_2': 0.9988935718118916, 'epsilon': 7.337879655458551e-09, 'hidden_layer_sizes': 143, 'learning_rate_init': 0.0003214127749141199, 'tol': 2.5489965242512583e-05, 'validation_fraction': 0.8396903471352835}]
function_evaluation time 2.364559 value 0.431769 suggestion {'alpha': 0.0005856367738260119, 'batch_size': 153, 'beta_1': 0.8522252642637997, 'beta_2': 0.9988935718118916, 'epsilon': 7.337879655458551e-09, 'hidden_layer_sizes': 143, 'learning_rate_init': 0.0003214127749141199, 'tol': 2.5489965242512583e-05, 'validation_fraction': 0.8396903471352835}
observation time 0.000004, current best 0.140886 at iter 9
suggestion time taken 0.002470 iter 10 next_points [{'alpha': 0.5763390264531463, 'batch_size': 223, 'beta_1': 0.9494930060596359, 'beta_2': 0.9916399984128743, 'epsilon': 3.296596772970335e-07, 'hidden_layer_sizes': 156, 'learning_rate_init': 0.011558715161569453, 'tol': 0.00010274630833670181, 'validation_fraction': 0.5047086161771049}]
function_evaluation time 0.965422 value 0.179808 suggestion {'alpha': 0.5763390264531463, 'batch_size': 223, 'beta_1': 0.9494930060596359, 'beta_2': 0.9916399984128743, 'epsilon': 3.296596772970335e-07, 'hidden_layer_sizes': 156, 'learning_rate_init': 0.011558715161569453, 'tol': 0.00010274630833670181, 'validation_fraction': 0.5047086161771049}
observation time 0.000005, current best 0.140886 at iter 10
suggestion time taken 0.002480 iter 11 next_points [{'alpha': 0.0036571656230180243, 'batch_size': 138, 'beta_1': 0.7748503819318004, 'beta_2': 0.9999334823257755, 'epsilon': 9.004749694098517e-08, 'hidden_layer_sizes': 133, 'learning_rate_init': 0.00048503847448528437, 'tol': 0.002198173354307337, 'validation_fraction': 0.8962887728143287}]
function_evaluation time 1.114278 value 0.660231 suggestion {'alpha': 0.0036571656230180243, 'batch_size': 138, 'beta_1': 0.7748503819318004, 'beta_2': 0.9999334823257755, 'epsilon': 9.004749694098517e-08, 'hidden_layer_sizes': 133, 'learning_rate_init': 0.00048503847448528437, 'tol': 0.002198173354307337, 'validation_fraction': 0.8962887728143287}
observation time 0.000005, current best 0.140886 at iter 11
suggestion time taken 0.002751 iter 12 next_points [{'alpha': 0.22416032090756327, 'batch_size': 160, 'beta_1': 0.7239596711171992, 'beta_2': 0.9998857153063903, 'epsilon': 1.5420117074477208e-08, 'hidden_layer_sizes': 109, 'learning_rate_init': 2.6745572152402908e-05, 'tol': 8.811208472594661e-05, 'validation_fraction': 0.8399759861103722}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 0.990150 value 8.122591 suggestion {'alpha': 0.22416032090756327, 'batch_size': 160, 'beta_1': 0.7239596711171992, 'beta_2': 0.9998857153063903, 'epsilon': 1.5420117074477208e-08, 'hidden_layer_sizes': 109, 'learning_rate_init': 2.6745572152402908e-05, 'tol': 8.811208472594661e-05, 'validation_fraction': 0.8399759861103722}
observation time 0.000004, current best 0.140886 at iter 12
suggestion time taken 0.002482 iter 13 next_points [{'alpha': 3.016089634307647, 'batch_size': 101, 'beta_1': 0.74563541593336, 'beta_2': 0.9999721523351356, 'epsilon': 2.5190467190758546e-08, 'hidden_layer_sizes': 129, 'learning_rate_init': 0.0015541737308928806, 'tol': 0.0149775339722152, 'validation_fraction': 0.8249728451389594}]
function_evaluation time 0.355454 value 0.432918 suggestion {'alpha': 3.016089634307647, 'batch_size': 101, 'beta_1': 0.74563541593336, 'beta_2': 0.9999721523351356, 'epsilon': 2.5190467190758546e-08, 'hidden_layer_sizes': 129, 'learning_rate_init': 0.0015541737308928806, 'tol': 0.0149775339722152, 'validation_fraction': 0.8249728451389594}
observation time 0.000005, current best 0.140886 at iter 13
suggestion time taken 0.002692 iter 14 next_points [{'alpha': 0.00504493067522699, 'batch_size': 219, 'beta_1': 0.9633872332563347, 'beta_2': 0.9859051891472, 'epsilon': 1.800742599097115e-08, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.0704081020312579, 'tol': 1.002173868918809e-05, 'validation_fraction': 0.5142531838627269}]
function_evaluation time 0.701065 value 5.539610 suggestion {'alpha': 0.00504493067522699, 'batch_size': 219, 'beta_1': 0.9633872332563347, 'beta_2': 0.9859051891472, 'epsilon': 1.800742599097115e-08, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.0704081020312579, 'tol': 1.002173868918809e-05, 'validation_fraction': 0.5142531838627269}
observation time 0.000005, current best 0.140886 at iter 14
saving meta data: {'args': {'--uuid': '9e90601e5b765ba18814ce0f294dd07e', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
