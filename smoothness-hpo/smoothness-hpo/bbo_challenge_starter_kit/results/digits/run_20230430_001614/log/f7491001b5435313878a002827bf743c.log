running: {'--uuid': 'f7491001b5435313878a002827bf743c', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u f7491001b5435313878a002827bf743c -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230430_001614
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study smoothness MLP-adam digits nll 15 1
with data root: None
suggestion time taken 9.392346 iter 0 next_points [{'alpha': 0.048439558991843865, 'batch_size': 32, 'beta_1': 0.9162528700966901, 'beta_2': 0.9999850613786172, 'epsilon': 2.889821625156774e-07, 'hidden_layer_sizes': 83, 'learning_rate_init': 0.0028694010324855517, 'tol': 0.001491428105882489, 'validation_fraction': 0.7010872071212837}]
function_evaluation time 1.047183 value 0.209504 suggestion {'alpha': 0.048439558991843865, 'batch_size': 32, 'beta_1': 0.9162528700966901, 'beta_2': 0.9999850613786172, 'epsilon': 2.889821625156774e-07, 'hidden_layer_sizes': 83, 'learning_rate_init': 0.0028694010324855517, 'tol': 0.001491428105882489, 'validation_fraction': 0.7010872071212837}
observation time 0.000006, current best 0.209504 at iter 0
suggestion time taken 9.290065 iter 1 next_points [{'alpha': 0.03126403607509399, 'batch_size': 11, 'beta_1': 0.7473680276487652, 'beta_2': 0.9185570208194249, 'epsilon': 9.899238169500284e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.000550782023230929, 'tol': 0.0462779826171466, 'validation_fraction': 0.788488146463784}]
function_evaluation time 0.816046 value 0.346214 suggestion {'alpha': 0.03126403607509399, 'batch_size': 11, 'beta_1': 0.7473680276487652, 'beta_2': 0.9185570208194249, 'epsilon': 9.899238169500284e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.000550782023230929, 'tol': 0.0462779826171466, 'validation_fraction': 0.788488146463784}
observation time 0.000005, current best 0.209504 at iter 1
suggestion time taken 9.219192 iter 2 next_points [{'alpha': 2.6347201773172162e-05, 'batch_size': 37, 'beta_1': 0.9480908487988968, 'beta_2': 0.9309427332435035, 'epsilon': 3.1337036293525722e-09, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.020044515561539508, 'tol': 2.4389774029045085e-05, 'validation_fraction': 0.857557958267787}]
function_evaluation time 0.526204 value 0.772387 suggestion {'alpha': 2.6347201773172162e-05, 'batch_size': 37, 'beta_1': 0.9480908487988968, 'beta_2': 0.9309427332435035, 'epsilon': 3.1337036293525722e-09, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.020044515561539508, 'tol': 2.4389774029045085e-05, 'validation_fraction': 0.857557958267787}
observation time 0.000005, current best 0.209504 at iter 2
suggestion time taken 9.578581 iter 3 next_points [{'alpha': 0.6528048113637924, 'batch_size': 26, 'beta_1': 0.8870181837643225, 'beta_2': 0.9975777178668063, 'epsilon': 1.818546996070616e-08, 'hidden_layer_sizes': 101, 'learning_rate_init': 5.8571620151942195e-05, 'tol': 0.0663143663015213, 'validation_fraction': 0.30168226038777357}]
function_evaluation time 1.037340 value 1.820906 suggestion {'alpha': 0.6528048113637924, 'batch_size': 26, 'beta_1': 0.8870181837643225, 'beta_2': 0.9975777178668063, 'epsilon': 1.818546996070616e-08, 'hidden_layer_sizes': 101, 'learning_rate_init': 5.8571620151942195e-05, 'tol': 0.0663143663015213, 'validation_fraction': 0.30168226038777357}
observation time 0.000006, current best 0.209504 at iter 3
suggestion time taken 9.260384 iter 4 next_points [{'alpha': 0.0005790564625805478, 'batch_size': 31, 'beta_1': 0.9551766757188878, 'beta_2': 0.9708310791370438, 'epsilon': 6.846577518523753e-09, 'hidden_layer_sizes': 91, 'learning_rate_init': 0.0017330782506616085, 'tol': 0.09476476807565738, 'validation_fraction': 0.7771830534552484}]
function_evaluation time 0.404733 value 0.258736 suggestion {'alpha': 0.0005790564625805478, 'batch_size': 31, 'beta_1': 0.9551766757188878, 'beta_2': 0.9708310791370438, 'epsilon': 6.846577518523753e-09, 'hidden_layer_sizes': 91, 'learning_rate_init': 0.0017330782506616085, 'tol': 0.09476476807565738, 'validation_fraction': 0.7771830534552484}
observation time 0.000005, current best 0.209504 at iter 4
suggestion time taken 9.287555 iter 5 next_points [{'alpha': 0.006896190491781375, 'batch_size': 22, 'beta_1': 0.9013104095036691, 'beta_2': 0.9972092405159109, 'epsilon': 1.6316572670303373e-07, 'hidden_layer_sizes': 59, 'learning_rate_init': 0.031787488570964896, 'tol': 0.000190517406988941, 'validation_fraction': 0.18835641882830828}]
function_evaluation time 1.902622 value 0.288721 suggestion {'alpha': 0.006896190491781375, 'batch_size': 22, 'beta_1': 0.9013104095036691, 'beta_2': 0.9972092405159109, 'epsilon': 1.6316572670303373e-07, 'hidden_layer_sizes': 59, 'learning_rate_init': 0.031787488570964896, 'tol': 0.000190517406988941, 'validation_fraction': 0.18835641882830828}
observation time 0.000005, current best 0.209504 at iter 5
suggestion time taken 9.244395 iter 6 next_points [{'alpha': 0.0068234332540812286, 'batch_size': 33, 'beta_1': 0.9841846253220622, 'beta_2': 0.9616063386353503, 'epsilon': 1.1145357402546764e-07, 'hidden_layer_sizes': 68, 'learning_rate_init': 8.274335951788251e-05, 'tol': 0.00018563972256045784, 'validation_fraction': 0.4026940919710791}]
function_evaluation time 5.108028 value 0.219630 suggestion {'alpha': 0.0068234332540812286, 'batch_size': 33, 'beta_1': 0.9841846253220622, 'beta_2': 0.9616063386353503, 'epsilon': 1.1145357402546764e-07, 'hidden_layer_sizes': 68, 'learning_rate_init': 8.274335951788251e-05, 'tol': 0.00018563972256045784, 'validation_fraction': 0.4026940919710791}
observation time 0.000004, current best 0.209504 at iter 6
suggestion time taken 9.261199 iter 7 next_points [{'alpha': 8.73936788188595, 'batch_size': 48, 'beta_1': 0.8543663446437042, 'beta_2': 0.9979421751015434, 'epsilon': 6.222948819144775e-09, 'hidden_layer_sizes': 58, 'learning_rate_init': 5.070968198106399e-05, 'tol': 0.03406692513619457, 'validation_fraction': 0.19688536082918795}]
function_evaluation time 0.622653 value 4.395783 suggestion {'alpha': 8.73936788188595, 'batch_size': 48, 'beta_1': 0.8543663446437042, 'beta_2': 0.9979421751015434, 'epsilon': 6.222948819144775e-09, 'hidden_layer_sizes': 58, 'learning_rate_init': 5.070968198106399e-05, 'tol': 0.03406692513619457, 'validation_fraction': 0.19688536082918795}
observation time 0.000006, current best 0.209504 at iter 7
suggestion time taken 9.332732 iter 8 next_points [{'alpha': 0.03556879560840608, 'batch_size': 14, 'beta_1': 0.9719030571366436, 'beta_2': 0.9999914890360238, 'epsilon': 7.356609012515753e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.055214151293321356, 'tol': 1.7649085683354702e-05, 'validation_fraction': 0.5320246428247207}]
function_evaluation time 1.349369 value 1.241401 suggestion {'alpha': 0.03556879560840608, 'batch_size': 14, 'beta_1': 0.9719030571366436, 'beta_2': 0.9999914890360238, 'epsilon': 7.356609012515753e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.055214151293321356, 'tol': 1.7649085683354702e-05, 'validation_fraction': 0.5320246428247207}
observation time 0.000005, current best 0.209504 at iter 8
suggestion time taken 9.418030 iter 9 next_points [{'alpha': 0.0942219294134578, 'batch_size': 19, 'beta_1': 0.9588652956449986, 'beta_2': 0.9556994139697715, 'epsilon': 5.998686654741629e-07, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.0011653944543447822, 'tol': 4.267573216156442e-05, 'validation_fraction': 0.8804070706019028}]
function_evaluation time 1.552541 value 0.311648 suggestion {'alpha': 0.0942219294134578, 'batch_size': 19, 'beta_1': 0.9588652956449986, 'beta_2': 0.9556994139697715, 'epsilon': 5.998686654741629e-07, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.0011653944543447822, 'tol': 4.267573216156442e-05, 'validation_fraction': 0.8804070706019028}
observation time 0.000005, current best 0.209504 at iter 9
suggestion time taken 9.308914 iter 10 next_points [{'alpha': 0.10132167015184392, 'batch_size': 19, 'beta_1': 0.9881057546394061, 'beta_2': 0.9999986715413955, 'epsilon': 2.983749335530713e-07, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.00011496014282542896, 'tol': 0.0024447598356265293, 'validation_fraction': 0.7329526319399977}]
function_evaluation time 3.130044 value 0.448751 suggestion {'alpha': 0.10132167015184392, 'batch_size': 19, 'beta_1': 0.9881057546394061, 'beta_2': 0.9999986715413955, 'epsilon': 2.983749335530713e-07, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.00011496014282542896, 'tol': 0.0024447598356265293, 'validation_fraction': 0.7329526319399977}
observation time 0.000005, current best 0.209504 at iter 10
suggestion time taken 9.294514 iter 11 next_points [{'alpha': 0.0005123363050170094, 'batch_size': 25, 'beta_1': 0.703321752715449, 'beta_2': 0.9665028500781355, 'epsilon': 1.533951205245176e-08, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.036475468634287384, 'tol': 0.00041891853849311794, 'validation_fraction': 0.3272377496709313}]
function_evaluation time 1.754331 value 0.411965 suggestion {'alpha': 0.0005123363050170094, 'batch_size': 25, 'beta_1': 0.703321752715449, 'beta_2': 0.9665028500781355, 'epsilon': 1.533951205245176e-08, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.036475468634287384, 'tol': 0.00041891853849311794, 'validation_fraction': 0.3272377496709313}
observation time 0.000004, current best 0.209504 at iter 11
suggestion time taken 9.345617 iter 12 next_points [{'alpha': 0.050238748509670764, 'batch_size': 13, 'beta_1': 0.7582057934889675, 'beta_2': 0.9987894489276979, 'epsilon': 5.538269948831459e-09, 'hidden_layer_sizes': 83, 'learning_rate_init': 0.00014343038318484697, 'tol': 0.0009545124483857075, 'validation_fraction': 0.10507643572933262}]
function_evaluation time 3.845021 value 0.192940 suggestion {'alpha': 0.050238748509670764, 'batch_size': 13, 'beta_1': 0.7582057934889675, 'beta_2': 0.9987894489276979, 'epsilon': 5.538269948831459e-09, 'hidden_layer_sizes': 83, 'learning_rate_init': 0.00014343038318484697, 'tol': 0.0009545124483857075, 'validation_fraction': 0.10507643572933262}
observation time 0.000006, current best 0.192940 at iter 12
suggestion time taken 9.253567 iter 13 next_points [{'alpha': 0.015922274478196722, 'batch_size': 19, 'beta_1': 0.9191415701845395, 'beta_2': 0.97476291264882, 'epsilon': 4.662830111904354e-09, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.06358277015643828, 'tol': 0.001446475242572528, 'validation_fraction': 0.7538762088892452}]
function_evaluation time 0.755523 value 1.468189 suggestion {'alpha': 0.015922274478196722, 'batch_size': 19, 'beta_1': 0.9191415701845395, 'beta_2': 0.97476291264882, 'epsilon': 4.662830111904354e-09, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.06358277015643828, 'tol': 0.001446475242572528, 'validation_fraction': 0.7538762088892452}
observation time 0.000005, current best 0.192940 at iter 13
suggestion time taken 9.306129 iter 14 next_points [{'alpha': 0.02616982205977402, 'batch_size': 17, 'beta_1': 0.800856490448338, 'beta_2': 0.9486240525456271, 'epsilon': 9.192730063214126e-08, 'hidden_layer_sizes': 102, 'learning_rate_init': 0.00017114299541719642, 'tol': 0.0006637365346849318, 'validation_fraction': 0.22172837660179331}]
function_evaluation time 5.217005 value 0.137151 suggestion {'alpha': 0.02616982205977402, 'batch_size': 17, 'beta_1': 0.800856490448338, 'beta_2': 0.9486240525456271, 'epsilon': 9.192730063214126e-08, 'hidden_layer_sizes': 102, 'learning_rate_init': 0.00017114299541719642, 'tol': 0.0006637365346849318, 'validation_fraction': 0.22172837660179331}
observation time 0.000006, current best 0.137151 at iter 14
saving meta data: {'args': {'--uuid': 'f7491001b5435313878a002827bf743c', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
