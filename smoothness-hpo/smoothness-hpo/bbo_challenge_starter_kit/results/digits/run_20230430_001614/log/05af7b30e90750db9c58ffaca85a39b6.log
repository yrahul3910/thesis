running: {'--uuid': '05af7b30e90750db9c58ffaca85a39b6', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u 05af7b30e90750db9c58ffaca85a39b6 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230430_001614
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study smoothness MLP-adam digits nll 15 1
with data root: None
suggestion time taken 9.468412 iter 0 next_points [{'alpha': 0.00047567262692406974, 'batch_size': 14, 'beta_1': 0.852028072602239, 'beta_2': 0.9999938694815427, 'epsilon': 7.233344774123015e-08, 'hidden_layer_sizes': 75, 'learning_rate_init': 9.570981359046613e-05, 'tol': 0.00017027500805997533, 'validation_fraction': 0.6578013047443984}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 7.727557 value 0.296967 suggestion {'alpha': 0.00047567262692406974, 'batch_size': 14, 'beta_1': 0.852028072602239, 'beta_2': 0.9999938694815427, 'epsilon': 7.233344774123015e-08, 'hidden_layer_sizes': 75, 'learning_rate_init': 9.570981359046613e-05, 'tol': 0.00017027500805997533, 'validation_fraction': 0.6578013047443984}
observation time 0.000006, current best 0.296967 at iter 0
suggestion time taken 9.290396 iter 1 next_points [{'alpha': 5.680570888998722, 'batch_size': 19, 'beta_1': 0.6740514441890804, 'beta_2': 0.965022093542179, 'epsilon': 4.263142588919115e-09, 'hidden_layer_sizes': 125, 'learning_rate_init': 0.00022355377159293208, 'tol': 0.0003262072924163491, 'validation_fraction': 0.20991821900778568}]
function_evaluation time 3.239568 value 0.284811 suggestion {'alpha': 5.680570888998722, 'batch_size': 19, 'beta_1': 0.6740514441890804, 'beta_2': 0.965022093542179, 'epsilon': 4.263142588919115e-09, 'hidden_layer_sizes': 125, 'learning_rate_init': 0.00022355377159293208, 'tol': 0.0003262072924163491, 'validation_fraction': 0.20991821900778568}
observation time 0.000005, current best 0.284811 at iter 1
suggestion time taken 9.312985 iter 2 next_points [{'alpha': 2.8898942894294072e-05, 'batch_size': 26, 'beta_1': 0.9544400028979512, 'beta_2': 0.99999798887785, 'epsilon': 5.73089778958793e-07, 'hidden_layer_sizes': 121, 'learning_rate_init': 0.03907330025690019, 'tol': 0.0011928402968151629, 'validation_fraction': 0.14850169605247796}]
function_evaluation time 2.047605 value 0.517228 suggestion {'alpha': 2.8898942894294072e-05, 'batch_size': 26, 'beta_1': 0.9544400028979512, 'beta_2': 0.99999798887785, 'epsilon': 5.73089778958793e-07, 'hidden_layer_sizes': 121, 'learning_rate_init': 0.03907330025690019, 'tol': 0.0011928402968151629, 'validation_fraction': 0.14850169605247796}
observation time 0.000006, current best 0.284811 at iter 2
suggestion time taken 9.555089 iter 3 next_points [{'alpha': 5.460652891053393e-05, 'batch_size': 26, 'beta_1': 0.8192544287977601, 'beta_2': 0.9685749736032965, 'epsilon': 1.2553907863047838e-09, 'hidden_layer_sizes': 75, 'learning_rate_init': 0.017827921171422092, 'tol': 5.6103202921742426e-05, 'validation_fraction': 0.3491309878471125}]
function_evaluation time 1.564648 value 0.248807 suggestion {'alpha': 5.460652891053393e-05, 'batch_size': 26, 'beta_1': 0.8192544287977601, 'beta_2': 0.9685749736032965, 'epsilon': 1.2553907863047838e-09, 'hidden_layer_sizes': 75, 'learning_rate_init': 0.017827921171422092, 'tol': 5.6103202921742426e-05, 'validation_fraction': 0.3491309878471125}
observation time 0.000006, current best 0.248807 at iter 3
suggestion time taken 9.452538 iter 4 next_points [{'alpha': 0.27171738341738577, 'batch_size': 16, 'beta_1': 0.9577270198203637, 'beta_2': 0.9999919940300188, 'epsilon': 1.3674270265707506e-09, 'hidden_layer_sizes': 82, 'learning_rate_init': 0.00028911488136532354, 'tol': 0.0003133460773029978, 'validation_fraction': 0.6539761375227664}]
function_evaluation time 4.260713 value 0.201546 suggestion {'alpha': 0.27171738341738577, 'batch_size': 16, 'beta_1': 0.9577270198203637, 'beta_2': 0.9999919940300188, 'epsilon': 1.3674270265707506e-09, 'hidden_layer_sizes': 82, 'learning_rate_init': 0.00028911488136532354, 'tol': 0.0003133460773029978, 'validation_fraction': 0.6539761375227664}
observation time 0.000006, current best 0.201546 at iter 4
suggestion time taken 9.358897 iter 5 next_points [{'alpha': 0.37098789688157996, 'batch_size': 28, 'beta_1': 0.9619158972070236, 'beta_2': 0.907377622594306, 'epsilon': 1.518345729981161e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.003587983238545694, 'tol': 0.0006596016961753816, 'validation_fraction': 0.7699640483918845}]
function_evaluation time 1.056208 value 0.187667 suggestion {'alpha': 0.37098789688157996, 'batch_size': 28, 'beta_1': 0.9619158972070236, 'beta_2': 0.907377622594306, 'epsilon': 1.518345729981161e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.003587983238545694, 'tol': 0.0006596016961753816, 'validation_fraction': 0.7699640483918845}
observation time 0.000006, current best 0.187667 at iter 5
suggestion time taken 9.431624 iter 6 next_points [{'alpha': 0.22173997134260828, 'batch_size': 22, 'beta_1': 0.9288633154743202, 'beta_2': 0.9999658307555808, 'epsilon': 8.072679070528406e-07, 'hidden_layer_sizes': 78, 'learning_rate_init': 0.004768535176087315, 'tol': 6.391534533421386e-05, 'validation_fraction': 0.6613455731627825}]
function_evaluation time 1.472551 value 0.167753 suggestion {'alpha': 0.22173997134260828, 'batch_size': 22, 'beta_1': 0.9288633154743202, 'beta_2': 0.9999658307555808, 'epsilon': 8.072679070528406e-07, 'hidden_layer_sizes': 78, 'learning_rate_init': 0.004768535176087315, 'tol': 6.391534533421386e-05, 'validation_fraction': 0.6613455731627825}
observation time 0.000005, current best 0.167753 at iter 6
suggestion time taken 9.409221 iter 7 next_points [{'alpha': 1.3846373154598313, 'batch_size': 21, 'beta_1': 0.970085326165728, 'beta_2': 0.9827178330640274, 'epsilon': 3.536558465672918e-07, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.0005723568555770953, 'tol': 9.288563342867341e-05, 'validation_fraction': 0.13366252177485619}]
function_evaluation time 2.042673 value 0.148273 suggestion {'alpha': 1.3846373154598313, 'batch_size': 21, 'beta_1': 0.970085326165728, 'beta_2': 0.9827178330640274, 'epsilon': 3.536558465672918e-07, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.0005723568555770953, 'tol': 9.288563342867341e-05, 'validation_fraction': 0.13366252177485619}
observation time 0.000006, current best 0.148273 at iter 7
suggestion time taken 9.413137 iter 8 next_points [{'alpha': 0.018960122974523638, 'batch_size': 40, 'beta_1': 0.7913635627582399, 'beta_2': 0.9999981828844943, 'epsilon': 3.295882545504187e-08, 'hidden_layer_sizes': 67, 'learning_rate_init': 3.763042624298867e-05, 'tol': 5.118964592845737e-05, 'validation_fraction': 0.8186602804893313}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 2.595215 value 4.304243 suggestion {'alpha': 0.018960122974523638, 'batch_size': 40, 'beta_1': 0.7913635627582399, 'beta_2': 0.9999981828844943, 'epsilon': 3.295882545504187e-08, 'hidden_layer_sizes': 67, 'learning_rate_init': 3.763042624298867e-05, 'tol': 5.118964592845737e-05, 'validation_fraction': 0.8186602804893313}
observation time 0.000005, current best 0.148273 at iter 8
suggestion time taken 9.487606 iter 9 next_points [{'alpha': 0.02413364887083937, 'batch_size': 32, 'beta_1': 0.9872888623726448, 'beta_2': 0.9999988599378907, 'epsilon': 4.041647625824e-08, 'hidden_layer_sizes': 112, 'learning_rate_init': 0.015685369446064416, 'tol': 0.01165448309604319, 'validation_fraction': 0.7738147149542006}]
function_evaluation time 0.513040 value 0.501409 suggestion {'alpha': 0.02413364887083937, 'batch_size': 32, 'beta_1': 0.9872888623726448, 'beta_2': 0.9999988599378907, 'epsilon': 4.041647625824e-08, 'hidden_layer_sizes': 112, 'learning_rate_init': 0.015685369446064416, 'tol': 0.01165448309604319, 'validation_fraction': 0.7738147149542006}
observation time 0.000005, current best 0.148273 at iter 9
suggestion time taken 9.547367 iter 10 next_points [{'alpha': 0.000605797405904237, 'batch_size': 21, 'beta_1': 0.8614304540197287, 'beta_2': 0.9999426146950027, 'epsilon': 7.66641678726039e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.004067491752733587, 'tol': 5.333703493838315e-05, 'validation_fraction': 0.13098132556858033}]
function_evaluation time 1.578157 value 0.142835 suggestion {'alpha': 0.000605797405904237, 'batch_size': 21, 'beta_1': 0.8614304540197287, 'beta_2': 0.9999426146950027, 'epsilon': 7.66641678726039e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.004067491752733587, 'tol': 5.333703493838315e-05, 'validation_fraction': 0.13098132556858033}
observation time 0.000006, current best 0.142835 at iter 10
suggestion time taken 9.468522 iter 11 next_points [{'alpha': 0.0009780574092204063, 'batch_size': 30, 'beta_1': 0.7225263628744055, 'beta_2': 0.9992401107277911, 'epsilon': 3.9747709802589854e-09, 'hidden_layer_sizes': 184, 'learning_rate_init': 1.7838919807970622e-05, 'tol': 0.0031011605980687646, 'validation_fraction': 0.8958408088544141}]
function_evaluation time 0.300593 value 6.507305 suggestion {'alpha': 0.0009780574092204063, 'batch_size': 30, 'beta_1': 0.7225263628744055, 'beta_2': 0.9992401107277911, 'epsilon': 3.9747709802589854e-09, 'hidden_layer_sizes': 184, 'learning_rate_init': 1.7838919807970622e-05, 'tol': 0.0031011605980687646, 'validation_fraction': 0.8958408088544141}
observation time 0.000006, current best 0.142835 at iter 11
suggestion time taken 9.533190 iter 12 next_points [{'alpha': 9.404880521438711, 'batch_size': 15, 'beta_1': 0.9455322470086875, 'beta_2': 0.9941629629618908, 'epsilon': 4.216775958050641e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.0030062930501855768, 'tol': 0.002138501676291717, 'validation_fraction': 0.18089204484215177}]
function_evaluation time 1.574294 value 0.560679 suggestion {'alpha': 9.404880521438711, 'batch_size': 15, 'beta_1': 0.9455322470086875, 'beta_2': 0.9941629629618908, 'epsilon': 4.216775958050641e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.0030062930501855768, 'tol': 0.002138501676291717, 'validation_fraction': 0.18089204484215177}
observation time 0.000005, current best 0.142835 at iter 12
suggestion time taken 9.588253 iter 13 next_points [{'alpha': 6.840510199789837, 'batch_size': 13, 'beta_1': 0.9479472192710966, 'beta_2': 0.9999750844383356, 'epsilon': 1.1856286147680402e-08, 'hidden_layer_sizes': 64, 'learning_rate_init': 9.038927892708448e-05, 'tol': 0.017148806217047317, 'validation_fraction': 0.17315669476319986}]
function_evaluation time 2.854637 value 0.464188 suggestion {'alpha': 6.840510199789837, 'batch_size': 13, 'beta_1': 0.9479472192710966, 'beta_2': 0.9999750844383356, 'epsilon': 1.1856286147680402e-08, 'hidden_layer_sizes': 64, 'learning_rate_init': 9.038927892708448e-05, 'tol': 0.017148806217047317, 'validation_fraction': 0.17315669476319986}
observation time 0.000006, current best 0.142835 at iter 13
suggestion time taken 9.510193 iter 14 next_points [{'alpha': 8.041872734040261, 'batch_size': 37, 'beta_1': 0.9279781134763077, 'beta_2': 0.9997214865132026, 'epsilon': 3.7703477840077417e-07, 'hidden_layer_sizes': 176, 'learning_rate_init': 6.840877343289882e-05, 'tol': 0.0005958849608311638, 'validation_fraction': 0.7367056502623918}]
function_evaluation time 5.745180 value 0.357371 suggestion {'alpha': 8.041872734040261, 'batch_size': 37, 'beta_1': 0.9279781134763077, 'beta_2': 0.9997214865132026, 'epsilon': 3.7703477840077417e-07, 'hidden_layer_sizes': 176, 'learning_rate_init': 6.840877343289882e-05, 'tol': 0.0005958849608311638, 'validation_fraction': 0.7367056502623918}
observation time 0.000005, current best 0.142835 at iter 14
saving meta data: {'args': {'--uuid': '05af7b30e90750db9c58ffaca85a39b6', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
