running: {'--uuid': '0ee78e3fed1c5845a4a841966aea9898', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230429_190633', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u 0ee78e3fed1c5845a4a841966aea9898 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230429_190633
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study smoothness MLP-adam digits nll 15 1
with data root: None
suggestion time taken 9.515048 iter 0 next_points [{'alpha': 1.2024636270645168, 'batch_size': 13, 'beta_1': 0.748118525343041, 'beta_2': 0.9997854025360357, 'epsilon': 4.843850361577006e-09, 'hidden_layer_sizes': 148, 'learning_rate_init': 0.010626488390084166, 'tol': 0.003937218312427254, 'validation_fraction': 0.38169415981774}]
function_evaluation time 2.381660 value 0.199726 suggestion {'alpha': 1.2024636270645168, 'batch_size': 13, 'beta_1': 0.748118525343041, 'beta_2': 0.9997854025360357, 'epsilon': 4.843850361577006e-09, 'hidden_layer_sizes': 148, 'learning_rate_init': 0.010626488390084166, 'tol': 0.003937218312427254, 'validation_fraction': 0.38169415981774}
observation time 0.000006, current best 0.199726 at iter 0
suggestion time taken 9.355994 iter 1 next_points [{'alpha': 1.039315839754513, 'batch_size': 32, 'beta_1': 0.9663263047279296, 'beta_2': 0.9965241209048981, 'epsilon': 5.4614458144117584e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.0020670150018995263, 'tol': 0.00046106849627273354, 'validation_fraction': 0.5016094617601159}]
function_evaluation time 1.936156 value 0.141008 suggestion {'alpha': 1.039315839754513, 'batch_size': 32, 'beta_1': 0.9663263047279296, 'beta_2': 0.9965241209048981, 'epsilon': 5.4614458144117584e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.0020670150018995263, 'tol': 0.00046106849627273354, 'validation_fraction': 0.5016094617601159}
observation time 0.000028, current best 0.141008 at iter 1
suggestion time taken 9.340271 iter 2 next_points [{'alpha': 1.2223397534812614, 'batch_size': 21, 'beta_1': 0.5606515521697001, 'beta_2': 0.999455838728341, 'epsilon': 2.387609931307052e-07, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0015110187564125362, 'tol': 0.004424608826298509, 'validation_fraction': 0.40859605038787844}]
function_evaluation time 1.681374 value 0.158809 suggestion {'alpha': 1.2223397534812614, 'batch_size': 21, 'beta_1': 0.5606515521697001, 'beta_2': 0.999455838728341, 'epsilon': 2.387609931307052e-07, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0015110187564125362, 'tol': 0.004424608826298509, 'validation_fraction': 0.40859605038787844}
observation time 0.000006, current best 0.141008 at iter 2
suggestion time taken 9.613134 iter 3 next_points [{'alpha': 0.00010606590517928258, 'batch_size': 38, 'beta_1': 0.6847784125120278, 'beta_2': 0.987897615543094, 'epsilon': 1.3045059700775673e-07, 'hidden_layer_sizes': 57, 'learning_rate_init': 7.261071671623226e-05, 'tol': 0.0005183331950687454, 'validation_fraction': 0.7380860487542003}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 2.943827 value 6.571447 suggestion {'alpha': 0.00010606590517928258, 'batch_size': 38, 'beta_1': 0.6847784125120278, 'beta_2': 0.987897615543094, 'epsilon': 1.3045059700775673e-07, 'hidden_layer_sizes': 57, 'learning_rate_init': 7.261071671623226e-05, 'tol': 0.0005183331950687454, 'validation_fraction': 0.7380860487542003}
observation time 0.000005, current best 0.141008 at iter 3
suggestion time taken 9.433542 iter 4 next_points [{'alpha': 3.360327552602125, 'batch_size': 35, 'beta_1': 0.949552983727481, 'beta_2': 0.9999899591685462, 'epsilon': 4.1592365556422787e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.03108393395353813, 'tol': 0.00023696271617443604, 'validation_fraction': 0.7419787863269871}]
function_evaluation time 0.703000 value 0.242472 suggestion {'alpha': 3.360327552602125, 'batch_size': 35, 'beta_1': 0.949552983727481, 'beta_2': 0.9999899591685462, 'epsilon': 4.1592365556422787e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.03108393395353813, 'tol': 0.00023696271617443604, 'validation_fraction': 0.7419787863269871}
observation time 0.000006, current best 0.141008 at iter 4
suggestion time taken 9.447515 iter 5 next_points [{'alpha': 0.0013214508484670105, 'batch_size': 19, 'beta_1': 0.7915658590537359, 'beta_2': 0.999998507504718, 'epsilon': 3.8926228480074856e-08, 'hidden_layer_sizes': 83, 'learning_rate_init': 0.0007797312438771516, 'tol': 0.0018034347739581918, 'validation_fraction': 0.1327930972877043}]
function_evaluation time 2.552865 value 0.138488 suggestion {'alpha': 0.0013214508484670105, 'batch_size': 19, 'beta_1': 0.7915658590537359, 'beta_2': 0.999998507504718, 'epsilon': 3.8926228480074856e-08, 'hidden_layer_sizes': 83, 'learning_rate_init': 0.0007797312438771516, 'tol': 0.0018034347739581918, 'validation_fraction': 0.1327930972877043}
observation time 0.000006, current best 0.138488 at iter 5
suggestion time taken 9.299371 iter 6 next_points [{'alpha': 0.03555761604984448, 'batch_size': 43, 'beta_1': 0.9156770994187209, 'beta_2': 0.9996654512100381, 'epsilon': 6.557873979461977e-08, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.017141435987239804, 'tol': 0.0007709714239818502, 'validation_fraction': 0.22004781276082863}]
function_evaluation time 1.599397 value 0.103037 suggestion {'alpha': 0.03555761604984448, 'batch_size': 43, 'beta_1': 0.9156770994187209, 'beta_2': 0.9996654512100381, 'epsilon': 6.557873979461977e-08, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.017141435987239804, 'tol': 0.0007709714239818502, 'validation_fraction': 0.22004781276082863}
observation time 0.000006, current best 0.103037 at iter 6
suggestion time taken 9.332911 iter 7 next_points [{'alpha': 0.5137159459142565, 'batch_size': 21, 'beta_1': 0.9476099250547332, 'beta_2': 0.9999677842442832, 'epsilon': 2.2860455977608122e-08, 'hidden_layer_sizes': 59, 'learning_rate_init': 8.508856459791753e-05, 'tol': 0.0057194890151854244, 'validation_fraction': 0.4482717831046493}]
function_evaluation time 3.814160 value 0.387841 suggestion {'alpha': 0.5137159459142565, 'batch_size': 21, 'beta_1': 0.9476099250547332, 'beta_2': 0.9999677842442832, 'epsilon': 2.2860455977608122e-08, 'hidden_layer_sizes': 59, 'learning_rate_init': 8.508856459791753e-05, 'tol': 0.0057194890151854244, 'validation_fraction': 0.4482717831046493}
observation time 0.000005, current best 0.103037 at iter 7
suggestion time taken 9.374233 iter 8 next_points [{'alpha': 2.543229050849729, 'batch_size': 23, 'beta_1': 0.9754574232199104, 'beta_2': 0.9748898377490799, 'epsilon': 1.076245549177406e-09, 'hidden_layer_sizes': 63, 'learning_rate_init': 0.043894025998376565, 'tol': 1.0685534562767771e-05, 'validation_fraction': 0.6074036799335868}]
function_evaluation time 1.329743 value 0.246147 suggestion {'alpha': 2.543229050849729, 'batch_size': 23, 'beta_1': 0.9754574232199104, 'beta_2': 0.9748898377490799, 'epsilon': 1.076245549177406e-09, 'hidden_layer_sizes': 63, 'learning_rate_init': 0.043894025998376565, 'tol': 1.0685534562767771e-05, 'validation_fraction': 0.6074036799335868}
observation time 0.000006, current best 0.103037 at iter 8
suggestion time taken 9.291122 iter 9 next_points [{'alpha': 0.005696445530281222, 'batch_size': 27, 'beta_1': 0.9176539158642707, 'beta_2': 0.9996922260684427, 'epsilon': 1.8035461732305283e-08, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.0015799999065415676, 'tol': 0.07497902184401768, 'validation_fraction': 0.25870986228243625}]
function_evaluation time 0.759536 value 0.194865 suggestion {'alpha': 0.005696445530281222, 'batch_size': 27, 'beta_1': 0.9176539158642707, 'beta_2': 0.9996922260684427, 'epsilon': 1.8035461732305283e-08, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.0015799999065415676, 'tol': 0.07497902184401768, 'validation_fraction': 0.25870986228243625}
observation time 0.000005, current best 0.103037 at iter 9
suggestion time taken 9.283455 iter 10 next_points [{'alpha': 3.297631089366061, 'batch_size': 59, 'beta_1': 0.7861136544258954, 'beta_2': 0.9985864155542232, 'epsilon': 9.214337474361187e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.09116123696358264, 'tol': 5.65157992780312e-05, 'validation_fraction': 0.15592812841888543}]
function_evaluation time 0.711020 value 1.354455 suggestion {'alpha': 3.297631089366061, 'batch_size': 59, 'beta_1': 0.7861136544258954, 'beta_2': 0.9985864155542232, 'epsilon': 9.214337474361187e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.09116123696358264, 'tol': 5.65157992780312e-05, 'validation_fraction': 0.15592812841888543}
observation time 0.000005, current best 0.103037 at iter 10
suggestion time taken 9.381966 iter 11 next_points [{'alpha': 0.736056842477798, 'batch_size': 18, 'beta_1': 0.5154547281091801, 'beta_2': 0.9809022722555366, 'epsilon': 2.554133890395397e-08, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.00016853672399510364, 'tol': 1.6043574765569075e-05, 'validation_fraction': 0.3795164359071697}]
function_evaluation time 5.247381 value 0.143965 suggestion {'alpha': 0.736056842477798, 'batch_size': 18, 'beta_1': 0.5154547281091801, 'beta_2': 0.9809022722555366, 'epsilon': 2.554133890395397e-08, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.00016853672399510364, 'tol': 1.6043574765569075e-05, 'validation_fraction': 0.3795164359071697}
observation time 0.000005, current best 0.103037 at iter 11
suggestion time taken 9.393089 iter 12 next_points [{'alpha': 6.901051990118947e-05, 'batch_size': 37, 'beta_1': 0.955511399293698, 'beta_2': 0.912736863293652, 'epsilon': 1.8912385419138903e-09, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.000976250247544431, 'tol': 0.00038414194430581134, 'validation_fraction': 0.7310319559756797}]
function_evaluation time 1.432310 value 0.210496 suggestion {'alpha': 6.901051990118947e-05, 'batch_size': 37, 'beta_1': 0.955511399293698, 'beta_2': 0.912736863293652, 'epsilon': 1.8912385419138903e-09, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.000976250247544431, 'tol': 0.00038414194430581134, 'validation_fraction': 0.7310319559756797}
observation time 0.000006, current best 0.103037 at iter 12
suggestion time taken 9.417023 iter 13 next_points [{'alpha': 1.7565929013580794e-05, 'batch_size': 10, 'beta_1': 0.7948454263464568, 'beta_2': 0.999993474864866, 'epsilon': 3.121607418217758e-07, 'hidden_layer_sizes': 50, 'learning_rate_init': 6.446791837951484e-05, 'tol': 1.671747874579973e-05, 'validation_fraction': 0.8496120276607952}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 6.378149 value 0.727227 suggestion {'alpha': 1.7565929013580794e-05, 'batch_size': 10, 'beta_1': 0.7948454263464568, 'beta_2': 0.999993474864866, 'epsilon': 3.121607418217758e-07, 'hidden_layer_sizes': 50, 'learning_rate_init': 6.446791837951484e-05, 'tol': 1.671747874579973e-05, 'validation_fraction': 0.8496120276607952}
observation time 0.000006, current best 0.103037 at iter 13
suggestion time taken 9.455233 iter 14 next_points [{'alpha': 0.00011456894448732965, 'batch_size': 11, 'beta_1': 0.549506472235842, 'beta_2': 0.9999844581228234, 'epsilon': 2.530156754834742e-09, 'hidden_layer_sizes': 86, 'learning_rate_init': 0.0005771303322425669, 'tol': 9.421408658637457e-05, 'validation_fraction': 0.32376359326744736}]
function_evaluation time 4.593275 value 0.143029 suggestion {'alpha': 0.00011456894448732965, 'batch_size': 11, 'beta_1': 0.549506472235842, 'beta_2': 0.9999844581228234, 'epsilon': 2.530156754834742e-09, 'hidden_layer_sizes': 86, 'learning_rate_init': 0.0005771303322425669, 'tol': 9.421408658637457e-05, 'validation_fraction': 0.32376359326744736}
observation time 0.000005, current best 0.103037 at iter 14
saving meta data: {'args': {'--uuid': '0ee78e3fed1c5845a4a841966aea9898', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230429_190633', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
