running: {'--uuid': 'bdd4ed24f2bc57d98c2e727b4afa271a', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}
cmd: python random-search/optimizer.py -c MLP-adam -d digits -o random-search -u bdd4ed24f2bc57d98c2e727b4afa271a -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230430_001614
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study random-search MLP-adam digits nll 15 1
with data root: None
suggestion time taken 0.002573 iter 0 next_points [{'alpha': 0.0007472463245428494, 'batch_size': 220, 'beta_1': 0.8667178904641574, 'beta_2': 0.9689835818448501, 'epsilon': 5.894552529517728e-07, 'hidden_layer_sizes': 66, 'learning_rate_init': 2.8670282073914402e-05, 'tol': 0.00016620429189591405, 'validation_fraction': 0.1863930374267101}]
function_evaluation time 1.332472 value 7.630365 suggestion {'alpha': 0.0007472463245428494, 'batch_size': 220, 'beta_1': 0.8667178904641574, 'beta_2': 0.9689835818448501, 'epsilon': 5.894552529517728e-07, 'hidden_layer_sizes': 66, 'learning_rate_init': 2.8670282073914402e-05, 'tol': 0.00016620429189591405, 'validation_fraction': 0.1863930374267101}
observation time 0.000006, current best 7.630365 at iter 0
suggestion time taken 0.002767 iter 1 next_points [{'alpha': 0.0005730099380093793, 'batch_size': 179, 'beta_1': 0.9627188578280477, 'beta_2': 0.9999916061838943, 'epsilon': 1.3688847151474935e-07, 'hidden_layer_sizes': 95, 'learning_rate_init': 0.07137029866050047, 'tol': 0.05963951309728918, 'validation_fraction': 0.41713324195547125}]
function_evaluation time 0.255312 value 6.491559 suggestion {'alpha': 0.0005730099380093793, 'batch_size': 179, 'beta_1': 0.9627188578280477, 'beta_2': 0.9999916061838943, 'epsilon': 1.3688847151474935e-07, 'hidden_layer_sizes': 95, 'learning_rate_init': 0.07137029866050047, 'tol': 0.05963951309728918, 'validation_fraction': 0.41713324195547125}
observation time 0.000004, current best 6.491559 at iter 1
suggestion time taken 0.002512 iter 2 next_points [{'alpha': 1.5519075698676404e-05, 'batch_size': 11, 'beta_1': 0.9121124573755337, 'beta_2': 0.9954974473128815, 'epsilon': 3.2790412893703125e-09, 'hidden_layer_sizes': 189, 'learning_rate_init': 1.160059207652775e-05, 'tol': 0.0022285050627325453, 'validation_fraction': 0.23891455116926272}]
function_evaluation time 19.773000 value 0.216848 suggestion {'alpha': 1.5519075698676404e-05, 'batch_size': 11, 'beta_1': 0.9121124573755337, 'beta_2': 0.9954974473128815, 'epsilon': 3.2790412893703125e-09, 'hidden_layer_sizes': 189, 'learning_rate_init': 1.160059207652775e-05, 'tol': 0.0022285050627325453, 'validation_fraction': 0.23891455116926272}
observation time 0.000005, current best 0.216848 at iter 2
suggestion time taken 0.002501 iter 3 next_points [{'alpha': 1.9189816234709154e-05, 'batch_size': 192, 'beta_1': 0.8580784864864879, 'beta_2': 0.935729137546245, 'epsilon': 3.613271062060328e-09, 'hidden_layer_sizes': 81, 'learning_rate_init': 0.029548560860359264, 'tol': 0.0007014362089476272, 'validation_fraction': 0.7273971837924491}]
function_evaluation time 0.647780 value 0.368832 suggestion {'alpha': 1.9189816234709154e-05, 'batch_size': 192, 'beta_1': 0.8580784864864879, 'beta_2': 0.935729137546245, 'epsilon': 3.613271062060328e-09, 'hidden_layer_sizes': 81, 'learning_rate_init': 0.029548560860359264, 'tol': 0.0007014362089476272, 'validation_fraction': 0.7273971837924491}
observation time 0.000004, current best 0.216848 at iter 3
suggestion time taken 0.002456 iter 4 next_points [{'alpha': 9.011292592579832, 'batch_size': 237, 'beta_1': 0.9709405371241142, 'beta_2': 0.998326294630854, 'epsilon': 4.3781305330953653e-07, 'hidden_layer_sizes': 101, 'learning_rate_init': 0.0026031349389775867, 'tol': 0.0013291193316219221, 'validation_fraction': 0.6142312868086542}]
function_evaluation time 0.929117 value 0.247580 suggestion {'alpha': 9.011292592579832, 'batch_size': 237, 'beta_1': 0.9709405371241142, 'beta_2': 0.998326294630854, 'epsilon': 4.3781305330953653e-07, 'hidden_layer_sizes': 101, 'learning_rate_init': 0.0026031349389775867, 'tol': 0.0013291193316219221, 'validation_fraction': 0.6142312868086542}
observation time 0.000004, current best 0.216848 at iter 4
suggestion time taken 0.002772 iter 5 next_points [{'alpha': 0.06709980231070126, 'batch_size': 201, 'beta_1': 0.7883909405834695, 'beta_2': 0.998674469407375, 'epsilon': 6.146816499929874e-09, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.010172495684853351, 'tol': 0.00011407790587091521, 'validation_fraction': 0.10319573128184932}]
function_evaluation time 0.789367 value 0.121304 suggestion {'alpha': 0.06709980231070126, 'batch_size': 201, 'beta_1': 0.7883909405834695, 'beta_2': 0.998674469407375, 'epsilon': 6.146816499929874e-09, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.010172495684853351, 'tol': 0.00011407790587091521, 'validation_fraction': 0.10319573128184932}
observation time 0.000005, current best 0.121304 at iter 5
suggestion time taken 0.002434 iter 6 next_points [{'alpha': 0.03189856789486996, 'batch_size': 161, 'beta_1': 0.9505984514485384, 'beta_2': 0.9997968852298893, 'epsilon': 2.499745826343662e-08, 'hidden_layer_sizes': 145, 'learning_rate_init': 0.04368984522914126, 'tol': 0.00025180199287756967, 'validation_fraction': 0.1053446893024231}]
function_evaluation time 1.757807 value 0.331193 suggestion {'alpha': 0.03189856789486996, 'batch_size': 161, 'beta_1': 0.9505984514485384, 'beta_2': 0.9997968852298893, 'epsilon': 2.499745826343662e-08, 'hidden_layer_sizes': 145, 'learning_rate_init': 0.04368984522914126, 'tol': 0.00025180199287756967, 'validation_fraction': 0.1053446893024231}
observation time 0.000004, current best 0.121304 at iter 6
suggestion time taken 0.002713 iter 7 next_points [{'alpha': 0.00044062895118272344, 'batch_size': 150, 'beta_1': 0.9342055280771828, 'beta_2': 0.9999978752405625, 'epsilon': 2.7354588489140007e-08, 'hidden_layer_sizes': 196, 'learning_rate_init': 0.03519270073397717, 'tol': 1.3089494571217824e-05, 'validation_fraction': 0.27515749655520005}]
function_evaluation time 1.034309 value 0.205956 suggestion {'alpha': 0.00044062895118272344, 'batch_size': 150, 'beta_1': 0.9342055280771828, 'beta_2': 0.9999978752405625, 'epsilon': 2.7354588489140007e-08, 'hidden_layer_sizes': 196, 'learning_rate_init': 0.03519270073397717, 'tol': 1.3089494571217824e-05, 'validation_fraction': 0.27515749655520005}
observation time 0.000005, current best 0.121304 at iter 7
suggestion time taken 0.002443 iter 8 next_points [{'alpha': 0.0022765165751905867, 'batch_size': 40, 'beta_1': 0.9105909543466306, 'beta_2': 0.9445402944349441, 'epsilon': 1.6725918672896343e-07, 'hidden_layer_sizes': 150, 'learning_rate_init': 0.006285693449502268, 'tol': 0.00021690904344841774, 'validation_fraction': 0.5407218952540044}]
function_evaluation time 1.313141 value 0.151890 suggestion {'alpha': 0.0022765165751905867, 'batch_size': 40, 'beta_1': 0.9105909543466306, 'beta_2': 0.9445402944349441, 'epsilon': 1.6725918672896343e-07, 'hidden_layer_sizes': 150, 'learning_rate_init': 0.006285693449502268, 'tol': 0.00021690904344841774, 'validation_fraction': 0.5407218952540044}
observation time 0.000004, current best 0.121304 at iter 8
suggestion time taken 0.002470 iter 9 next_points [{'alpha': 0.0016611757702431763, 'batch_size': 110, 'beta_1': 0.8837435382548556, 'beta_2': 0.9999174580379687, 'epsilon': 5.116140821867563e-08, 'hidden_layer_sizes': 109, 'learning_rate_init': 0.09117372661833266, 'tol': 0.002415463740593114, 'validation_fraction': 0.14932749820902483}]
function_evaluation time 1.046414 value 1.588734 suggestion {'alpha': 0.0016611757702431763, 'batch_size': 110, 'beta_1': 0.8837435382548556, 'beta_2': 0.9999174580379687, 'epsilon': 5.116140821867563e-08, 'hidden_layer_sizes': 109, 'learning_rate_init': 0.09117372661833266, 'tol': 0.002415463740593114, 'validation_fraction': 0.14932749820902483}
observation time 0.000004, current best 0.121304 at iter 9
suggestion time taken 0.002403 iter 10 next_points [{'alpha': 0.002631512708197272, 'batch_size': 135, 'beta_1': 0.9830597080357815, 'beta_2': 0.9835990250090104, 'epsilon': 1.37712440693297e-09, 'hidden_layer_sizes': 101, 'learning_rate_init': 0.0014078582371413115, 'tol': 0.041470496319917324, 'validation_fraction': 0.43381917595102437}]
function_evaluation time 0.448700 value 0.323912 suggestion {'alpha': 0.002631512708197272, 'batch_size': 135, 'beta_1': 0.9830597080357815, 'beta_2': 0.9835990250090104, 'epsilon': 1.37712440693297e-09, 'hidden_layer_sizes': 101, 'learning_rate_init': 0.0014078582371413115, 'tol': 0.041470496319917324, 'validation_fraction': 0.43381917595102437}
observation time 0.000005, current best 0.121304 at iter 10
suggestion time taken 0.002506 iter 11 next_points [{'alpha': 9.08949458158618e-05, 'batch_size': 123, 'beta_1': 0.900729362365319, 'beta_2': 0.9260994467760123, 'epsilon': 1.5005315613895957e-09, 'hidden_layer_sizes': 194, 'learning_rate_init': 5.335675944364297e-05, 'tol': 0.024654418943657393, 'validation_fraction': 0.1276295190119677}]
function_evaluation time 1.804745 value 0.512171 suggestion {'alpha': 9.08949458158618e-05, 'batch_size': 123, 'beta_1': 0.900729362365319, 'beta_2': 0.9260994467760123, 'epsilon': 1.5005315613895957e-09, 'hidden_layer_sizes': 194, 'learning_rate_init': 5.335675944364297e-05, 'tol': 0.024654418943657393, 'validation_fraction': 0.1276295190119677}
observation time 0.000004, current best 0.121304 at iter 11
suggestion time taken 0.002801 iter 12 next_points [{'alpha': 1.5114916292666718, 'batch_size': 23, 'beta_1': 0.8265565747042741, 'beta_2': 0.9917477644917444, 'epsilon': 1.036549482233435e-07, 'hidden_layer_sizes': 123, 'learning_rate_init': 0.07897653959033515, 'tol': 2.608219244161653e-05, 'validation_fraction': 0.44770293835972647}]
function_evaluation time 1.130340 value 1.172878 suggestion {'alpha': 1.5114916292666718, 'batch_size': 23, 'beta_1': 0.8265565747042741, 'beta_2': 0.9917477644917444, 'epsilon': 1.036549482233435e-07, 'hidden_layer_sizes': 123, 'learning_rate_init': 0.07897653959033515, 'tol': 2.608219244161653e-05, 'validation_fraction': 0.44770293835972647}
observation time 0.000005, current best 0.121304 at iter 12
suggestion time taken 0.002460 iter 13 next_points [{'alpha': 0.0002880166407113757, 'batch_size': 103, 'beta_1': 0.9729234484868404, 'beta_2': 0.9999697766886959, 'epsilon': 5.309207111374131e-08, 'hidden_layer_sizes': 103, 'learning_rate_init': 0.00011103248320967006, 'tol': 0.005905297610451005, 'validation_fraction': 0.8390984200013099}]
function_evaluation time 0.775121 value 5.486992 suggestion {'alpha': 0.0002880166407113757, 'batch_size': 103, 'beta_1': 0.9729234484868404, 'beta_2': 0.9999697766886959, 'epsilon': 5.309207111374131e-08, 'hidden_layer_sizes': 103, 'learning_rate_init': 0.00011103248320967006, 'tol': 0.005905297610451005, 'validation_fraction': 0.8390984200013099}
observation time 0.000004, current best 0.121304 at iter 13
suggestion time taken 0.002461 iter 14 next_points [{'alpha': 0.602069333581769, 'batch_size': 71, 'beta_1': 0.6104924287512168, 'beta_2': 0.9999984644929717, 'epsilon': 2.1059630926933045e-08, 'hidden_layer_sizes': 170, 'learning_rate_init': 0.00010480473841690647, 'tol': 0.001166541372173004, 'validation_fraction': 0.8719501956391604}]
function_evaluation time 3.113297 value 0.707518 suggestion {'alpha': 0.602069333581769, 'batch_size': 71, 'beta_1': 0.6104924287512168, 'beta_2': 0.9999984644929717, 'epsilon': 2.1059630926933045e-08, 'hidden_layer_sizes': 170, 'learning_rate_init': 0.00010480473841690647, 'tol': 0.001166541372173004, 'validation_fraction': 0.8719501956391604}
observation time 0.000004, current best 0.121304 at iter 14
saving meta data: {'args': {'--uuid': 'bdd4ed24f2bc57d98c2e727b4afa271a', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_001614', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
