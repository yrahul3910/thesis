running: {'--uuid': '7390b87739275218bda5d9ab81efc16a', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_194925', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d wine -o smoothness -u 7390b87739275218bda5d9ab81efc16a -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230430_194925
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_wine_nll betwen [15.51998549 22.35390307 19.16402613  3.37792524 14.64310022] and [16.06396227 23.27425025 19.80193088  3.46391821 15.2105797 ]
  warnings.warn(

Signature errors:
                          0         1         2         3         4       max
MLP-adam_wine_nll  0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
max                0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
starting sklearn study smoothness MLP-adam wine nll 15 1
with data root: None
suggestion time taken 9.436965 iter 0 next_points [{'alpha': 5.610249714652987e-05, 'batch_size': 42, 'beta_1': 0.5963531006251469, 'beta_2': 0.9706421306120528, 'epsilon': 2.0332543138938296e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.0060134252723187094, 'tol': 0.016200843464039733, 'validation_fraction': 0.14214615422156676}]
function_evaluation time 0.147711 value 1.352972 suggestion {'alpha': 5.610249714652987e-05, 'batch_size': 42, 'beta_1': 0.5963531006251469, 'beta_2': 0.9706421306120528, 'epsilon': 2.0332543138938296e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.0060134252723187094, 'tol': 0.016200843464039733, 'validation_fraction': 0.14214615422156676}
observation time 0.000006, current best 1.352972 at iter 0
suggestion time taken 9.323891 iter 1 next_points [{'alpha': 0.00023309552019197647, 'batch_size': 28, 'beta_1': 0.8698285246591102, 'beta_2': 0.9998010831260509, 'epsilon': 3.5268283782860387e-07, 'hidden_layer_sizes': 50, 'learning_rate_init': 1.6458543758104648e-05, 'tol': 5.53741744121409e-05, 'validation_fraction': 0.6052656749891296}]
function_evaluation time 0.053585 value 23.512141 suggestion {'alpha': 0.00023309552019197647, 'batch_size': 28, 'beta_1': 0.8698285246591102, 'beta_2': 0.9998010831260509, 'epsilon': 3.5268283782860387e-07, 'hidden_layer_sizes': 50, 'learning_rate_init': 1.6458543758104648e-05, 'tol': 5.53741744121409e-05, 'validation_fraction': 0.6052656749891296}
observation time 0.000006, current best 1.352972 at iter 1
suggestion time taken 9.329666 iter 2 next_points [{'alpha': 0.004849844208950232, 'batch_size': 17, 'beta_1': 0.9756145981283696, 'beta_2': 0.9767639424533401, 'epsilon': 8.186262782116061e-09, 'hidden_layer_sizes': 121, 'learning_rate_init': 3.286632139300016e-05, 'tol': 1.494849774419774e-05, 'validation_fraction': 0.8224884693362604}]
function_evaluation time 0.059543 value 22.894910 suggestion {'alpha': 0.004849844208950232, 'batch_size': 17, 'beta_1': 0.9756145981283696, 'beta_2': 0.9767639424533401, 'epsilon': 8.186262782116061e-09, 'hidden_layer_sizes': 121, 'learning_rate_init': 3.286632139300016e-05, 'tol': 1.494849774419774e-05, 'validation_fraction': 0.8224884693362604}
observation time 0.000006, current best 1.352972 at iter 2
suggestion time taken 9.503326 iter 3 next_points [{'alpha': 0.006611630784113521, 'batch_size': 19, 'beta_1': 0.9516936892206312, 'beta_2': 0.9999971937046436, 'epsilon': 4.264784353041341e-09, 'hidden_layer_sizes': 114, 'learning_rate_init': 0.01723267927861061, 'tol': 8.575108047882055e-05, 'validation_fraction': 0.30632379482467625}]
function_evaluation time 0.210886 value 1.143692 suggestion {'alpha': 0.006611630784113521, 'batch_size': 19, 'beta_1': 0.9516936892206312, 'beta_2': 0.9999971937046436, 'epsilon': 4.264784353041341e-09, 'hidden_layer_sizes': 114, 'learning_rate_init': 0.01723267927861061, 'tol': 8.575108047882055e-05, 'validation_fraction': 0.30632379482467625}
observation time 0.000006, current best 1.143692 at iter 3
suggestion time taken 9.315055 iter 4 next_points [{'alpha': 0.8732089962553946, 'batch_size': 24, 'beta_1': 0.9578782528997821, 'beta_2': 0.9998424426106567, 'epsilon': 1.096156153753864e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 9.821900348537581e-05, 'tol': 0.0001208818427270454, 'validation_fraction': 0.8055715951781113}]
function_evaluation time 0.047683 value 23.225548 suggestion {'alpha': 0.8732089962553946, 'batch_size': 24, 'beta_1': 0.9578782528997821, 'beta_2': 0.9998424426106567, 'epsilon': 1.096156153753864e-09, 'hidden_layer_sizes': 66, 'learning_rate_init': 9.821900348537581e-05, 'tol': 0.0001208818427270454, 'validation_fraction': 0.8055715951781113}
observation time 0.000006, current best 1.143692 at iter 4
suggestion time taken 9.341060 iter 5 next_points [{'alpha': 0.28546644161423085, 'batch_size': 12, 'beta_1': 0.8946154913884778, 'beta_2': 0.9999566966634796, 'epsilon': 2.0371538881078276e-09, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.007168910943422095, 'tol': 4.76861313794527e-05, 'validation_fraction': 0.16910100360074137}]
function_evaluation time 0.202082 value 0.765670 suggestion {'alpha': 0.28546644161423085, 'batch_size': 12, 'beta_1': 0.8946154913884778, 'beta_2': 0.9999566966634796, 'epsilon': 2.0371538881078276e-09, 'hidden_layer_sizes': 89, 'learning_rate_init': 0.007168910943422095, 'tol': 4.76861313794527e-05, 'validation_fraction': 0.16910100360074137}
observation time 0.000005, current best 0.765670 at iter 5
suggestion time taken 9.320351 iter 6 next_points [{'alpha': 2.659504657816678e-05, 'batch_size': 23, 'beta_1': 0.9632087055460345, 'beta_2': 0.9999925041949329, 'epsilon': 3.381885223254908e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.00019467445730050572, 'tol': 0.0004781989241934883, 'validation_fraction': 0.8257195313998661}]
function_evaluation time 0.055429 value 16.136709 suggestion {'alpha': 2.659504657816678e-05, 'batch_size': 23, 'beta_1': 0.9632087055460345, 'beta_2': 0.9999925041949329, 'epsilon': 3.381885223254908e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.00019467445730050572, 'tol': 0.0004781989241934883, 'validation_fraction': 0.8257195313998661}
observation time 0.000005, current best 0.765670 at iter 6
suggestion time taken 9.278024 iter 7 next_points [{'alpha': 1.0211135458506686, 'batch_size': 29, 'beta_1': 0.9736530060178923, 'beta_2': 0.9962092557386152, 'epsilon': 6.636783949504701e-07, 'hidden_layer_sizes': 99, 'learning_rate_init': 0.018187427608478825, 'tol': 2.3880185874342432e-05, 'validation_fraction': 0.8458107156728866}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.094817 value 9.020028 suggestion {'alpha': 1.0211135458506686, 'batch_size': 29, 'beta_1': 0.9736530060178923, 'beta_2': 0.9962092557386152, 'epsilon': 6.636783949504701e-07, 'hidden_layer_sizes': 99, 'learning_rate_init': 0.018187427608478825, 'tol': 2.3880185874342432e-05, 'validation_fraction': 0.8458107156728866}
observation time 0.000006, current best 0.765670 at iter 7
suggestion time taken 9.242439 iter 8 next_points [{'alpha': 0.007785614127358372, 'batch_size': 25, 'beta_1': 0.9640795280749007, 'beta_2': 0.9999912991287764, 'epsilon': 1.4763499062847984e-07, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.00015735347391810587, 'tol': 0.0011037459419777887, 'validation_fraction': 0.12476469208701621}]
function_evaluation time 0.107194 value 15.134264 suggestion {'alpha': 0.007785614127358372, 'batch_size': 25, 'beta_1': 0.9640795280749007, 'beta_2': 0.9999912991287764, 'epsilon': 1.4763499062847984e-07, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.00015735347391810587, 'tol': 0.0011037459419777887, 'validation_fraction': 0.12476469208701621}
observation time 0.000006, current best 0.765670 at iter 8
suggestion time taken 9.268378 iter 9 next_points [{'alpha': 0.10208422962023207, 'batch_size': 18, 'beta_1': 0.7189328859837529, 'beta_2': 0.9999958477384914, 'epsilon': 1.7590553739908116e-07, 'hidden_layer_sizes': 154, 'learning_rate_init': 0.012990939221207424, 'tol': 0.0005027310287078361, 'validation_fraction': 0.7195269402958121}]
function_evaluation time 0.160073 value 2.865875 suggestion {'alpha': 0.10208422962023207, 'batch_size': 18, 'beta_1': 0.7189328859837529, 'beta_2': 0.9999958477384914, 'epsilon': 1.7590553739908116e-07, 'hidden_layer_sizes': 154, 'learning_rate_init': 0.012990939221207424, 'tol': 0.0005027310287078361, 'validation_fraction': 0.7195269402958121}
observation time 0.000006, current best 0.765670 at iter 9
suggestion time taken 9.299105 iter 10 next_points [{'alpha': 0.00011017138412875096, 'batch_size': 16, 'beta_1': 0.9879544420819146, 'beta_2': 0.99995319990882, 'epsilon': 3.90645441304121e-08, 'hidden_layer_sizes': 58, 'learning_rate_init': 0.00015016938084175488, 'tol': 3.140907228454684e-05, 'validation_fraction': 0.543897216926613}]
function_evaluation time 0.102253 value 18.740169 suggestion {'alpha': 0.00011017138412875096, 'batch_size': 16, 'beta_1': 0.9879544420819146, 'beta_2': 0.99995319990882, 'epsilon': 3.90645441304121e-08, 'hidden_layer_sizes': 58, 'learning_rate_init': 0.00015016938084175488, 'tol': 3.140907228454684e-05, 'validation_fraction': 0.543897216926613}
observation time 0.000006, current best 0.765670 at iter 10
suggestion time taken 9.305844 iter 11 next_points [{'alpha': 4.418140201725566, 'batch_size': 29, 'beta_1': 0.6514655100786604, 'beta_2': 0.9999976877273922, 'epsilon': 9.958854988084084e-07, 'hidden_layer_sizes': 136, 'learning_rate_init': 0.0017761919135176657, 'tol': 0.07005006678550954, 'validation_fraction': 0.20849931936999505}]
function_evaluation time 0.132390 value 1.900864 suggestion {'alpha': 4.418140201725566, 'batch_size': 29, 'beta_1': 0.6514655100786604, 'beta_2': 0.9999976877273922, 'epsilon': 9.958854988084084e-07, 'hidden_layer_sizes': 136, 'learning_rate_init': 0.0017761919135176657, 'tol': 0.07005006678550954, 'validation_fraction': 0.20849931936999505}
observation time 0.000006, current best 0.765670 at iter 11
suggestion time taken 9.324118 iter 12 next_points [{'alpha': 0.0013430525044923623, 'batch_size': 23, 'beta_1': 0.989480785304378, 'beta_2': 0.9999546208932869, 'epsilon': 1.118165211236927e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 3.707681964848631e-05, 'tol': 6.696888204776213e-05, 'validation_fraction': 0.7057480185169455}]
function_evaluation time 0.054481 value 22.227503 suggestion {'alpha': 0.0013430525044923623, 'batch_size': 23, 'beta_1': 0.989480785304378, 'beta_2': 0.9999546208932869, 'epsilon': 1.118165211236927e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 3.707681964848631e-05, 'tol': 6.696888204776213e-05, 'validation_fraction': 0.7057480185169455}
observation time 0.000006, current best 0.765670 at iter 12
suggestion time taken 9.310492 iter 13 next_points [{'alpha': 0.03414014948783317, 'batch_size': 35, 'beta_1': 0.7230872662960911, 'beta_2': 0.9918978731941384, 'epsilon': 2.027209147266198e-09, 'hidden_layer_sizes': 86, 'learning_rate_init': 0.029057566214854242, 'tol': 0.05071800400781359, 'validation_fraction': 0.7047851748186805}]
function_evaluation time 0.079956 value 6.509890 suggestion {'alpha': 0.03414014948783317, 'batch_size': 35, 'beta_1': 0.7230872662960911, 'beta_2': 0.9918978731941384, 'epsilon': 2.027209147266198e-09, 'hidden_layer_sizes': 86, 'learning_rate_init': 0.029057566214854242, 'tol': 0.05071800400781359, 'validation_fraction': 0.7047851748186805}
observation time 0.000006, current best 0.765670 at iter 13
suggestion time taken 9.304619 iter 14 next_points [{'alpha': 0.04166901301639058, 'batch_size': 23, 'beta_1': 0.8647789662199438, 'beta_2': 0.9995852789743741, 'epsilon': 6.919593547016658e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.010516595363375085, 'tol': 4.6272695029561736e-05, 'validation_fraction': 0.8170542600499067}]
function_evaluation time 0.108777 value 4.536351 suggestion {'alpha': 0.04166901301639058, 'batch_size': 23, 'beta_1': 0.8647789662199438, 'beta_2': 0.9995852789743741, 'epsilon': 6.919593547016658e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.010516595363375085, 'tol': 4.6272695029561736e-05, 'validation_fraction': 0.8170542600499067}
observation time 0.000006, current best 0.765670 at iter 14
saving meta data: {'args': {'--uuid': '7390b87739275218bda5d9ab81efc16a', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230430_194925', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])}
saving results
saving timing
saving suggest log
done
