running: {'--uuid': 'd035afe0dd015693b2fab3c984cb2cea', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230422_030001', '--opt': 'smoothness', '--data': 'breast', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d breast -o smoothness -u d035afe0dd015693b2fab3c984cb2cea -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230422_030001
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [8.104566516477803, 14.643876498263253, 12.332285721418042, 5.2697835894868685, 3.490431081639362])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_breast_nll betwen [ 4.58589285 14.6438765   8.74044796  0.67466158  3.06872636] and [ 8.10456652 20.07092365 12.33228572  5.26978359  3.49043108]
  warnings.warn(

Signature errors:
                            0         1         2         3         4       max
MLP-adam_breast_nll  3.518674  5.427047  3.591838  4.595122  0.421705  5.427047
max                  3.518674  5.427047  3.591838  4.595122  0.421705  5.427047
starting sklearn study smoothness MLP-adam breast nll 15 1
with data root: None
suggestion time taken 11.231160 iter 0 next_points [{'alpha': 0.023055279997989002, 'batch_size': 15, 'beta_1': 0.9842844449729984, 'beta_2': 0.9763733031396589, 'epsilon': 3.5074680985119284e-09, 'hidden_layer_sizes': 190, 'learning_rate_init': 0.00029176607296656627, 'tol': 0.00022921202694959795, 'validation_fraction': 0.4332012904440518}]
function_evaluation time 0.779035 value 0.529778 suggestion {'alpha': 0.023055279997989002, 'batch_size': 15, 'beta_1': 0.9842844449729984, 'beta_2': 0.9763733031396589, 'epsilon': 3.5074680985119284e-09, 'hidden_layer_sizes': 190, 'learning_rate_init': 0.00029176607296656627, 'tol': 0.00022921202694959795, 'validation_fraction': 0.4332012904440518}
observation time 0.000006, current best 0.529778 at iter 0
suggestion time taken 11.376666 iter 1 next_points [{'alpha': 2.7174766250149835e-05, 'batch_size': 18, 'beta_1': 0.6978332131997251, 'beta_2': 0.9999942918386646, 'epsilon': 2.400023583383672e-08, 'hidden_layer_sizes': 50, 'learning_rate_init': 0.00022383312416808198, 'tol': 0.00037073480799225313, 'validation_fraction': 0.7026285164557923}]
function_evaluation time 0.463479 value 5.437141 suggestion {'alpha': 2.7174766250149835e-05, 'batch_size': 18, 'beta_1': 0.6978332131997251, 'beta_2': 0.9999942918386646, 'epsilon': 2.400023583383672e-08, 'hidden_layer_sizes': 50, 'learning_rate_init': 0.00022383312416808198, 'tol': 0.00037073480799225313, 'validation_fraction': 0.7026285164557923}
observation time 0.000006, current best 0.529778 at iter 1
suggestion time taken 10.962530 iter 2 next_points [{'alpha': 0.2195021654564656, 'batch_size': 20, 'beta_1': 0.9475550564971263, 'beta_2': 0.9930350223990166, 'epsilon': 1.0475621203010915e-08, 'hidden_layer_sizes': 152, 'learning_rate_init': 0.08881090085999202, 'tol': 0.0057039335517442575, 'validation_fraction': 0.2898255198870671}]
function_evaluation time 0.457165 value 0.628060 suggestion {'alpha': 0.2195021654564656, 'batch_size': 20, 'beta_1': 0.9475550564971263, 'beta_2': 0.9930350223990166, 'epsilon': 1.0475621203010915e-08, 'hidden_layer_sizes': 152, 'learning_rate_init': 0.08881090085999202, 'tol': 0.0057039335517442575, 'validation_fraction': 0.2898255198870671}
observation time 0.000006, current best 0.529778 at iter 2
suggestion time taken 11.190716 iter 3 next_points [{'alpha': 1.8013163740129815e-05, 'batch_size': 47, 'beta_1': 0.9892203806568388, 'beta_2': 0.9988794936769276, 'epsilon': 3.573665343336519e-07, 'hidden_layer_sizes': 107, 'learning_rate_init': 0.07844092417659647, 'tol': 0.05758615185147451, 'validation_fraction': 0.5988772722491513}]
function_evaluation time 0.184797 value 0.491167 suggestion {'alpha': 1.8013163740129815e-05, 'batch_size': 47, 'beta_1': 0.9892203806568388, 'beta_2': 0.9988794936769276, 'epsilon': 3.573665343336519e-07, 'hidden_layer_sizes': 107, 'learning_rate_init': 0.07844092417659647, 'tol': 0.05758615185147451, 'validation_fraction': 0.5988772722491513}
observation time 0.000006, current best 0.491167 at iter 3
suggestion time taken 10.962124 iter 4 next_points [{'alpha': 0.00015473445530792077, 'batch_size': 12, 'beta_1': 0.9149381199799257, 'beta_2': 0.9997634973063603, 'epsilon': 1.1752591367312023e-09, 'hidden_layer_sizes': 156, 'learning_rate_init': 0.00043109993103612363, 'tol': 0.015594982666298723, 'validation_fraction': 0.3705262894129928}]
function_evaluation time 0.582960 value 0.323743 suggestion {'alpha': 0.00015473445530792077, 'batch_size': 12, 'beta_1': 0.9149381199799257, 'beta_2': 0.9997634973063603, 'epsilon': 1.1752591367312023e-09, 'hidden_layer_sizes': 156, 'learning_rate_init': 0.00043109993103612363, 'tol': 0.015594982666298723, 'validation_fraction': 0.3705262894129928}
observation time 0.000005, current best 0.323743 at iter 4
suggestion time taken 11.051392 iter 5 next_points [{'alpha': 0.0003188154104413061, 'batch_size': 106, 'beta_1': 0.7401139921412283, 'beta_2': 0.9711973384792227, 'epsilon': 2.840194413987315e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.0007288302343372185, 'tol': 0.004821853745819842, 'validation_fraction': 0.23734355602267093}]
function_evaluation time 0.256133 value 0.474187 suggestion {'alpha': 0.0003188154104413061, 'batch_size': 106, 'beta_1': 0.7401139921412283, 'beta_2': 0.9711973384792227, 'epsilon': 2.840194413987315e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.0007288302343372185, 'tol': 0.004821853745819842, 'validation_fraction': 0.23734355602267093}
observation time 0.000005, current best 0.323743 at iter 5
suggestion time taken 11.083421 iter 6 next_points [{'alpha': 0.022777808296347915, 'batch_size': 14, 'beta_1': 0.9262952620803349, 'beta_2': 0.9999641942716083, 'epsilon': 2.8990443997974033e-07, 'hidden_layer_sizes': 84, 'learning_rate_init': 6.0838001082280054e-05, 'tol': 0.026500499944376036, 'validation_fraction': 0.269231058706541}]
function_evaluation time 0.453156 value 7.427119 suggestion {'alpha': 0.022777808296347915, 'batch_size': 14, 'beta_1': 0.9262952620803349, 'beta_2': 0.9999641942716083, 'epsilon': 2.8990443997974033e-07, 'hidden_layer_sizes': 84, 'learning_rate_init': 6.0838001082280054e-05, 'tol': 0.026500499944376036, 'validation_fraction': 0.269231058706541}
observation time 0.000006, current best 0.323743 at iter 6
suggestion time taken 11.207722 iter 7 next_points [{'alpha': 6.058855933800857, 'batch_size': 33, 'beta_1': 0.6006150170129594, 'beta_2': 0.9999923705420498, 'epsilon': 8.333968796037102e-08, 'hidden_layer_sizes': 67, 'learning_rate_init': 5.352206181804189e-05, 'tol': 0.0026073113957108267, 'validation_fraction': 0.44482202719657304}]
function_evaluation time 0.467929 value 7.829466 suggestion {'alpha': 6.058855933800857, 'batch_size': 33, 'beta_1': 0.6006150170129594, 'beta_2': 0.9999923705420498, 'epsilon': 8.333968796037102e-08, 'hidden_layer_sizes': 67, 'learning_rate_init': 5.352206181804189e-05, 'tol': 0.0026073113957108267, 'validation_fraction': 0.44482202719657304}
observation time 0.000005, current best 0.323743 at iter 7
suggestion time taken 10.836048 iter 8 next_points [{'alpha': 6.682897495191111, 'batch_size': 27, 'beta_1': 0.8878895767165446, 'beta_2': 0.9999965626663877, 'epsilon': 6.708578072241081e-08, 'hidden_layer_sizes': 136, 'learning_rate_init': 0.005095624235573501, 'tol': 0.0004500793711332393, 'validation_fraction': 0.19229647442937328}]
function_evaluation time 0.462364 value 0.565658 suggestion {'alpha': 6.682897495191111, 'batch_size': 27, 'beta_1': 0.8878895767165446, 'beta_2': 0.9999965626663877, 'epsilon': 6.708578072241081e-08, 'hidden_layer_sizes': 136, 'learning_rate_init': 0.005095624235573501, 'tol': 0.0004500793711332393, 'validation_fraction': 0.19229647442937328}
observation time 0.000005, current best 0.323743 at iter 8
suggestion time taken 10.878426 iter 9 next_points [{'alpha': 2.5236264437593882e-05, 'batch_size': 28, 'beta_1': 0.9808613665142839, 'beta_2': 0.9999889173288966, 'epsilon': 2.480729902481881e-08, 'hidden_layer_sizes': 143, 'learning_rate_init': 0.08092156223816223, 'tol': 3.420281384974589e-05, 'validation_fraction': 0.6365708332616459}]
function_evaluation time 0.366108 value 2.984276 suggestion {'alpha': 2.5236264437593882e-05, 'batch_size': 28, 'beta_1': 0.9808613665142839, 'beta_2': 0.9999889173288966, 'epsilon': 2.480729902481881e-08, 'hidden_layer_sizes': 143, 'learning_rate_init': 0.08092156223816223, 'tol': 3.420281384974589e-05, 'validation_fraction': 0.6365708332616459}
observation time 0.000004, current best 0.323743 at iter 9
suggestion time taken 11.190559 iter 10 next_points [{'alpha': 2.4826916677431067e-05, 'batch_size': 13, 'beta_1': 0.8412090242351415, 'beta_2': 0.9683016207287779, 'epsilon': 1.0332446616425813e-07, 'hidden_layer_sizes': 81, 'learning_rate_init': 0.0002871079315707431, 'tol': 1.7740071008442507e-05, 'validation_fraction': 0.8707616472728583}]
function_evaluation time 0.343011 value 5.721107 suggestion {'alpha': 2.4826916677431067e-05, 'batch_size': 13, 'beta_1': 0.8412090242351415, 'beta_2': 0.9683016207287779, 'epsilon': 1.0332446616425813e-07, 'hidden_layer_sizes': 81, 'learning_rate_init': 0.0002871079315707431, 'tol': 1.7740071008442507e-05, 'validation_fraction': 0.8707616472728583}
observation time 0.000005, current best 0.323743 at iter 10
suggestion time taken 10.892773 iter 11 next_points [{'alpha': 0.0009772928302132396, 'batch_size': 19, 'beta_1': 0.8541973690175068, 'beta_2': 0.9912907140474518, 'epsilon': 1.1163219328611702e-08, 'hidden_layer_sizes': 112, 'learning_rate_init': 0.0007238709022144311, 'tol': 1.5544798754544104e-05, 'validation_fraction': 0.12191358643499152}]
function_evaluation time 0.471668 value 0.309677 suggestion {'alpha': 0.0009772928302132396, 'batch_size': 19, 'beta_1': 0.8541973690175068, 'beta_2': 0.9912907140474518, 'epsilon': 1.1163219328611702e-08, 'hidden_layer_sizes': 112, 'learning_rate_init': 0.0007238709022144311, 'tol': 1.5544798754544104e-05, 'validation_fraction': 0.12191358643499152}
observation time 0.000006, current best 0.309677 at iter 11
suggestion time taken 11.006837 iter 12 next_points [{'alpha': 0.731439380759961, 'batch_size': 49, 'beta_1': 0.9059284746690269, 'beta_2': 0.9999989386529586, 'epsilon': 3.7679617091830957e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 4.385093277922332e-05, 'tol': 0.0018736408463472156, 'validation_fraction': 0.77966208183347}]
function_evaluation time 0.257567 value 14.470893 suggestion {'alpha': 0.731439380759961, 'batch_size': 49, 'beta_1': 0.9059284746690269, 'beta_2': 0.9999989386529586, 'epsilon': 3.7679617091830957e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 4.385093277922332e-05, 'tol': 0.0018736408463472156, 'validation_fraction': 0.77966208183347}
observation time 0.000005, current best 0.309677 at iter 12
suggestion time taken 11.328281 iter 13 next_points [{'alpha': 2.409794444373252e-05, 'batch_size': 12, 'beta_1': 0.98104527317705, 'beta_2': 0.999788079677375, 'epsilon': 4.3612842017378343e-07, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.021476858313157363, 'tol': 0.0052039158299827665, 'validation_fraction': 0.20856742485410695}]
function_evaluation time 0.576733 value 0.339398 suggestion {'alpha': 2.409794444373252e-05, 'batch_size': 12, 'beta_1': 0.98104527317705, 'beta_2': 0.999788079677375, 'epsilon': 4.3612842017378343e-07, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.021476858313157363, 'tol': 0.0052039158299827665, 'validation_fraction': 0.20856742485410695}
observation time 0.000005, current best 0.309677 at iter 13
suggestion time taken 10.955351 iter 14 next_points [{'alpha': 8.03906164513993, 'batch_size': 22, 'beta_1': 0.8912966506341042, 'beta_2': 0.9996195398012769, 'epsilon': 4.5682608329091736e-08, 'hidden_layer_sizes': 140, 'learning_rate_init': 0.0021685702455831826, 'tol': 0.0004233926019761789, 'validation_fraction': 0.29887333005598704}]
function_evaluation time 0.586693 value 0.354224 suggestion {'alpha': 8.03906164513993, 'batch_size': 22, 'beta_1': 0.8912966506341042, 'beta_2': 0.9996195398012769, 'epsilon': 4.5682608329091736e-08, 'hidden_layer_sizes': 140, 'learning_rate_init': 0.0021685702455831826, 'tol': 0.0004233926019761789, 'validation_fraction': 0.29887333005598704}
observation time 0.000006, current best 0.309677 at iter 14
saving meta data: {'args': {'--uuid': 'd035afe0dd015693b2fab3c984cb2cea', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230422_030001', '--opt': 'smoothness', '--data': 'breast', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [8.104566516477803, 14.643876498263253, 12.332285721418042, 5.2697835894868685, 3.490431081639362])}
saving results
saving timing
saving suggest log
done
