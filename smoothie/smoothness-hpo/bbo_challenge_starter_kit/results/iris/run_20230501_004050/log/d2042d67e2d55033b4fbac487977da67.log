running: {'--uuid': 'd2042d67e2d55033b4fbac487977da67', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230501_004050', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d iris -o smoothness -u d2042d67e2d55033b4fbac487977da67 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230501_004050
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_iris_nll betwen [1.31057198 1.56976556 1.25224472 0.90978049 0.39813052] and [1.32439241 1.77609477 1.43221076 0.9966468  0.57459871]
  warnings.warn(

Signature errors:
                         0         1         2         3         4       max
MLP-adam_iris_nll  0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
max                0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
starting sklearn study smoothness MLP-adam iris nll 15 1
with data root: None
suggestion time taken 9.520888 iter 0 next_points [{'alpha': 0.5516701353996724, 'batch_size': 29, 'beta_1': 0.8329589824324928, 'beta_2': 0.9992311012916311, 'epsilon': 1.2178815171103461e-08, 'hidden_layer_sizes': 108, 'learning_rate_init': 0.00044311017070243437, 'tol': 0.03909744921793544, 'validation_fraction': 0.600732851842525}]
function_evaluation time 0.061595 value 1.283408 suggestion {'alpha': 0.5516701353996724, 'batch_size': 29, 'beta_1': 0.8329589824324928, 'beta_2': 0.9992311012916311, 'epsilon': 1.2178815171103461e-08, 'hidden_layer_sizes': 108, 'learning_rate_init': 0.00044311017070243437, 'tol': 0.03909744921793544, 'validation_fraction': 0.600732851842525}
observation time 0.000007, current best 1.283408 at iter 0
suggestion time taken 9.383201 iter 1 next_points [{'alpha': 6.370672701299111e-05, 'batch_size': 36, 'beta_1': 0.888827162362232, 'beta_2': 0.9315294049841814, 'epsilon': 2.2391314618387428e-07, 'hidden_layer_sizes': 74, 'learning_rate_init': 0.010647359725892667, 'tol': 0.0004133546279559989, 'validation_fraction': 0.17926670102926914}]
function_evaluation time 0.103986 value 0.405102 suggestion {'alpha': 6.370672701299111e-05, 'batch_size': 36, 'beta_1': 0.888827162362232, 'beta_2': 0.9315294049841814, 'epsilon': 2.2391314618387428e-07, 'hidden_layer_sizes': 74, 'learning_rate_init': 0.010647359725892667, 'tol': 0.0004133546279559989, 'validation_fraction': 0.17926670102926914}
observation time 0.000005, current best 0.405102 at iter 1
suggestion time taken 9.317892 iter 2 next_points [{'alpha': 1.4396892407856006, 'batch_size': 13, 'beta_1': 0.8363807213533092, 'beta_2': 0.9999898507984901, 'epsilon': 6.745989731979024e-08, 'hidden_layer_sizes': 95, 'learning_rate_init': 0.0361839557439543, 'tol': 0.0648122750341875, 'validation_fraction': 0.46996739552164446}]
function_evaluation time 0.091782 value 0.413824 suggestion {'alpha': 1.4396892407856006, 'batch_size': 13, 'beta_1': 0.8363807213533092, 'beta_2': 0.9999898507984901, 'epsilon': 6.745989731979024e-08, 'hidden_layer_sizes': 95, 'learning_rate_init': 0.0361839557439543, 'tol': 0.0648122750341875, 'validation_fraction': 0.46996739552164446}
observation time 0.000006, current best 0.405102 at iter 2
suggestion time taken 9.347534 iter 3 next_points [{'alpha': 0.019550226252223968, 'batch_size': 24, 'beta_1': 0.8895381622435778, 'beta_2': 0.9956040828309741, 'epsilon': 2.180532243583937e-08, 'hidden_layer_sizes': 91, 'learning_rate_init': 2.9316702340495243e-05, 'tol': 0.00013343047322216661, 'validation_fraction': 0.28693258918448594}]
function_evaluation time 0.084548 value 1.446169 suggestion {'alpha': 0.019550226252223968, 'batch_size': 24, 'beta_1': 0.8895381622435778, 'beta_2': 0.9956040828309741, 'epsilon': 2.180532243583937e-08, 'hidden_layer_sizes': 91, 'learning_rate_init': 2.9316702340495243e-05, 'tol': 0.00013343047322216661, 'validation_fraction': 0.28693258918448594}
observation time 0.000006, current best 0.405102 at iter 3
suggestion time taken 9.352496 iter 4 next_points [{'alpha': 0.9288511788732631, 'batch_size': 41, 'beta_1': 0.9806534733319263, 'beta_2': 0.9999089178897217, 'epsilon': 5.3187990939609065e-08, 'hidden_layer_sizes': 134, 'learning_rate_init': 0.00014452893469920063, 'tol': 0.0002771946705530444, 'validation_fraction': 0.29934920610358773}]
function_evaluation time 0.070655 value 1.374756 suggestion {'alpha': 0.9288511788732631, 'batch_size': 41, 'beta_1': 0.9806534733319263, 'beta_2': 0.9999089178897217, 'epsilon': 5.3187990939609065e-08, 'hidden_layer_sizes': 134, 'learning_rate_init': 0.00014452893469920063, 'tol': 0.0002771946705530444, 'validation_fraction': 0.29934920610358773}
observation time 0.000007, current best 0.405102 at iter 4
suggestion time taken 9.498915 iter 5 next_points [{'alpha': 0.16229199693510657, 'batch_size': 27, 'beta_1': 0.7735102199538831, 'beta_2': 0.9999987553790352, 'epsilon': 7.755465807635574e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.007934158966714684, 'tol': 0.016735798922143837, 'validation_fraction': 0.17768962069418717}]
function_evaluation time 0.108812 value 0.428013 suggestion {'alpha': 0.16229199693510657, 'batch_size': 27, 'beta_1': 0.7735102199538831, 'beta_2': 0.9999987553790352, 'epsilon': 7.755465807635574e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.007934158966714684, 'tol': 0.016735798922143837, 'validation_fraction': 0.17768962069418717}
observation time 0.000005, current best 0.405102 at iter 5
suggestion time taken 9.345897 iter 6 next_points [{'alpha': 2.033580366647891, 'batch_size': 49, 'beta_1': 0.6446910119998731, 'beta_2': 0.9596959322562456, 'epsilon': 1.340271634663506e-09, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.00045851526017918717, 'tol': 0.03286317910527085, 'validation_fraction': 0.16308872933611782}]
function_evaluation time 0.068505 value 1.738606 suggestion {'alpha': 2.033580366647891, 'batch_size': 49, 'beta_1': 0.6446910119998731, 'beta_2': 0.9596959322562456, 'epsilon': 1.340271634663506e-09, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.00045851526017918717, 'tol': 0.03286317910527085, 'validation_fraction': 0.16308872933611782}
observation time 0.000005, current best 0.405102 at iter 6
suggestion time taken 9.330254 iter 7 next_points [{'alpha': 0.022663073902419967, 'batch_size': 48, 'beta_1': 0.9873080869737059, 'beta_2': 0.9998768116546719, 'epsilon': 4.34673239313538e-07, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.001728582141748405, 'tol': 0.01732864041376762, 'validation_fraction': 0.16095958965030366}]
function_evaluation time 0.090213 value 0.746197 suggestion {'alpha': 0.022663073902419967, 'batch_size': 48, 'beta_1': 0.9873080869737059, 'beta_2': 0.9998768116546719, 'epsilon': 4.34673239313538e-07, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.001728582141748405, 'tol': 0.01732864041376762, 'validation_fraction': 0.16095958965030366}
observation time 0.000006, current best 0.405102 at iter 7
suggestion time taken 9.304924 iter 8 next_points [{'alpha': 0.0669067717686456, 'batch_size': 19, 'beta_1': 0.7573675117890137, 'beta_2': 0.9999802119030932, 'epsilon': 1.0120531558318254e-09, 'hidden_layer_sizes': 56, 'learning_rate_init': 3.455376849662164e-05, 'tol': 0.0027769919827558775, 'validation_fraction': 0.7215898976591463}]
function_evaluation time 0.064079 value 1.719591 suggestion {'alpha': 0.0669067717686456, 'batch_size': 19, 'beta_1': 0.7573675117890137, 'beta_2': 0.9999802119030932, 'epsilon': 1.0120531558318254e-09, 'hidden_layer_sizes': 56, 'learning_rate_init': 3.455376849662164e-05, 'tol': 0.0027769919827558775, 'validation_fraction': 0.7215898976591463}
observation time 0.000006, current best 0.405102 at iter 8
suggestion time taken 9.284906 iter 9 next_points [{'alpha': 0.04028477949193131, 'batch_size': 40, 'beta_1': 0.9779262622350686, 'beta_2': 0.9999240903998573, 'epsilon': 2.415056060503878e-09, 'hidden_layer_sizes': 63, 'learning_rate_init': 0.00010952464936590078, 'tol': 3.4440923463755696e-05, 'validation_fraction': 0.7909875391667047}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.064461 value 1.686574 suggestion {'alpha': 0.04028477949193131, 'batch_size': 40, 'beta_1': 0.9779262622350686, 'beta_2': 0.9999240903998573, 'epsilon': 2.415056060503878e-09, 'hidden_layer_sizes': 63, 'learning_rate_init': 0.00010952464936590078, 'tol': 3.4440923463755696e-05, 'validation_fraction': 0.7909875391667047}
observation time 0.000006, current best 0.405102 at iter 9
suggestion time taken 9.359828 iter 10 next_points [{'alpha': 1.0576205531339191e-05, 'batch_size': 19, 'beta_1': 0.7496917424549674, 'beta_2': 0.9962262623044396, 'epsilon': 5.488510646008055e-08, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.00017721039925183712, 'tol': 0.026456128559255616, 'validation_fraction': 0.7142760810776381}]
function_evaluation time 0.062251 value 1.399441 suggestion {'alpha': 1.0576205531339191e-05, 'batch_size': 19, 'beta_1': 0.7496917424549674, 'beta_2': 0.9962262623044396, 'epsilon': 5.488510646008055e-08, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.00017721039925183712, 'tol': 0.026456128559255616, 'validation_fraction': 0.7142760810776381}
observation time 0.000006, current best 0.405102 at iter 10
suggestion time taken 9.356881 iter 11 next_points [{'alpha': 3.6222695515537464, 'batch_size': 34, 'beta_1': 0.907036259912191, 'beta_2': 0.9918268495726817, 'epsilon': 9.089410542954095e-08, 'hidden_layer_sizes': 77, 'learning_rate_init': 0.009444240574606919, 'tol': 0.00033062892296287764, 'validation_fraction': 0.1034590877229174}]
function_evaluation time 0.097779 value 0.508699 suggestion {'alpha': 3.6222695515537464, 'batch_size': 34, 'beta_1': 0.907036259912191, 'beta_2': 0.9918268495726817, 'epsilon': 9.089410542954095e-08, 'hidden_layer_sizes': 77, 'learning_rate_init': 0.009444240574606919, 'tol': 0.00033062892296287764, 'validation_fraction': 0.1034590877229174}
observation time 0.000006, current best 0.405102 at iter 11
suggestion time taken 9.375843 iter 12 next_points [{'alpha': 0.00849303804716784, 'batch_size': 27, 'beta_1': 0.9570083870170683, 'beta_2': 0.9514663786728331, 'epsilon': 1.4464890641368175e-07, 'hidden_layer_sizes': 54, 'learning_rate_init': 3.558192314521507e-05, 'tol': 7.637088080857603e-05, 'validation_fraction': 0.7613363595705039}]
function_evaluation time 0.046848 value 1.663985 suggestion {'alpha': 0.00849303804716784, 'batch_size': 27, 'beta_1': 0.9570083870170683, 'beta_2': 0.9514663786728331, 'epsilon': 1.4464890641368175e-07, 'hidden_layer_sizes': 54, 'learning_rate_init': 3.558192314521507e-05, 'tol': 7.637088080857603e-05, 'validation_fraction': 0.7613363595705039}
observation time 0.000006, current best 0.405102 at iter 12
suggestion time taken 9.364470 iter 13 next_points [{'alpha': 0.006667052161146126, 'batch_size': 30, 'beta_1': 0.9885805927277226, 'beta_2': 0.9628590635451185, 'epsilon': 6.225721220398692e-08, 'hidden_layer_sizes': 59, 'learning_rate_init': 0.0016268459492989034, 'tol': 0.009696987557305883, 'validation_fraction': 0.6203556694656048}]
function_evaluation time 0.059406 value 1.312567 suggestion {'alpha': 0.006667052161146126, 'batch_size': 30, 'beta_1': 0.9885805927277226, 'beta_2': 0.9628590635451185, 'epsilon': 6.225721220398692e-08, 'hidden_layer_sizes': 59, 'learning_rate_init': 0.0016268459492989034, 'tol': 0.009696987557305883, 'validation_fraction': 0.6203556694656048}
observation time 0.000005, current best 0.405102 at iter 13
suggestion time taken 9.343773 iter 14 next_points [{'alpha': 0.0006290192492303711, 'batch_size': 19, 'beta_1': 0.9381921097401646, 'beta_2': 0.999992991539192, 'epsilon': 6.305219160126623e-07, 'hidden_layer_sizes': 67, 'learning_rate_init': 0.007661306435397028, 'tol': 0.07352328923913666, 'validation_fraction': 0.8291324336880623}]
function_evaluation time 0.058669 value 0.878164 suggestion {'alpha': 0.0006290192492303711, 'batch_size': 19, 'beta_1': 0.9381921097401646, 'beta_2': 0.999992991539192, 'epsilon': 6.305219160126623e-07, 'hidden_layer_sizes': 67, 'learning_rate_init': 0.007661306435397028, 'tol': 0.07352328923913666, 'validation_fraction': 0.8291324336880623}
observation time 0.000005, current best 0.405102 at iter 14
saving meta data: {'args': {'--uuid': 'd2042d67e2d55033b4fbac487977da67', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230501_004050', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])}
saving results
saving timing
saving suggest log
done
